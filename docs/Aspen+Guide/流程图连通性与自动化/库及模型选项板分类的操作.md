IHAPLibRef 接口让自动化客户端可以访问与模拟问题关联的库以及模型选项板上显示的类别，并能够对这些库和类别进行添加、删除和重新排序。通过问题的 LibRef 方法即可获得该接口。有关此接口中函数的详细信息，请参见 IHAPLibRef 类的成员说明。

[ IHAPLibRef](库及模型选项板分类的操作/+IHAPLibRef.md)

通过 OLE 创建流程图示例

```VBScript
Dim problem As Happ.IHapp
Dim libref As Happ.IHAPLibRef

Set problem = CreateObject("Apwn.document")
Set libref = problem.LibRef
```

将新库插入为第一个引用库：

```VBScript
libref.InsertLibrary "f:\kessel\fcc.apm", 0
```

显示问题窗口，以便查看模型选项板和库引用：

```VBScript

```

```VBScript
problem.Visible = True
```





Python版本

```VBScript
import win32com.client as win32

# 1. 获取 IHAPLibRef 接口
problem = win32.Dispatch("AspenPlus.Document.34.0")   # 或对应版本号
problem.InitNew2()                                    # 可选：新建空白模拟
libref = problem.LibRef                              # IHAPLibRef 接口

# 2. 列出已引用库
for idx in range(libref.CountLibs):
    print(libref.LibraryName(idx))
    print(libref.LibraryPath(idx))

# 3. 插入新库作为首个引用
libref.InsertLibrary(r"f:\kessel\fcc.apm", 0)   # 0 = 插入到首位

# 4. 显示窗口，查看模型选项板与库引用
problem.Visible = True
```



