{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83d\udc4b \u6b22\u8fce\u6765\u5230 MrsJone \u7684\u4e3b\u9875","text":"<p>\u5404\u4f4d\u597d\uff0c\u6211\u662f\u6765\u81ea\u6ca7\u5dde\u4ea4\u901a\u5b66\u9662\u7684 MrsJone\u3002</p> <p>\u8fd9\u4e2a\u7f51\u7ad9\u662f\u5173\u4e8e Aspen Plus \u81ea\u52a8\u5316\u8054\u52a8\u7684\u4e00\u4e2a\u9879\u76ee\u3002\u6211\u5c06\u5176\u6838\u5fc3\u6587\u6863\u8fdb\u884c\u4e86\u7ffb\u8bd1\uff0c\u5e76\u7528\u90e8\u5206 Python \u8bed\u8a00\u8fdb\u884c\u4e86\u5305\u88c5\u548c\u5c01\u88c5\uff0c\u65e8\u5728\u8ba9\u6d41\u7a0b\u6a21\u62df\u81ea\u52a8\u5316\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002</p> <p>\u5e0c\u671b\u5927\u5bb6\u80fd\u591f\u4e3a\u5316\u5de5\u793e\u533a\u505a\u8d21\u732e\uff01\u8fd9\u91cc\u662f MrsJone\uff0c\u611f\u8c22\u5927\u5bb6\u7684\u8d21\u732e\u4e0e\u652f\u6301\uff01</p>"},{"location":"#_1","title":"\ud83e\uddd1\u200d\ud83c\udf93 \u4f5c\u8005\u7b80\u4ecb","text":"\u9879\u76ee \u5185\u5bb9 \u59d3\u540d MrsJone \u5b66\u6821 \u6ca7\u5dde\u4ea4\u901a\u5b66\u9662 \u4e13\u4e1a \u5236\u836f\u5de5\u7a0b"},{"location":"#_2","title":"\ud83d\udcec \u5173\u6ce8\u4e0e\u4ea4\u6d41","text":"<p>\u6b22\u8fce\u5927\u5bb6\u8fdb QQ \u7fa4\u8ba8\u8bba\uff0c\u4e5f\u6b22\u8fce\u5173\u6ce8\u6211\u7684\u81ea\u5a92\u4f53\u8d26\u53f7\uff1a</p> <ul> <li>\ud83d\udcfa B\u7ad9\u4e3b\u9875\uff1aMrsJone (\u70b9\u51fb\u8df3\u8f6c)</li> <li>\ud83d\udce2 \u5fae\u4fe1\u516c\u4f17\u53f7\uff1aMrsJone\u7684\u7834\u7ad9</li> <li>\ud83d\udc65 \u4ea4\u6d41 QQ \u7fa4\uff1a<code>562721026</code> (\u6b22\u8fce\u52a0\u5165\uff01)</li> </ul> <p>\u8054\u7cfb\u4f5c\u8005</p> <p>\u5982\u679c\u4f60\u6709\u6280\u672f\u95ee\u9898\u6216\u5408\u4f5c\u610f\u5411\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u8054\u7cfb\u6211\uff1a</p> <ul> <li>\u4e2a\u4eba QQ\uff1a<code>1422151772</code></li> <li>\u4e2a\u4eba\u5fae\u4fe1\uff1a<code>wenxiaoshuo12138</code></li> </ul> <p>\u5bc4\u8bed</p> <p>\u5e0c\u671b\u5927\u5bb6\u80fd\u591f\u4e3a\u5316\u5de5\u793e\u533a\u505a\u8d21\u732e\uff01</p> \u2615 \u89c9\u5f97\u6709\u5e2e\u52a9\uff1f\u8bf7 MrsJone \u559d\u676f\u5496\u5561 <p> <p>\u5982\u679c\u662f\u7531\u4e8e\u6211\u7684\u7b14\u8bb0\u5e2e\u52a9\u5230\u4e86\u4f60\uff0c\u6b22\u8fce\u6253\u8d4f\u652f\u6301\uff01</p> <p>\uff08\u5fae\u4fe1 / \u652f\u4ed8\u5b9d\uff09</p> </p>"},{"location":"Aspen%2BGuide/","title":"Aspen+Guide","text":"<p>\u6307\u4ee4:ActiveX</p> <p>\u5982\u9700\u83b7\u53d6\u5173\u4e8e Aspen Plus ActiveX \u81ea\u52a8\u5316\u670d\u52a1\u5668\u7684\u5e2e\u52a9\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4ee5\u4e0b\u4e3b\u9898\u4e4b\u4e00\uff1a</p> <p>\u5173\u4e8e\u81ea\u52a8\u5316\u670d\u52a1\u5668</p> <p>\u67e5\u770b Aspen Plus \u5bf9\u8c61\u7684\u5c5e\u6027\u4e0e\u65b9\u6cd5</p> <p>\u81ea\u52a8\u5316\u670d\u52a1\u5668\u66b4\u9732\u7684\u5bf9\u8c61</p> <p>\u4f7f\u7528\u53d8\u91cf\u6d4f\u89c8\u5668\u5bfc\u822a\u6811\u5f62\u7ed3\u6784</p> <p>\u5728\u81ea\u52a8\u5316\u63a5\u53e3\u4e2d\u5bfc\u822a\u6811\u5f62\u7ed3\u6784</p> <p>\u6570\u636e\u503c\u4e0e\u8282\u70b9\u5c5e\u6027</p> <p>\u7269\u7406\u91cf\u4e0e\u8ba1\u91cf\u5355\u4f4d</p> <p>\u5f15\u7528\u975e\u6807\u91cf\u6570\u636e</p> <p>\u6d41\u7a0b\u56fe\u8fde\u901a\u6027\u4e0e\u81ea\u52a8\u5316</p> <p>\u63a7\u5236\u7528\u6237\u754c\u9762</p> <p>\u63a7\u5236\u6a21\u62df\u95ee\u9898\uff08\u8fd0\u884c / \u6536\u655b\u7b49\uff09</p> <p>\u5bfc\u51fa\u6587\u4ef6</p> <p>\u4ece\u5176\u4ed6\u8bed\u8a00\u8c03\u7528\u81ea\u52a8\u5316\u63a5\u53e3</p> <p>Aspen Plus \u7c7b\u7684\u6210\u5458</p> <p>\u672c\u4e3b\u9898\u5047\u5b9a\u4f60\u5df2\u719f\u6089 Visual Basic \u7f16\u7a0b\u8bed\u8a00\uff0c\u5e76\u7406\u89e3\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u76f8\u5173\u6982\u5ff5\u3002</p> <p>\u672c\u4e3b\u9898\u4e2d\u7684\u793a\u4f8b\u4ee5 Visual Basic.NET\u548c Visual Basic for Applications\uff08VBA\uff09\u4f5c\u4e3a\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u7f16\u5199\uff0c\u4e14\u57fa\u4e8e pfdtut \u793a\u4f8b\u7b97\u4f8b \u2014\u2014 \u8be5\u7b97\u4f8b\u968f Aspen Plus \u6807\u51c6\u5b89\u88c5\u5305\u63d0\u4f9b\uff0c\u5bf9\u5e94\u7684\u5907\u4efd\u6587\u4ef6\u540d\u4e3a pfdtut.bkp\u3002\u82e5\u4f60\u5c06 Aspen Plus \u5b89\u88c5\u5728\u9ed8\u8ba4\u8def\u5f84\u4e0b\uff0c\u8be5\u6587\u4ef6\u4f4d\u4e8e\uff1aC:\\Program Files\\AspenTech\\Aspen Plus V14\\GUI\\Examples\u3002</p> <p>\u82e5 Aspen Plus \u4e3a\u9ed8\u8ba4\u5b89\u88c5\uff0c\u672c\u4e3b\u9898\u4e2d\u7684 Visual Basic \u793a\u4f8b\u6587\u4ef6\u5b58\u653e\u8def\u5f84\u4e3a\uff1aC:\\Program Files\\AspenTech\\Aspen Plus V14\\GUI\\VBDotNetExample\u3002\u5c3d\u7ba1 VB \u4ee3\u7801\u672c\u8eab\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u9488\u5bf9\u4e0d\u540c\u7248\u672c\u7684 Visual Studio\uff0c\u4ecd\u63d0\u4f9b\u4e86\u5bf9\u5e94\u7684\u9879\u76ee\u7248\u672c\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/","title":"Aspen+Plus+\u7c7b\u7684\u6210\u5458","text":"<p>\u672c\u8282\u5217\u51fa\u6240\u6709\u5df2\u516c\u5f00\u7684 Aspen Plus \u7c7b\u7684\u6210\u5458\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\uff1a</p> <p>HappLS \u7c7b\u6210\u5458</p> <p>IHNode \u7c7b\u6210\u5458</p> <p>IHNodeCol \u7c7b\u6210\u5458</p> <p>IHAPEngine \u7c7b\u6210\u5458</p> <p>IHAPLibRef \u7c7b\u6210\u5458</p>"},{"location":"Aspen%2BGuide/%E4%BB%8E%E5%85%B6%E4%BB%96%E8%AF%AD%E8%A8%80%E8%B0%83%E7%94%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3/","title":"\u4ece\u5176\u4ed6\u8bed\u8a00\u8c03\u7528\u81ea\u52a8\u5316\u63a5\u53e3","text":"<p>\u5c3d\u7ba1\u672c\u6587\u6863\u4ee5 Visual Basic \u6216 VBA \u8c03\u7528\u81ea\u52a8\u5316\u670d\u52a1\u5668\u4e3a\u89c6\u89d2\u7f16\u5199\uff0c\u4f46\u4efb\u4f55\u652f\u6301\u8c03\u7528 COM \u63a5\u53e3\u7684\u8bed\u8a00\u5747\u53ef\u4f7f\u7528\u3002</p> <p>\u4e0d\u652f\u6301\u76f4\u63a5\u4ece \u6258\u7ba1\u4ee3\u7801\uff08\u5982 C#\uff09 \u8c03\u7528\u81ea\u52a8\u5316\u63a5\u53e3\uff1b\u82e5\u5fc5\u987b\u8fd9\u6837\u505a\uff0c\u9700\u81ea\u884c\u7f16\u5199 \u6258\u7ba1/\u975e\u6258\u7ba1\u4e92\u64cd\u4f5c\u5305\u88c5\u5668\uff08wrapper\uff09\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\uff1a \u4ece C++ \u8c03\u7528\u81ea\u52a8\u5316\u63a5\u53e3</p>"},{"location":"Aspen%2BGuide/%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AF%BC%E8%88%AA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/","title":"\u4f7f\u7528\u53d8\u91cf\u6d4f\u89c8\u5668\u5bfc\u822a\u6811\u5f62\u7ed3\u6784","text":"<p>\u5229\u7528\u201c\u53d8\u91cf\u6d4f\u89c8\u5668\u201d\u53ef\u67e5\u770b\u5e76\u8bbf\u95ee\u4e0e\u6a21\u62df\u76f8\u5173\u7684\u53d8\u91cf\u3002\u5b83\u4ee5\u6811\u5f62\u89c6\u56fe\u5c55\u793a\u6a21\u62df\u4e2d\u6bcf\u4e2a\u53d8\u91cf\u7684\u5c5e\u6027\uff0c\u5916\u89c2\u7c7b\u4f3c\u5bfc\u822a\u7a97\u683c\uff0c\u4f46\u533a\u522b\u5728\u4e8e\uff1a</p> <ul> <li> <p>\u5bfc\u822a\u7a97\u683c\u628a\u53d8\u91cf\u6309\u8868\u5355\u5206\u7ec4\uff0c\u914d\u6709\u63d0\u793a\u6587\u672c\u3001\u6eda\u52a8\u63a7\u4ef6\u3001\u4e0b\u62c9\u6846\u548c\u8f93\u5165\u5b57\u6bb5\uff0c\u65b9\u4fbf\u586b\u5199\uff1b</p> </li> <li> <p>\u53d8\u91cf\u6d4f\u89c8\u5668\u5219\u76f4\u63a5\u66b4\u9732\u6a21\u62df\u95ee\u9898\u5185\u90e8\u7684\u5e95\u5c42\u53d8\u91cf\u7ed3\u6784\u3002</p> </li> </ul> <p>\u6253\u5f00\u65b9\u5f0f\uff1a \u5728\u529f\u80fd\u533a\u201c\u81ea\u5b9a\u4e49\u201d\u9009\u9879\u5361\u70b9\u51fb\u201cVariable Explorer\u201d\u3002</p> <p>\u5bf9\u81ea\u52a8\u5316\u7528\u6237\u800c\u8a00\uff0c\u53d8\u91cf\u6d4f\u89c8\u5668\u5c24\u4e3a\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u5448\u73b0\u4e86\u53ef\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8bbf\u95ee\u7684\u53d8\u91cf\u540d\u79f0\u4e0e\u5c42\u6b21\u7ed3\u6784\u3002</p> <p>\u6ce8\u610f\uff1a</p> <ul> <li> <p>\u53d8\u91cf\u6d4f\u89c8\u5668\u4e3a\u53ea\u8bfb\uff0c\u65e0\u6cd5\u5728\u5176\u4e2d\u66f4\u6539\u53d8\u91cf\u503c\u6216\u5176\u4ed6\u5c5e\u6027\u3002</p> </li> <li> <p>\u6d4f\u89c8\u6811\u5f62\u7ed3\u6784\u65f6\u53ef\u80fd\u610f\u5916\u65b0\u5efa\u5bf9\u8c61\uff0c\u4e14\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u80fd\u65e0\u6cd5\u5220\u9664\u3002\u56e0\u6b64\uff0c\u4f7f\u7528\u524d\u8bf7\u5148\u4fdd\u5b58\u6a21\u62df\uff0c\u4f7f\u7528\u5b8c\u6bd5\u540e\u5207\u52ff\u518d\u6b21\u4fdd\u5b58\uff0c\u4ee5\u514d\u6c61\u67d3\u6587\u4ef6\u3002</p> </li> </ul> <p>\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5728 pfdtut.bkp \u7684 RadFrac \u6a21\u5757\uff08B6\uff09\u4e2d\uff0c\u7528\u53d8\u91cf\u6d4f\u89c8\u5668\uff08Variable Explorer\uff09\u67e5\u627e\u5e76\u590d\u5236\u53d8\u91cf\u8def\u5f84\uff0c\u4ee5\u4fbf\u540e\u7eed\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8c03\u7528\u3002</p> <ol> <li> <p>\u6253\u5f00\u53d8\u91cf\u6d4f\u89c8\u5668 \u529f\u80fd\u533a\u201c\u81ea\u5b9a\u4e49\u201d\u2192 Variable Explorer\u3002</p> </li> <li> <p>\u9010\u7ea7\u5c55\u5f00\u6811 Root \u2192 Data \u2192 Blocks \u2192 B6 \u2192 Input/Output</p> <ul> <li> <p>\u5728 Input \u4e0b\u53ef\u770b\u5230 NSTAGE\uff08\u5854\u677f\u6570\uff09\u7b49\u8f93\u5165\u53d8\u91cf\u3002</p> </li> <li> <p>\u5728 Output \u4e0b\u53ef\u770b\u5230 BU_RATIO\uff08\u518d\u6cb8\u6bd4\uff09\u7b49\u7ed3\u679c\u53d8\u91cf\u3002</p> </li> </ul> </li> <li> <p>\u590d\u5236\u8def\u5f84 \u9009\u4e2d\u76ee\u6807\u8282\u70b9\u540e\uff0c\u201cPath to Node\u201d\u6587\u672c\u6846\u4f1a\u7ed9\u51fa\u4e24\u79cd\u5199\u6cd5\uff1a</p> <ul> <li> <p>\u70b9\u5206\u6cd5\uff1aApplication.Tree.Data.Blocks.B6.Input.NSTAGE</p> </li> <li> <p>FindNode \u6cd5\uff1aApplication.Tree.FindNode(\"\\Data\\Blocks\\B6\\Input\\NSTAGE\")</p> </li> </ul> <p>\u53f3\u952e\u2192 Copy\uff0c\u5373\u53ef\u7c98\u8d34\u5230 VB/VBA \u4ee3\u7801\u4e2d\u3002</p> </li> <li> <p>\u5feb\u901f\u5b9a\u4f4d\u5df2\u590d\u5236\u53d8\u91cf \u5728\u6d41\u7a0b\u56fe\u754c\u9762\u9009\u4e2d\u201cNumber of Stages\u201d\u5b57\u6bb5\u2192 Ctrl+C \u590d\u5236\uff1b \u56de\u5230\u53d8\u91cf\u6d4f\u89c8\u5668\uff0c\u5728\u5de6\u4fa7\u6811\u7a7a\u767d\u5904\u53f3\u952e\u2192 Find Clipboard Variable\uff0c\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u5bf9\u5e94\u8282\u70b9\u5e76\u9ad8\u4eae\u8def\u5f84\u3002</p> </li> <li> <p>\u8def\u5f84\u7279\u6b8a\u5b57\u7b26\u5904\u7406</p> <ul> <li> <p>\u70b9\u5206\u6cd5\u4e2d\uff0c\u82e5\u8282\u70b9\u540d\u542b\u7f16\u7a0b\u8bed\u8a00\u975e\u6cd5\u5b57\u7b26\uff08\u5982\u201cD-1\u201d\uff09\uff0c\u9700\u6539\u4e3a elements(\"name\") \u5f62\u5f0f\uff1a <code>Application.Tree.Data.Properties.Data.elements(\"D-1\").Input.TEMP</code></p> </li> <li> <p>FindNode \u6cd5\u4e2d\uff0c\u82e5\u8def\u5f84\u542b\u659c\u6760\u6216\u53cd\u659c\u6760\uff0c\u9700\u7528\u5355\u5f15\u53f7\u62ec\u8d77\u6765\uff1a <code>Application.Tree.FindNode(\"\\Data\\Properties\\Data\\D-1\\Input\\VALUE\\'(#0,CPL,Btu/lbmol-R)'\")</code></p> </li> </ul> </li> </ol> <p>\u6ce8\u610f</p> <ul> <li> <p>\u53d8\u91cf\u6d4f\u89c8\u5668\u53ea\u8bfb\uff0c\u65e0\u6cd5\u76f4\u63a5\u6539\u503c\u3002</p> </li> <li> <p>\u5bf9\u201cStream Results\u201d\u8868\u5355\u6216\u9876\u5c42\u201cStreams\u201d\u7ed3\u679c\uff0c\u4ee5\u53ca\u201c\u81ea\u52a8\u5316\u6570\u636e\u8bbf\u95ee\u9650\u5236\u201d\u5217\u51fa\u7684\u53d8\u91cf\uff0c\u4e0d\u80fd\u7528 Find Clipboard Variable\uff0c\u9700\u624b\u52a8\u9010\u7ea7\u5c55\u5f00\u3002</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E5%85%B3%E4%BA%8E%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"\u5173\u4e8e\u81ea\u52a8\u5316\u670d\u52a1\u5668","text":"<p>Aspen Plus \u7684 Windows \u7528\u6237\u754c\u9762\u662f\u4e00\u4e2a ActiveX \u81ea\u52a8\u5316\u670d\u52a1\u5668\u3002ActiveX \u6280\u672f\uff08\u4e5f\u79f0 OLE \u81ea\u52a8\u5316\uff09\u5141\u8bb8\u5916\u90e8 Windows \u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u7f16\u7a0b\u63a5\u53e3\uff08\u5982\u5fae\u8f6f Visual Basic\uff09\u4e0e Aspen Plus \u4ea4\u4e92\u3002\u8be5\u670d\u52a1\u5668\u901a\u8fc7 COM \u5bf9\u8c61\u6a21\u578b\u516c\u5f00\u5176\u5bf9\u8c61\u3002</p> <p>\u501f\u52a9\u81ea\u52a8\u5316\u63a5\u53e3\uff0c\u60a8\u53ef\u4ee5\uff1a</p> <ul> <li> <p>\u5c06 Aspen Plus \u6a21\u62df\u7684\u8f93\u5165\u548c\u7ed3\u679c\u8fde\u63a5\u5230\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982\u8bbe\u8ba1\u7a0b\u5e8f\u6216\u6570\u636e\u5e93\u3002</p> </li> <li> <p>\u4e3a Aspen Plus \u88c5\u7f6e\u6a21\u578b\u7f16\u5199\u81ea\u5df1\u7684\u7528\u6237\u754c\u9762\u3002\u5229\u7528\u8be5\u754c\u9762\uff0c\u60a8\u53ef\u4ee5\u5c06\u88c5\u7f6e\u6a21\u578b\u5206\u53d1\u7ed9\u4ed6\u4eba\uff0c\u4ed6\u4eec\u65e0\u9700\u5b66\u4e60 Aspen Plus \u539f\u751f\u754c\u9762\u5373\u53ef\u8fd0\u884c\u6a21\u578b\u3002</p> </li> </ul> <p>\u4f7f\u7528\u81ea\u52a8\u5316\u670d\u52a1\u5668 \u53c2\u89c1\uff1a\u9519\u8bef\u5904\u7406</p> <p>\u8981\u4f7f\u7528 Aspen Plus \u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ul> <li> <p>\u5df2\u5728 PC \u4e0a\u5b89\u88c5 Aspen Plus</p> </li> <li> <p>\u62e5\u6709 Aspen Plus \u7684\u4f7f\u7528\u8bb8\u53ef</p> </li> </ul> <p>Aspen Plus \u4e0e Aspen Properties \u73b0\u5728\u5171\u7528\u540c\u4e00\u4e2a\u7c7b\u578b\u5e93 happ.tlb\uff0c\u4f4d\u4e8e APrSystem \u7684 GUI\\xeq \u76ee\u5f55\u3002\u82e5\u91c7\u7528\u9ed8\u8ba4\u5b89\u88c5\u8def\u5f84\uff0c\u8be5\u6587\u4ef6\u4f4d\u4e8e\uff1a C:\\Program Files\\AspenTech\\APrSystem V14\\GUI\\xeq</p> <p>\u8fdb\u7a0b\u5916\u670d\u52a1\u5668\u4e3a AspenPlus.exe\u3002</p> <p>\u5728 Visual Basic \u4e2d\u8bbf\u95ee Aspen Plus \u7c7b\u578b\u5e93\u4e4b\u524d\uff0c\u8bf7\u5728\u201c\u9879\u76ee-\u5f15\u7528\u201d\u5bf9\u8bdd\u6846\u4e2d\u52fe\u9009\u201cAspen Plus GUI V14 Type Library\u201d\u3002</p> <p>\u5728 Excel VBA \u4e2d\u8bbf\u95ee\u4e4b\u524d\uff0c\u8bf7\u5728\u201c\u5de5\u5177-\u5f15\u7528\u201d\u5bf9\u8bdd\u6846\u4e2d\u52fe\u9009\u540c\u4e00\u9009\u9879\u3002 \u5982\u679c\u5217\u8868\u4e2d\u672a\u51fa\u73b0\u201cAspen Plus GUI V14 Type Library\u201d\uff0c\u70b9\u51fb\u201c\u6d4f\u89c8\u201d\uff0c\u5728\u4e0a\u8ff0\u76ee\u5f55\u4e2d\u627e\u5230\u5e76\u9009\u62e9 happ.tlb\u3002</p> <p>\u9519\u8bef\u5904\u7406 \u5728\u8c03\u7528 Aspen Plus \u5bf9\u8c61\u7684\u65b9\u6cd5\u6216\u8bbf\u95ee\u5176\u5c5e\u6027\u65f6\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u9519\u8bef\u3002\u56e0\u6b64\uff0c\u4e3a\u6240\u6709\u8bbf\u95ee\u81ea\u52a8\u5316\u63a5\u53e3\u7684\u4ee3\u7801\u5efa\u7acb\u9519\u8bef\u5904\u7406\u673a\u5236\u81f3\u5173\u91cd\u8981\u3002\u81ea\u52a8\u5316\u63a5\u53e3\u53ef\u80fd\u56e0\u591a\u79cd\u539f\u56e0\u8fd4\u56de\u8c03\u5ea6\u9519\u8bef\uff0c\u5176\u4e2d\u5927\u591a\u6570\u5e76\u4e0d\u4ee3\u8868\u81f4\u547d\u6216\u4e25\u91cd\u95ee\u9898\u3002</p> <p>\u82e5\u672a\u8bbe\u7f6e\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\uff0c\u4efb\u4f55\u9519\u8bef\u901a\u5e38\u90fd\u4f1a\u5f39\u51fa\u5bf9\u8bdd\u6846\u63d0\u793a\u7528\u6237\u3002\u5728 VB \u4e2d\uff0c\u9519\u8bef\u5904\u7406\u901a\u8fc7 On Error \u8bed\u53e5\u5b9e\u73b0\uff0c\u4f8b\u5982\uff1aOn Error Goto &lt;\u884c\u53f7&gt;\u3002\u4e00\u822c\u505a\u6cd5\u662f\u5148\u7f16\u5199\u4e00\u4e2a\u9519\u8bef\u5904\u7406\u5b50\u7a0b\u5e8f\uff0c\u4e00\u65e6\u9047\u5230\u4e25\u91cd\u9519\u8bef\uff0c\u5373\u53ef\u8fdb\u884c\u6e05\u7406\u5e76\u5e72\u51c0\u5730\u9000\u51fa\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"Aspen%2BGuide/%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3%E4%B8%AD%E5%AF%BC%E8%88%AA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/","title":"\u5728\u81ea\u52a8\u5316\u63a5\u53e3\u4e2d\u5bfc\u822a\u6811\u5f62\u7ed3\u6784","text":"<p>\u5bfc\u822a\u7a97\u683c\u4e2d\u770b\u5230\u7684\u6811\u5f62\u7ed3\u6784\uff0c\u4e0e\u81ea\u52a8\u5316\u63a5\u53e3\u5b8c\u5168\u4e00\u81f4\u3002</p> <p>Aspen Plus \u628a\u6a21\u62df\u4e2d\u7684\u6240\u6709\u5bf9\u8c61\u66b4\u9732\u4e3a\u4e00\u68f5\u7531 IHNode \u8282\u70b9\u7ec4\u6210\u7684\u6811\u3002</p> <ul> <li> <p>\u6811\u7684\u6839\u8282\u70b9\u901a\u8fc7 HappLS.Tree \u5c5e\u6027\u83b7\u5f97\u3002</p> </li> <li> <p>\u6bcf\u4e2a IHNode \u53ef\u4ee5\u6709 0 \u4e2a\u6216\u591a\u4e2a\u5b50\u8282\u70b9\uff1b\u5176 Dimension \u5c5e\u6027\u51b3\u5b9a\u5b50\u8282\u70b9\u7684\u7ec4\u7ec7\u65b9\u5f0f\u3002</p> <ul> <li>\u82e5 Dimension = 0\uff0c\u5219\u8be5\u8282\u70b9\u4e3a\u53f6\u5b50\u8282\u70b9\uff0c\u4e0d\u518d\u6709\u5b50\u8282\u70b9\u3002</li> </ul> </li> <li> <p>\u5b50\u8282\u70b9\u96c6\u5408\u901a\u8fc7 IHNode.Elements \u5c5e\u6027\u8fd4\u56de\uff0c\u7c7b\u578b\u4e3a IHNodeCol\uff08\u8282\u70b9\u96c6\u5408\u5bf9\u8c61\uff09\u3002</p> </li> </ul> <p>\u4e0b\u9762\u7528\u4e00\u6bb5\u4ee3\u7801\u6f14\u793a\u5982\u4f55\u9010\u7ea7\u904d\u5386\u8fd9\u68f5\u6811\u3002</p> <p>\u4f8b\u5b50</p> <p>Dot \u8bb0\u6cd5\u5bfc\u822a\u6811\u7ed3\u6784</p> <p>\u81ea\u52a8\u5316\u6570\u636e\u8bbf\u95ee\u7684\u9650\u5236</p>"},{"location":"Aspen%2BGuide/%E5%AF%BC%E5%87%BA%E6%96%87%E4%BB%B6/","title":"\u5bfc\u51fa\u6587\u4ef6","text":"<p>IHapp \u63a5\u53e3\u65b0\u589e\u81ea\u52a8\u5316\u65b9\u6cd5 .Export\uff0c\u7528\u4e8e\u5bfc\u51fa\u9664 Aspen \u5b58\u6863\uff08.bkp\uff09\u548c Aspen \u6587\u6863\uff08.apw\uff09\u683c\u5f0f\u4e4b\u5916\u7684\u5176\u4ed6\u6587\u4ef6\u683c\u5f0f\u3002</p> <p>\u4f7f\u7528 Export \u65b9\u6cd5\u793a\u4f8b \u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u6f14\u793a\u5982\u4f55\u5c06\u6a21\u62df\u5bfc\u51fa\u4e3a\u62a5\u544a\u6587\u4ef6\u3002</p> <pre><code>Dim MySim As Happ.IHapp\n\nPublic Sub Main()\n  On Error GoTo MainErrHandler\n\n  MySim = CreateObject(\"Apwn.Document\")\n  Call MySim.InitFromArchive2(\"pfdtut.bkp\", 0)\n\n  ' \u5bfc\u51fa\u62a5\u544a\u6587\u4ef6\n  Call MySim.Export(HAPEXP_REPORT, \"pfdtut.rep\")\n\n  Set MySim = Nothing\n  Exit Sub\n\nMainErrHandler:\n  Err.Clear\nEnd Sub\n</code></pre> <p>\u3010Python \u76f4\u8bd1\u7248\u3011</p> <pre><code>import win32com.client as win32\n\nMySim = win32.Dispatch(\"AspenPlus.Document.34.0\")\nMySim.InitFromArchive2(r\"pfdtut.bkp\", 0)\n\n# \u5bfc\u51fa\u62a5\u544a\u6587\u4ef6\uff08HAPEXP_REPORT = 1\uff09\nHAPEXP_REPORT = 1\nMySim.Export(HAPEXP_REPORT, r\"pfdtut.rep\")\n\n# \u91ca\u653e\u5bf9\u8c61\nMySim = None\n</code></pre> <p>\u8fd0\u884c\u540e\u5c06\u5728\u540c\u4e00\u76ee\u5f55\u751f\u6210 <code>pfdtut.rep</code> \u62a5\u544a\u6587\u4ef6\u3002</p>"},{"location":"Aspen%2BGuide/%E5%BC%95%E7%94%A8%E9%9D%9E%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE/","title":"\u5f15\u7528\u975e\u6807\u91cf\u6570\u636e","text":"<p>\u6a21\u62df\u95ee\u9898\u4e2d\u7684\u5927\u90e8\u5206\u6570\u636e\u4ee5\u6570\u7ec4\u3001\u5217\u8868\u6216\u8868\u683c\u5f62\u5f0f\u7ec4\u7ec7\uff0c\u56e0\u6b64\u5305\u542b\u5728\u591a\u503c\u53d8\u91cf\u91cc\u3002</p> <p>\u975e\u6807\u91cf\u6570\u636e\u53ea\u80fd\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u4e00\u6b21\u53d6\u4e00\u4e2a\u503c\uff0c\u5373\u8bbf\u95ee\u53f6\u8282\u70b9\u7684 <code>Value</code> \u5c5e\u6027\u3002 \u8282\u70b9\u7684\u7ec4\u7ec7\u65b9\u5f0f\u53d6\u51b3\u4e8e\uff1a</p> <ol> <li> <p>\u9700\u8981\u591a\u5c11\u4e2a\u6807\u8bc6\u7b26\u624d\u80fd\u5b9a\u4f4d\u8be5\u503c\uff1b</p> </li> <li> <p>\u8be5\u503c\u6240\u5904\u7684\u4e0a\u4e0b\u6587\u3002</p> </li> </ol> <p>\u4f8b\u5982\uff1a</p> <ul> <li> <p>\u5854\u677f\u6e29\u5ea6\u5206\u5e03\uff1a\u53d8\u91cf\u540d + 1 \u4e2a\u9644\u52a0\u6807\u8bc6\u7b26\u2014\u2014\u5854\u677f\u53f7\uff1b</p> </li> <li> <p>\u5854\u677f\u7ec4\u6210\u5206\u5e03\uff1a\u53d8\u91cf\u540d + 2 \u4e2a\u9644\u52a0\u6807\u8bc6\u7b26\u2014\u2014\u5854\u677f\u53f7 + \u7ec4\u5206\uff1b</p> </li> <li> <p>\u53cd\u5e94\u5668\u5185\u53cd\u5e94\u7cfb\u6570\uff1a\u53d8\u91cf\u540d + 3 \u4e2a\u9644\u52a0\u6807\u8bc6\u7b26\u2014\u2014\u53cd\u5e94\u5e8f\u53f7 + \u7ec4\u5206 + \u5b50\u7269\u6d41\u3002</p> </li> </ul> <p>\u627e\u5230\u591a\u503c\u53d8\u91cf\u8282\u70b9\u540e\uff0c\u5fc5\u987b\u6cbf\u6811\u5411\u4e0b\u904d\u5386\uff0c\u4e3a\u6bcf\u4e00\u7ef4\u63d0\u4f9b\u6807\u8bc6\u7b26\uff0c\u624d\u80fd\u62ff\u5230\u5355\u4e2a\u6570\u503c\u3002 \u6709\u4e9b\u8282\u70b9\u4e00\u6b21\u904d\u5386\u53ea\u4ee3\u8868\u4e00\u4e2a\u6807\u8bc6\u7b26\uff1b\u6709\u4e9b\u5219\u4ee3\u8868\u591a\u4e2a\u3002\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709 <code>Dimension</code> \u5c5e\u6027\uff1a</p> <ul> <li> <p><code>Dimension &gt; 0</code> \u2192 \u8be5\u8282\u70b9\u6709\u5b50\u8282\u70b9\uff1b</p> </li> <li> <p><code>Dimension</code> \u7684\u503c = \u8bbf\u95ee\u5176\u5b50\u8282\u70b9\u6240\u9700\u7684\u6807\u8bc6\u7b26\u4e2a\u6570\uff1b</p> </li> <li> <p>\u5404\u7ef4\u7f16\u53f7\u4ece 0 \u5f00\u59cb\uff0c\u5230 <code>Dimension-1</code> \u7ed3\u675f\u3002</p> </li> </ul> <p>\u83b7\u53d6\u5b50\u8282\u70b9\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u8fed\u4ee3\u5668\uff08\u5982 VB \u7684 <code>For Each</code>\uff09\u2014\u2014\u987a\u5e8f\u65e0\u5173\u65f6\u6700\u65b9\u4fbf\uff1b</p> </li> <li> <p><code>Item</code> \u5c5e\u6027\u2014\u2014\u6309\u7ef4\u63d0\u4f9b\u53c2\u6570\uff1a</p> <ul> <li> <p>\u6574\u6570 Location\uff08\u884c\u53f7\uff09\uff1a\u4ece 0 \u8ba1\u6570\u7684\u5e8f\u53f7\uff1b</p> </li> <li> <p>\u5b57\u7b26\u4e32 Label\uff1a\u8be5\u7ef4\u4e0b\u7684\u8282\u70b9\u6807\u7b7e\u3002</p> </li> </ul> </li> </ol> <p>\u6bcf\u7ef4\u7684\u6709\u6548\u4f4d\u7f6e/\u6807\u7b7e\u4e2a\u6570\u53ef\u901a\u8fc7\u96c6\u5408\u7684 <code>RowCount</code> \u5c5e\u6027\u83b7\u5f97\u3002</p> <p>\u6ce8\u610f\uff1a\u96c6\u5408\u4e0d\u4fdd\u8bc1\u4efb\u4f55\u7279\u5b9a\u987a\u5e8f\u3002\u82e5\u5fc5\u987b\u6309\u7279\u5b9a\u987a\u5e8f\u8bbf\u95ee\uff0c\u8bf7\u7528\u5b57\u7b26\u4e32 Label \u5b9a\u4f4d\uff1b\u4ec5\u5f53\u987a\u5e8f\u4e0d\u91cd\u8981\u65f6\uff0c\u624d\u7528 <code>For Each</code> \u6216\u6574\u6570\u5e8f\u53f7\u904d\u5386\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\uff1a</p> <p>\u5355\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u5854\u677f\u6e29\u5ea6\u5206\u5e03</p> <p>\u53cc\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u5854\u677f\u7ec4\u6210\u5206\u5e03</p> <p>\u4e09\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u53cd\u5e94\u7cfb\u6570</p>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E6%A8%A1%E6%8B%9F%E9%97%AE%E9%A2%98%EF%BC%88%E8%BF%90%E8%A1%8C%2B%2B%2B%E6%94%B6%E6%95%9B%E7%AD%89/","title":"\u63a7\u5236\u6a21\u62df\u95ee\u9898\uff08\u8fd0\u884c+++\u6536\u655b\u7b49","text":"<p>Happ \u5bf9\u8c61\u7684 Engine \u5c5e\u6027\u8fd4\u56de IHAPEngine \u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u662f\u6a21\u62df\u5f15\u64ce\u7684\u63a5\u53e3\u3002 Happ \u4e0e IHAPEngine \u63d0\u4f9b\u7684\u65b9\u6cd5\u4f7f\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u80fd\u591f\u8fd0\u884c\u5e76\u63a7\u5236\u6a21\u62df\u3002</p> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u6f14\u793a\u5982\u4f55\uff1a</p> <ol> <li> <p>\u63d0\u793a\u7528\u6237\u8f93\u5165\u6a21\u62df\u53c2\u6570\uff1b</p> </li> <li> <p>\u91cd\u65b0\u8fd0\u884c\u6a21\u62df\uff1b</p> </li> <li> <p>\u5c06\u66f4\u65b0\u540e\u7684\u7ed3\u679c\u5448\u73b0\u7ed9\u7528\u6237\u3002</p> </li> </ol> <pre><code>Public Sub RunExample(ByVal ihAPsim As Happ.IHapp)\n' \u672c\u4f8b\u4fee\u6539\u6a21\u62df\u53c2\u6570\u5e76\u91cd\u65b0\u8fd0\u884c\u6a21\u62df\nDim nStages As Object\nDim strPrompt As String\nOn Error GoTo ErrorHandler\n\nEditSimulation:\n' \u8bfb\u53d6\u5f53\u524d\u5854\u677f\u6570\nnStages = ihAPsim.Tree.Data.Blocks.B6.Input.Elements(\"NSTAGE\").Value\nstrPrompt = \"Existing number of stages for column B6 = \" &amp; nStages &amp; _\n            Chr(13) &amp; \"Enter new value for number of stages.\"\nnStages = InputBox(strPrompt)\nIf nStages = \"\" Then GoTo finish\n\n' \u4fee\u6539\u6a21\u62df\nihAPsim.Tree.Data.Blocks.B6.Input.Elements(\"NSTAGE\").Value = nStages\n\n' \u8fd0\u884c\u6a21\u62df\nihAPsim.Run()\n\n' \u67e5\u770b\u72b6\u6001\u4e0e\u7ed3\u679c\nCall ListBlocksExample(ihAPsim)\nCall TempProfExample(ihAPsim)\nGoTo EditSimulation\n\nfinish:\nExit Sub\nErrorHandler:\nMsgBox \"RunExample failed with error \" &amp; Err.Description\nEnd Sub\n</code></pre> <p>Python \u76f4\u8bd1\u7248\uff1a\u5faa\u73af\u63d0\u793a\u7528\u6237\u2192\u6539\u5854\u677f\u6570\u2192\u8fd0\u884c\u2192\u8f93\u51fa\u7ed3\u679c</p> <pre><code>import win32com.client as win32\nfrom tkinter import simpledialog, messagebox, Tk\n\ndef list_blocks_example(ap):\n    \"\"\"\u7b80\u6613\u7248\uff1a\u628a\u6a21\u5757\u5217\u8868\u6253\u5370\u5230\u5b57\u7b26\u4e32\"\"\"\n    blocks = ap.Tree.Data.Blocks.Elements\n    lines = [f\"{blk.Name}\\t{blk.AttributeValue(11)}\" for blk in blocks]\n    return \"\\n\".join(lines)\n\ndef temp_prof_example(ap):\n    \"\"\"\u7b80\u6613\u7248\uff1a\u8fd4\u56de B6 \u6e29\u5ea6\u5206\u5e03\u5b57\u7b26\u4e32\"\"\"\n    b_temp = ap.Tree.Data.Blocks.B6.Output.B_TEMP\n    rows = [f\"{stage.Name}\\t{stage.Value:.2f}\\t{stage.UnitString}\"\n            for stage in b_temp.Elements]\n    return \"\\n\".join(rows)\n\ndef run_example(ap):\n    \"\"\"\u4e0e VB RunExample \u5b8c\u5168\u4e00\u81f4\uff1a\u4ea4\u4e92\u2192\u6539\u53c2\u6570\u2192\u8fd0\u884c\u2192\u770b\u7ed3\u679c\"\"\"\n    root = Tk()\n    root.withdraw()          # \u9690\u85cf\u4e3b\u7a97\u53e3\n\n    while True:\n        n_stages_node = ap.Tree.Data.Blocks.B6.Input.Elements(\"NSTAGE\")\n        old_val = n_stages_node.Value\n\n        new_val = simpledialog.askinteger(\n            \"\u4fee\u6539\u5854\u677f\u6570\",\n            f\"\u5f53\u524d B6 \u5854\u677f\u6570 = {old_val}\\n\u8bf7\u8f93\u5165\u65b0\u503c\uff1a\",\n            minvalue=2, maxvalue=200)\n        if new_val is None:          # \u7528\u6237\u53d6\u6d88\n            break\n\n        # \u4fee\u6539\u6a21\u62df\n        n_stages_node.Value = new_val\n\n        # \u8fd0\u884c\u6a21\u62df\n        ap.Engine.Run2()\n\n        # \u67e5\u770b\u7ed3\u679c\n        blocks_txt = list_blocks_example(ap)\n        temp_txt   = temp_prof_example(ap)\n        messagebox.showinfo(\"\u8fd0\u884c\u7ed3\u679c\",\n                            f\"=== \u6a21\u5757\u72b6\u6001\n</code></pre> <p>\u53e6\u8bf7\u53c2\u9605\uff1aRun2 \u63a5\u53e3</p> <p>\u5feb\u901f\u5224\u65ad\u5404\u7c7b\u8ba1\u7b97\u6210\u8d25</p>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/","title":"\u63a7\u5236\u7528\u6237\u754c\u9762","text":"<p>HappLS \u5bf9\u8c61\u63d0\u4f9b\u7684\u65b9\u6cd5\u548c\u4e8b\u4ef6\uff0c\u8ba9\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u53ef\u4ee5\u4ece\u5185\u90e8\u63a7\u5236 Aspen Plus \u7684\u7528\u6237\u754c\u9762\uff0c\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <p>\u5904\u7406 Aspen Plus \u4e8b\u4ef6</p> <p>\u6291\u5236\uff08\u4e0d\u5f39\u51fa\uff09\u5bf9\u8bdd\u6846</p>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/","title":"\u6570\u636e\u503c\u4e0e\u8282\u70b9\u5c5e\u6027","text":"<p>\u6570\u636e\u503c</p> <p>\u8282\u70b9\u5c5e\u6027</p>"},{"location":"Aspen%2BGuide/%E6%9F%A5%E7%9C%8B%2BAspen%2BPlus%2B%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E4%B8%8E%E6%96%B9%E6%B3%95/","title":"\u67e5\u770b+Aspen+Plus+\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0e\u65b9\u6cd5","text":"<p>\u67e5\u770b Aspen Plus \u5bf9\u8c61\u7684\u5c5e\u6027\u4e0e\u65b9\u6cd5 \u53c2\u89c1\uff1aAspen Plus \u516c\u5f00\u7684\u5bf9\u8c61\u3001Aspen Plus \u6811\u5f62\u7ed3\u6784</p> <p>\u53ef\u5728\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u7684\u201c\u5bf9\u8c61\u6d4f\u89c8\u5668\u201d\u4e2d\u67e5\u770b Aspen Plus \u5bf9\u8c61\u7684\u5c5e\u6027\u4e0e\u65b9\u6cd5\uff1a</p> <ul> <li> <p>\u5728 Visual Basic \u4e0e Excel \u4e2d\uff0c\u70b9\u51fb\u83dc\u5355\u201c\u89c6\u56fe\u201d\u2192\u201c\u5bf9\u8c61\u6d4f\u89c8\u5668\u201d\u3002 \uff08Visual Basic Express \u9700\u5148\u542f\u7528\u201c\u5de5\u5177 | \u8bbe\u7f6e | \u4e13\u5bb6\u8bbe\u7f6e\u201d\u624d\u80fd\u770b\u5230\u8be5\u547d\u4ee4\u3002\uff09</p> </li> <li> <p>\u5728 Excel \u4e2d\uff0c\u5fc5\u987b\u6fc0\u6d3b\u6a21\u5757\u5de5\u4f5c\u8868\uff0c\u8be5\u83dc\u5355\u9879\u624d\u4f1a\u51fa\u73b0\u3002</p> </li> </ul> <p>\u5927\u591a\u6570 Aspen Plus \u5bf9\u8c61\u7684\u5c5e\u6027\u90fd\u53ef\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8fdb\u884c\u8bbe\u7f6e\uff0c\u4ee5\u4fee\u6539\u6a21\u62df\u95ee\u9898\uff1b\u4f46\u90e8\u5206\u6a21\u62df\u5bf9\u8c61\u5c5e\u6027\u4e3a\u53ea\u8bfb\u3002\u82e5\u67d0\u5c5e\u6027\u4e3a\u53ea\u8bfb\uff0c\u5728 VB \u7684\u5bf9\u8c61\u6d4f\u89c8\u5668\u4e2d\u4f1a\u660e\u786e\u6807\u6ce8\uff0c\u800c\u5728 Excel VBA \u7684\u5bf9\u8c61\u6d4f\u89c8\u5668\u4e2d\u5219\u4e0d\u4f1a\u663e\u793a\u3002</p>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/","title":"\u6d41\u7a0b\u56fe\u8fde\u901a\u6027\u4e0e\u81ea\u52a8\u5316","text":"<p>\u6d41\u7a0b\u56fe\u4e2d\u6a21\u5757\u4e0e\u6d41\u80a1\u4e4b\u95f4\u7684\u8fde\u63a5\u53ef\u901a\u8fc7\u81ea\u52a8\u5316\u670d\u52a1\u5668\u8bbf\u95ee\uff1b \u6b64\u5916\uff0c\u8fd9\u4e9b\u8fde\u63a5\u53ef\u4ee5\u88ab\u4fee\u6539\uff0c\u6a21\u5757\u548c\u6d41\u80a1\u4e5f\u53ef\u4ee5\u88ab\u6dfb\u52a0\u6216\u5220\u9664\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\uff1a</p> <p>\u8bbf\u95ee\u6d41\u7a0b\u56fe\u8fde\u63a5</p> <p>\u6d41\u7a0b\u56fe\u8fde\u63a5\u793a\u4f8b\u4ee3\u7801</p> <p>\u6a21\u5757\u4e0e\u6d41\u80a1\u7684\u64cd\u4f5c</p> <p>\u5e93\u53ca\u6a21\u578b\u9009\u9879\u677f\u5206\u7c7b\u7684\u64cd\u4f5c</p>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/","title":"\u7269\u7406\u91cf\u4e0e\u8ba1\u91cf\u5355\u4f4d","text":"<p>\u5bf9\u4e8e\u8868\u793a\u7269\u7406\u91cf\u7684\u503c\uff0c\u6709\u4e24\u4e2a\u91cd\u8981\u5c5e\u6027\uff1a</p> <ul> <li> <p>\u7269\u7406\u91cf\u672c\u8eab\uff08\u4f8b\u5982\u6e29\u5ea6\u6216\u538b\u529b\uff09</p> </li> <li> <p>\u8868\u8fbe\u8be5\u7269\u7406\u91cf\u6240\u7528\u7684\u5355\u4f4d\uff08\u4f8b\u5982\u5f00\u5c14\u6587\u5ea6\u6216\u534e\u6c0f\u5ea6\uff09</p> </li> </ul> <p>\u4ee5\u4e0b\u5404\u8282\u5c06\u8bf4\u660e\u5982\u4f55\uff1a</p> <p>\u68c0\u7d22\u67d0\u4e2a\u503c\u7684\u7269\u7406\u91cf\u53ca\u5176\u5355\u4f4d</p> <p>\u5c06\u8be5\u503c\u8f6c\u6362\u5230\u53e6\u4e00\u5957\u5355\u4f4d</p> <p>\u5728 Aspen Plus \u8fd0\u884c\u4e2d\u66f4\u6539\u5355\u4f4d</p>"},{"location":"Aspen%2BGuide/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9A%B4%E9%9C%B2%E7%9A%84%E5%AF%B9%E8%B1%A1/","title":"\u81ea\u52a8\u5316\u670d\u52a1\u5668\u66b4\u9732\u7684\u5bf9\u8c61","text":"<p>Aspen Plus \u516c\u5f00\u7684\u5bf9\u8c61 \u53c2\u89c1\uff1aHappLS \u5bf9\u8c61\u3001\u6253\u5f00\u6a21\u62df\u7684\u793a\u4f8b</p> <p>Aspen Plus \u901a\u8fc7 HappLS\uff08\u4e5f\u79f0 IHapp\uff09\u5bf9\u8c61\u5411\u5916\u66b4\u9732\u529f\u80fd\u3002Happ \u7c7b\u4ec5\u652f\u6301\u8fd9\u4e00\u79cd\u5bf9\u8c61\u7c7b\u578b\u3002\u53ef\u5c06 Aspen Plus \u5e94\u7528\u5bf9\u8c61\u58f0\u660e\u4e3a IHapp \u6216 HappLS \u7c7b\u578b\uff0c\u501f\u52a9\u8be5\u5bf9\u8c61\u5373\u53ef\u8bbf\u95ee\u5176\u4f59\u6240\u6709\u5bf9\u8c61\u53ca\u5176\u5c5e\u6027\u4e0e\u65b9\u6cd5\u3002</p> <p>Aspen Plus \u516c\u5f00\u7684\u5bf9\u8c61\u5982\u4e0b\uff1a</p> <p>\u8868\u683c</p> <p>\u590d\u5236</p> \u5bf9\u8c61 \u8bf4\u660e HappLS Aspen Plus \u5ba2\u6237\u7aef\u5bf9\u8c61 IHNode Aspen Plus \u95ee\u9898\u7684\u8f93\u5165\u4e0e\u7ed3\u679c\u6570\u636e\u4ee5\u6811\u5f62\u7ed3\u6784\u5448\u73b0\uff0c\u7531 IHNode \u5bf9\u8c61\u7ec4\u6210 IHNodeCol \u6bcf\u4e2a IHNode \u53ef\u62e5\u6709\u5b50\u8282\u70b9\uff0c\u8fd9\u4e9b\u5b50\u8282\u70b9\u88ab\u7ec4\u7ec7\u5728 IHNodeCol \u96c6\u5408\u5bf9\u8c61\u4e2d IHAPEngine \u63d0\u4f9b\u5bf9 Aspen Plus \u6a21\u62df\u5f15\u64ce\u7684\u63a5\u53e3 <p>\u4ee5\u4e0b\u4ee3\u7801\u6f14\u793a\u5982\u4f55\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u65b0\u5efa\u4e00\u4e2a Aspen Plus \u6a21\u62df\uff1a</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Dim MyAspenPlus As Object\nSet MyAspenPlus = CreateObject(\"Apwn.Document\")\nMyAspenPlus.InitNew2\n\n' \u5728\u6b64\u5904\u64cd\u4f5c Aspen Plus\n\n' \u4f7f\u7528\u5b8c\u6bd5\u540e\uff1a\nSet MyAspenPlus = Nothing\n</code></pre> <p>\u6ce8\u610f\uff1a\u672c\u8282\u8bb8\u591a\u793a\u4f8b\u4f7f\u7528 <code>CreateObject(\"Apwn.Document\")</code> \u521b\u5efa\u81ea\u52a8\u5316\u5bf9\u8c61\uff0c\u8be5\u8c03\u7528\u4e0d\u6307\u5b9a\u7248\u672c\u3002 \u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u5e26\u7248\u672c\u53f7\u7684\u8c03\u7528\uff1a\u5728\u5b57\u7b26\u4e32\u672b\u5c3e\u8ffd\u52a0 Aspen Plus \u7684\u5185\u90e8\u7248\u672c\u53f7\uff08\u5982 <code>\"Apwn.Document.26.0\"</code>\uff09\u3002 \u8fd9\u6837\uff0c\u5f53\u7cfb\u7edf\u4e2d\u88c5\u6709\u591a\u4e2a\u7248\u672c\u65f6\uff0c\u53ef\u786e\u4fdd\u542f\u52a8\u7684\u662f\u6307\u5b9a\u7248\u672c\uff1b\u5347\u7ea7 Aspen Plus \u65f6\u53ea\u9700\u66f4\u65b0\u7248\u672c\u53f7\u5373\u53ef\u3002</p> <p>HappLS \u5bf9\u8c61 HappLS\uff08\u5373 IHapp\uff09\u5bf9\u8c61\u662f Aspen Plus \u66b4\u9732\u7684\u4e3b\u5bf9\u8c61\uff0c\u63d0\u4f9b\u4ee5\u4e0b\u65b9\u6cd5\u4e0e\u5c5e\u6027\uff1a</p> <ul> <li> <p>\u6253\u5f00\u6a21\u62df\u95ee\u9898</p> </li> <li> <p>\u63a7\u5236 Aspen Plus \u56fe\u5f62\u754c\u9762\u7684\u53ef\u89c1\u6027</p> </li> <li> <p>\u4fdd\u5b58\u95ee\u9898</p> </li> <li> <p>\u5411\u5916\u53d1\u9001\u4e8b\u4ef6</p> </li> </ul> <p>\u6253\u5f00\u6a21\u62df\u7684\u793a\u4f8b \u4ee5\u4e0b VB \u793a\u4f8b\u4ece\u5907\u4efd\u6587\u4ef6 pfdtut.bkp \u83b7\u53d6\u5df2\u6709\u6a21\u62df\u95ee\u9898\u7684\u6a21\u62df\u5bf9\u8c61\uff0c\u5e76\u5c06 Visible \u5c5e\u6027\u8bbe\u4e3a True\uff0c\u4ee5\u663e\u793a Aspen Plus \u56fe\u5f62\u754c\u9762\u3002</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Function OpenSimulation() As Happ.IHapp\n\n    Dim ihAPSim As Happ.IHapp\n    On Error GoTo ErrorHandler\n\n    Const VERSION As String = \"V14\"\n    Const VERSIONNUMBER As String = \"34.0\"   '\u5185\u90e8\u7248\u672c\u53f7\n\n    '\u9ed8\u8ba4\u8def\u5f84\n    Dim defaultpath As String\n    defaultpath = Environment.GetEnvironmentVariable(\"ProgramFiles\") &amp; _\n                  \"\\AspenTech\\Aspen Plus \" &amp; VERSION &amp; \"\\GUI\"\n\n    '\u4ece\u6ce8\u518c\u8868\u8bfb\u53d6\u5b9e\u9645\u5b89\u88c5\u8def\u5f84\n    Dim path As String\n    Dim regKey As Microsoft.Win32.RegistryKey\n    regKey = Microsoft.Win32.Registry.LocalMachine. _\n             OpenSubKey(\"SOFTWARE\\AspenTech\\Aspen Plus\\\" &amp; VERSIONNUMBER &amp; \"\\mm\", False)\n\n    If regKey Is Nothing Then\n        regKey = Microsoft.Win32.Registry.LocalMachine. _\n                 OpenSubKey(\"SOFTWARE\\Wow6432Node\\AspenTech\\Aspen Plus\\\" &amp; _\n                            VERSIONNUMBER &amp; \"\\mm\", False)\n    End If\n\n    If Not regKey Is Nothing Then\n        path = regKey.GetValue(\"mmtop\", defaultpath).ToString()\n        regKey.Close()\n        path = path &amp; \"\\Examples\\\"\n    Else\n        path = defaultpath &amp; \"\\Examples\\\"\n    End If\n\n    '\u6253\u5f00\u5df2\u6709\u6a21\u62df\n    Dim AspenPlus As Object\n    AspenPlus = GetObject(path &amp; \"pfdtut.bkp\")\n    ihAPSim = AspenPlus.Application\n\n    '\u663e\u793a\u56fe\u5f62\u754c\u9762\n    ihAPSim.Visible = True\n\n    '\u8fd4\u56de Aspen Plus \u7684 Happ \u5bf9\u8c61\n    Set OpenSimulation = ihAPSim\n    Exit Function\n\nErrorHandler:\n    MsgBox \"OpenSimulation \u53d1\u751f\u9519\u8bef\uff1a\" &amp; Err.Description\n    End\nEnd Function\n</code></pre> <p>\u8bf4\u660e\uff1a <code>GetObject</code> \u5f15\u7528\u4f1a\u5728\u540e\u53f0\u542f\u52a8 AspenPlus.exe \u4f5c\u4e3a\u8fdb\u7a0b\u5916\u670d\u52a1\u5668\u3002\u968f\u540e\uff0c\u540c\u4e00\u8fdb\u7a0b\u6216\u5176\u4ed6\u8fdb\u7a0b\u5bf9\u540c\u4e00\u95ee\u9898\u6587\u4ef6\u7684\u4efb\u4f55\u5f15\u7528\uff0c\u90fd\u4f1a\u8fde\u63a5\u5230\u8be5\u5df2\u8fd0\u884c\u7684 Aspen Plus \u670d\u52a1\u5668\u5b9e\u4f8b\u3002</p> <p>Aspen Plus \u6811\u5f62\u7ed3\u6784 Aspen Plus \u5c06\u6a21\u62df\u95ee\u9898\u7684\u8f93\u5165\u4e0e\u7ed3\u679c\u6570\u636e\u7ec4\u7ec7\u6210\u6811\u5f62\u7ed3\u6784\u3002 \u8981\u8bbf\u95ee\u6240\u9700\u6570\u636e\uff0c\u5fc5\u987b\u5148\u7406\u89e3\u5e76\u904d\u5386\u8be5\u6811\uff0c\u5b9a\u4f4d\u5e76\u8bc6\u522b\u76ee\u6807\u53d8\u91cf\u3002\u4e3a\u6b64\uff0c\u53ef\u501f\u52a9 Aspen Plus \u7528\u6237\u754c\u9762\u4e2d\u7684\u201c\u53d8\u91cf\u6d4f\u89c8\u5668\uff08Variable Explorer\uff09\u201d\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/","title":"HappLS+\u7c7b\u6210\u5458","text":"<p>\u6807\u51c6 VB \u5c5e\u6027\u53ca\u7528\u4e8e\u64cd\u63a7\u4e3b\u7a97\u53e3\u7684\u5c5e\u6027 </p> <p>\u8bbf\u95ee\u5bf9\u8c61\u6a21\u578b\u5176\u4ed6\u90e8\u5206\u7684\u5c5e\u6027 </p> <p>\u57fa\u672c\u6587\u4ef6\u64cd\u4f5c </p> <p>\u4e0e CreateObject() \u914d\u5408\u4f7f\u7528\u7684\u521d\u59cb\u5316\u65b9\u6cd5 </p> <p>\u57fa\u672c\u8fd0\u884c\u64cd\u4f5c </p> <p>\u4e25\u683c\u901a\u8fc7\u81ea\u52a8\u5316\u5b9e\u73b0\u526a\u5207/\u7c98\u8d34\u7684\u9009\u533a\u7f13\u51b2\u533a\u64cd\u4f5c </p> <p>IAPHappEvent \u4e8b\u4ef6\u63a5\u53e3</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/","title":"IHAPEngine+\u7c7b\u6210\u5458","text":""},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/#_1","title":"\u4e00\u3001\u57fa\u672c\u8fd0\u884c\u63a7\u5236","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Run2([async]) <code>ap.Engine.Run2(True)</code> \u8fd0\u884c\u6a21\u62df\uff1bTrue=\u5f02\u6b65\uff08GUI \u53ef\u89c1\u65f6\u5fc5\u987b\u5f02\u6b65\uff09 Stop() <code>ap.Engine.Stop()</code> \u7acb\u5373\u505c\u6b62\u8ba1\u7b97 Reinit([obj_type, obj_id]) <code>ap.Engine.Reinit()</code> \u91cd\u521d\u59cb\u5316\uff1b\u65e0\u53c2\u4f1a\u5f39\u7a97\uff0c\u6709\u53c2\u5219\u5b9a\u5411\u91cd\u521d\u59cb\u5316 ReinitializeEO([hierarchy]) <code>ap.Engine.ReinitializeEO()</code> \u91cd\u5efa EO \u6a21\u578b\u5e76\u7528\u5f53\u524d\u7ed3\u679c\u91cd\u521d\u59cb\u5316 SynchronizeEO([hierarchy]) <code>ap.Engine.SynchronizeEO()</code> \u4ec5\u628a\u914d\u7f6e\u53d8\u66f4\u540c\u6b65\u5230 EO \u4fa7 MoveTo(obj_type, obj_id) <code>ap.Engine.MoveTo(IAP_MOVETO_BLOCK, \"B6\")</code> \u628a\u8fd0\u884c\u65ad\u70b9\u79fb\u5230\u6307\u5b9a\u5bf9\u8c61\uff08\u8c03\u8bd5/\u5206\u6b65\uff09"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/#stop-points","title":"\u4e8c\u3001\u65ad\u70b9\uff08Stop Points\uff09\u64cd\u7eb5","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e AddStopPoint(type, id, before_or_after) <code>ap.Engine.AddStopPoint(IAP_STOPPOINT_BLOCK, \"B6\", 1)</code> 1=before 2=after ClearStopPoints() <code>ap.Engine.ClearStopPoints()</code> \u6e05\u7a7a\u6240\u6709\u65ad\u70b9 DeleteStopPoint(index) <code>ap.Engine.DeleteStopPoint(1)</code> 1-based \u7d22\u5f15 StopPointCount <code>cnt = ap.Engine.StopPointCount</code> \u5f53\u524d\u65ad\u70b9\u4e2a\u6570 GetStopPoint(index, type, id, before_or_after) <code>ap.Engine.GetStopPoint(1, type, id, before)</code> \u8bfb\u65ad\u70b9\u4fe1\u606f\uff08\u51fa\u53c2\uff09"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/#_2","title":"\u4e09\u3001\u8fd0\u884c\u9009\u9879/\u5f15\u64ce\u6587\u4ef6\u8bbe\u7f6e","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e OptionSettings(type) <code>ap.Engine.OptionSettings(IAP_RUN_OPTION_XXX)</code> \u8bfb\u8fd0\u884c\u9009\u9879\u5e03\u5c14\u503c EngineFilesSettings(file) <code>ap.Engine.EngineFilesSettings(IAP_ENGINEFILES_LOG)</code> \u53d6\u5f15\u64ce\u6587\u4ef6\u8def\u5f84/\u8bbe\u7f6e"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/#happtlb","title":"\u56db\u3001\u5e38\u7528\u679a\u4e3e\u901f\u6284\uff08happ.tlb \u6284\uff09","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>IAP_REINIT_SIMULATION = 0      # \u6574\u6848\u91cd\u521d\u59cb\u5316\nIAP_MOVETO_BLOCK      = 3      # MoveTo \u76ee\u6807\u7c7b\u578b\nIAP_STOPPOINT_BLOCK   = 0      # \u65ad\u70b9\u7c7b\u578b\nIAP_STOPPOINT_BEFORE  = 1      # before\nIAP_STOPPOINT_AFTER   = 2      # after\n</code></pre>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPEngine%2B%E7%B1%BB%E6%88%90%E5%91%98/#python","title":"\u4e94\u3001Python \u5b8c\u6574\u6a21\u677f","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>import win32com.client as win32\nimport time\n\nap = win32.Dispatch(\"AspenPlus.Document.34.0\")\nap.InitFromArchive2(r\"pfdtut.bkp\", 0)\n\n# 1. \u5f02\u6b65\u8fd0\u884c + \u5b9e\u65f6\u65ad\u70b9\nap.Engine.AddStopPoint(0, \"B6\", 1)   # \u5728 B6 \u524d\u505c\nap.Engine.Run2(True)                 # True = \u5f02\u6b65\n\nwhile ap.Engine.IsRunning:\n    time.sleep(5)\n    ap.Engine.UpdateIdleStatus()     # \u5fc5\u987b\u5b9a\u671f\u8c03\uff0c\u91ca\u653e\u5185\u5b58+\u66f4\u65b0\u72b6\u6001\u6761\n\n# 2. \u4ece\u65ad\u70b9\u7ee7\u7eed\nap.Engine.MoveTo(3, \"B6\")            # \u79fb\u5230 B6 \u5f00\u59cb\u5904\nap.Engine.Run2(True)                 # \u7ee7\u7eed\u8dd1\n\n# 3. \u7ed3\u679c\nap.SaveAs(r\"pfdtut_new.bkp\")\nap.Quit()\n</code></pre> <p>\u8981\u70b9\u5c0f\u7ed3</p> <ol> <li> <p>Run2(True) \u5fc5\u987b\u914d UpdateIdleStatus() \u5faa\u73af\uff0c\u5426\u5219\u5185\u5b58\u4e0d\u91ca\u653e + \u72b6\u6001\u6761\u5361\u6b7b\u3002</p> </li> <li> <p>Reinit / ReinitializeEO / SynchronizeEO \u4e09\u5957\u91cd\u521d\u59cb\u5316\u6309\u9700\u6c42\u9009\u3002</p> </li> <li> <p>\u65ad\u70b9 API \u4e0e GUI \u7684\u201c\u5206\u6b65\u8fd0\u884c\u201d\u5b8c\u5168\u5bf9\u5e94\uff0c\u53ef\u7f16\u7a0b\u5b9e\u73b0\u8c03\u8bd5\u6d41\u7a0b\u3002</p> </li> </ol>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/","title":"IHAPLibRef+\u7c7b\u6210\u5458","text":"<p>\u4e0b\u9762\u628a IHAPLibRef \u6240\u6709\u201c\u5e93\u7ba1\u7406 + \u6a21\u578b\u9009\u9879\u677f\u5206\u7c7b\u201d\u6210\u5458\u4e00\u6b21\u6027\u5217\u5b8c\uff0c\u5e76\u7ed9\u51fa Python \u901f\u67e5+\u7528\u6cd5\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/#library","title":"\u4e00\u3001\u5e93\uff08Library\uff09\u64cd\u7eb5","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e CountLibs <code>n = libref.CountLibs</code> \u5f53\u524d\u5f15\u7528\u5e93\u6570\u91cf LibraryName(index) <code>name = libref.LibraryName(0)</code> \u7b2c index \u4e2a\u5e93\u7684\u540d\u5b57\uff080 \u8d77\uff09 LibraryPath(index) <code>path = libref.LibraryPath(0)</code> \u8fd4\u56de\u5b8c\u6574\u8def\u5f84\u5b57\u7b26\u4e32 InsertLibrary(path, loc) <code>disp = libref.InsertLibrary(r\"f:\\fcc.apm\", 0)</code> \u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u5e93\uff0c\u8fd4\u56de\u663e\u793a\u540d RemoveLibrary(loc) <code>libref.RemoveLibrary(2)</code> \u5220\u9664\u7b2c loc \u4e2a\u5f15\u7528 MoveLibrary(from, to) <code>libref.MoveLibrary(2, 0)</code> \u628a\u5e93\u4ece\u4f4d\u7f6e 2 \u79fb\u5230 0"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/#python","title":"Python \u5feb\u901f\u904d\u5386\u793a\u4f8b","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>libref = ap.LibRef\nfor i in range(libref.CountLibs):\n    print(i, libref.LibraryName(i), \"\u2192\", libref.LibraryPath(i))\n</code></pre>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/#category","title":"\u4e8c\u3001\u6a21\u578b\u9009\u9879\u677f\u5206\u7c7b\uff08Category\uff09\u64cd\u7eb5","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e CategoryName(index) <code>cat = libref.CategoryName(0)</code> \u7b2c index \u4e2a\u5206\u7c7b\u540d\u79f0 CategorySelected(name) <code>sel = libref.CategorySelected(\"Reactors\")</code> 1=\u5df2\u52fe\u9009\u663e\u793a\uff0c0=\u672a\u663e\u793a CategoryLocSelected(index) <code>sel = libref.CategoryLocSelected(0)</code> \u540c\u4e0a\uff0c\u6309\u5e8f\u53f7 MoveCategory(fr, to) <code>libref.MoveCategory(3, 0)</code> \u628a\u5206\u7c7b\u4ece\u4f4d\u7f6e 3 \u79fb\u5230 0"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/#python_1","title":"Python \u52fe\u9009/\u53d6\u6d88\u5206\u7c7b\u793a\u4f8b","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code># \u8ba9\u201cReactors\u201d\u5206\u7c7b\u5728\u6a21\u578b\u9009\u9879\u677f\u53ef\u89c1\nlibref.CategorySelected(\"Reactors\") = 1        # \u52fe\u9009\n# \u6216\u6309\u5e8f\u53f7\n# libref.CategoryLocSelected(5) = 1\n</code></pre>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHAPLibRef%2B%E7%B1%BB%E6%88%90%E5%91%98/#_1","title":"\u4e09\u3001\u5b8c\u6574\u6a21\u677f\uff1a\u63d2\u5165\u81ea\u5b9a\u4e49\u5e93\u5e76\u7f6e\u9876","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>import win32com.client as win32\n\nap = win32.Dispatch(\"AspenPlus.Document.34.0\")\nap.InitNew2()                      # \u65b0\u5efa\u7a7a\u767d\u6a21\u62df\n\nlibref = ap.LibRef\n\n# 1. \u628a\u81ea\u5b9a\u4e49\u5e93\u63d2\u5165\u5230\u9996\u4f4d\uff08\u7d22\u5f15 0\uff09\nnew_lib = r\"D:\\MyLibs\\fcc.apm\"\ndisp_name = libref.InsertLibrary(new_lib, 0)\nprint(\"\u5df2\u63d2\u5165\u5e93\uff1a\", disp_name)\n\n# 2. \u628a\u201cReactors\u201d\u5206\u7c7b\u79fb\u5230\u9009\u9879\u677f\u6700\u524d\nreact_idx = None\nfor i in range(libref.CountCategories):   # \u904d\u5386\u627e Reactors\n    if libref.CategoryName(i) == \"Reactors\":\n        react_idx = i\n        break\nif react_idx is not None and react_idx != 0:\n    libref.MoveCategory(react_idx, 0)     # \u79fb\u5230\u9996\u4f4d\n\n# 3. \u4fdd\u5b58\u5e26\u5e93\u5f15\u7528\u7684\u65b0\u6a21\u62df\nap.SaveAs(r\"D:\\MyLibs\\with_fcc.bkp\")\nap.Quit()\n</code></pre> <p>\u8fd0\u884c\u540e\u6253\u5f00 <code>with_fcc.bkp</code>\uff0c\u53ef\u5728\u6a21\u578b\u9009\u9879\u677f\u6700\u524d\u7aef\u770b\u5230\u81ea\u5b9a\u4e49\u5e93\uff0c\u4e14\u201cReactors\u201d\u5206\u7c7b\u5df2\u88ab\u7f6e\u9876\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/","title":"IHNode+\u7c7b\u6210\u5458","text":""},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#vb","title":"\u4e00\u3001\u6807\u51c6 VB \u5c5e\u6027\uff08\u53ea\u8bfb\uff09","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Application <code>node.Application</code> \u8fd4\u56de\u6240\u5c5e HappLS \u5bf9\u8c61 Parent <code>node.Parent</code> \u8fd4\u56de\u7236\u8282\u70b9"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#_1","title":"\u4e8c\u3001\u8bbf\u95ee\u5b50\u7ed3\u6784","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Dimension <code>node.Dimension</code> \u7ef4\u5ea6\u6570\uff1b0=\u6807\u91cf Elements <code>node.Elements</code> \u5b50\u8282\u70b9\u96c6\u5408\uff08IHNodeCol\uff09"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#_2","title":"\u4e09\u3001\u6570\u636e\u503c/\u5c5e\u6027/\u5355\u4f4d\uff08\u8bfb\u5199\uff09","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Value <code>node.Value = 3.14</code> \u5f53\u524d\u503c\uff1b\u7c7b\u578b\u89c1 ValueType ValueType <code>node.ValueType</code> 0 \u672a\u5b9a\u4e49 1=int 2=real 3=string 4=node ValueForUnit(row, col) <code>node.ValueForUnit(2, 3)</code> \u6309\u6307\u5b9a\u5355\u4f4d\u53d6\u503c UnitString <code>node.UnitString</code> \u5f53\u524d\u5355\u4f4d\u7b26\u53f7\u4e32 AttributeValue(n, [force]) <code>node.AttributeValue(HAP_UNITROW)</code> \u53d6\u5c5e\u6027\u503c\uff08HAP_* \u679a\u4e3e\uff09 AttributeType(n) <code>node.AttributeType(HAP_UNITROW)</code> \u8fd4\u56de\u8be5\u5c5e\u6027\u7c7b\u578b\uff081-5\uff09 HasAttribute(n) <code>node.HasAttribute(HAP_UNITROW)</code> \u8282\u70b9\u662f\u5426\u652f\u6301\u8be5\u5c5e\u6027 SetValueAndUnit(val, col) <code>node.SetValueAndUnit(3.14, 3)</code> \u540c\u65f6\u5199\u503c\u4e0e\u5355\u4f4d\u5217 SetValueUnitAndBasis(v, c, b) <code>node.SetValueUnitAndBasis(3.14, 3, \"MOLE\")</code> \u503c+\u5355\u4f4d+\u57fa\u51c6\u4e00\u6b21\u5199"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#_3","title":"\u56db\u3001\u5bfc\u822a/\u52a9\u624b","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e FindNode(path) <code>ap.Tree.FindNode(r\"\\Data\\Blocks\\B6\\Input\\NSTAGE\")</code> \u6309 Variable Explorer \u8def\u5f84\u8df3\u8f6c Name <code>node.Name</code> \u8282\u70b9\u540d\u79f0"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#_4","title":"\u4e94\u3001\u589e\u5220\u6539","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Clear() <code>node.Clear()</code> \u6e05\u7a7a\u8282\u70b9\u5185\u5bb9 Delete() <code>node.Delete()</code> \u5220\u9664\u8be5\u5143\u7d20 RemoveAll() <code>collection.RemoveAll()</code> \u6e05\u7a7a\u96c6\u5408"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#reconcile","title":"\u516d\u3001\u6279\u91cf\u6821\u6838\uff08Reconcile\uff09","text":"<p>\u7528\u9014\uff1a\u8ba9 Aspen \u6839\u636e\u8f93\u5165\u81ea\u52a8\u8865\u9f50/\u4fee\u6b63\u6d41\u80a1\u6216\u6a21\u5757\u7684 T/P/\u7ec4\u6210\u3001\u603b\u6d41\u91cf\u7b49\u3002 \u9002\u7528\u8282\u70b9\uff1a\u5355\u4e2a\u6d41\u80a1\u3001\u6a21\u5757\u3001Streams \u96c6\u5408\u3001\u6574\u4e2a Tree.Data\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#1","title":"1. \u5e38\u7528\u201c\u5bf9\u8c61\u8303\u56f4\u201d\u6807\u5fd7","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u5e38\u91cf\uff08hex\uff09 \u542b\u4e49 <code>0x2</code> \u4ec5\u66f4\u65b0\u6709\u8f93\u5165\u89c4\u683c\u7684\u6d41\u80a1 <code>0x400000</code> \u4ec5\u66f4\u65b0\u8fdb\u6599\u6d41\u80a1 <code>0x1000000</code> \u4ec5\u66f4\u65b0\u6d41\u80a1\uff08\u5c42\u6b21/\u5168\u6d41\u8868\uff09 <code>0x2000000</code> \u4ec5\u975e\u6d41\u80a1\uff08\u6a21\u5757\uff09 <code>0x4000000</code> \u4ec5\u6495\u88c2\u6d41\u80a1"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#2","title":"2. \u5e38\u7528\u201c\u53d8\u91cf\u7b56\u7565\u201d\u6807\u5fd7","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u5e38\u91cf\uff08hex\uff09 \u542b\u4e49 <code>0x1</code> \u6309\u8f93\u5165\u89c4\u683c <code>0x4</code> T+P \u4f5c\u72b6\u6001\u53d8\u91cf <code>0x8</code> T+V/F \u4f5c\u72b6\u6001\u53d8\u91cf <code>0x10</code> P+V/F \u4f5c\u72b6\u6001\u53d8\u91cf <code>0x20</code> \u6309\u7ec4\u5206\u6d41\u91cf\u66f4\u65b0\u6d41\u91cf/\u7ec4\u6210 <code>0x40</code> \u6309\u603b\u6d41+\u6469\u5c14\u5206\u6570\u66f4\u65b0 <code>0x80</code> MIXED \u5b50\u7269\u6d41 \u6469\u5c14\u57fa\u51c6 <code>0x100</code> MIXED \u5b50\u7269\u6d41 \u8d28\u91cf\u57fa\u51c6 <code>0x200</code> MIXED \u5b50\u7269\u6d41 \u6807\u51c6\u4f53\u79ef\u57fa\u51c6"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#3","title":"3. \u5bf9\u8bdd\u6846\u6291\u5236","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u5e38\u91cf\uff08hex\uff09 \u542b\u4e49 <code>0x100000</code> \u9759\u9ed8\uff08\u4e0d\u5f39\u4efb\u4f55\u7a97\uff09 <code>0x200000</code> \u4e0d\u5f39\u8b66\u544a/\u9519\u8bef\u7a97"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNode%2B%E7%B1%BB%E6%88%90%E5%91%98/#4-python","title":"4. Python \u4e00\u6b21\u6027\u8c03\u7528\u793a\u4f8b","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>HAPP_RECONCILE_INPUT   = 0x1\nHAPP_RECONCILE_ONLY    = 0x2\nHAPP_RECONCILE_QUIET   = 0x100000\n\n# \u8ba9 Aspen \u4ec5\u6839\u636e\u5df2\u6709\u8f93\u5165\u8865\u9f50\u6240\u6709\u6d41\u80a1\nap.Tree.Data.Streams.Reconcile(HAPP_RECONCILE_INPUT |\n                               HAPP_RECONCILE_ONLY |\n                               HAPP_RECONCILE_QUIET)\n</code></pre> <p>\u5373\u53ef\u5728\u540e\u53f0\u5b8c\u6210 T/P/\u6d41\u91cf/\u7ec4\u6210\u7684\u81ea\u52a8\u63a8\u7b97\uff0c\u65e0\u9700\u624b\u52a8\u586b\u5199\u3002</p>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/","title":"IHNodeCol+\u7c7b\u6210\u5458","text":""},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#vb","title":"\u4e00\u3001\u6807\u51c6 VB \u5c5e\u6027\uff08\u53ea\u8bfb\uff09","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Application <code>col.Application</code> \u8fd4\u56de\u6240\u5c5e HappLS \u5bf9\u8c61 Parent <code>col.Parent</code> \u8fd4\u56de\u7236\u8282\u70b9"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#_1","title":"\u4e8c\u3001\u4e3b\u5bfc\u822a\uff1a\u6309\u4f4d\u7f6e/\u6807\u7b7e\u53d6\u5b50\u8282\u70b9","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Item(loc_or_name) <code>col.Item(0)</code> \u6216 <code>col.Item(\"B6\")</code> \u6309\u5e8f\u53f7\u6216\u6807\u7b7e\u53d6\u5b50\u8282\u70b9\uff1b\u591a\u7ef4\u65f6\u53ef\u4f20\u591a\u4e2a\u53c2\u6570"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#_2","title":"\u4e09\u3001\u589e\u5220\u6539\u884c/\u5143\u7d20","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e **Add(...) ** <code>col.Add(\"B6!RADFRAC\")</code> \u65b0\u5efa\u5e76\u8fd4\u56de\u5b50\u8282\u70b9\uff1b\u683c\u5f0f <code>\"\u540d!\u7c7b\u578b\"</code> \u6216\u5e8f\u53f7 Insert(node, ...) <code>col.Insert(new_node, 2)</code> \u628a\u5df2\u6709\u8282\u70b9\u63d2\u5165\u6307\u5b9a\u4f4d\u7f6e Remove(...) <code>col.Remove(\"B6\")</code> \u5220\u9664\u5b50\u8282\u70b9\uff1b\u8fd4\u56de\u88ab\u5220\u8282\u70b9 InsertRow(dim, loc) <code>col.InsertRow(0, 3)</code> \u5728\u7b2c dim \u7ef4\u7b2c loc \u884c\u63d2\u5165\u7a7a\u884c RemoveRow(dim, loc) <code>col.RemoveRow(0, 3)</code> \u5220\u9664\u7b2c dim \u7ef4\u7b2c loc \u884c"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#_3","title":"\u56db\u3001\u5173\u952e\u7ef4\u5ea6/\u6807\u7b7e/\u884c\u6570","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Dimension <code>col.Dimension</code> \u7ef4\u5ea6\u6570\uff080=\u6807\u91cf\u5217\u8868\uff09 RowCount(dim) <code>col.RowCount(0)</code> \u6307\u5b9a\u7ef4\u7684\u884c\u6570 DimensionName(dim) <code>col.DimensionName(0)</code> \u7ef4\u5ea6\u7684\u663e\u793a\u540d\u79f0\uff08\u5982 \"Stage\"\uff09 Label(dim, loc) <code>col.Label(0, 5)</code> \u6307\u5b9a\u7ef4\u6307\u5b9a\u884c\u7684\u6807\u7b7e\u5b57\u7b26\u4e32 LabelLocation(label, dim) <code>col.LabelLocation(\"IC4\", 1)</code> \u6839\u636e\u6807\u7b7e\u8fd4\u56de\u884c\u53f7 IsNamedDimension(dim) <code>col.IsNamedDimension(0)</code> \u8be5\u7ef4\u884c\u662f\u5426\u7528\u6807\u7b7e\u547d\u540d ItemName(loc, [dim]) <code>col.ItemName(3, 0)</code> \u8fd4\u56de\u6307\u5b9a\u4f4d\u7f6e\u5143\u7d20\u7684\u540d\u79f0/\u884c\u540d"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#_4","title":"\u4e94\u3001\u6807\u7b7e\u8282\u70b9\u4e0e\u6807\u7b7e\u5c5e\u6027","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e LabelNode(dim, loc) <code>col.LabelNode(0, 5)</code> \u8fd4\u56de\u6807\u7b7e\u672c\u8eab\u5bf9\u5e94\u7684 IHNode\uff08\u53ef\u6539\u6807\u7b7e\u6587\u672c\uff09 LabelAttribute(dim, loc, attr) <code>col.LabelAttribute(0, 5, HAP_UNITROW)</code> \u53d6\u6807\u7b7e\u884c\u7684\u5c5e\u6027\u503c LabelAttributeType(dim, loc, attr) <code>col.LabelAttributeType(0, 5, HAP_UNITROW)</code> \u53d6\u6807\u7b7e\u884c\u7684\u5c5e\u6027\u7c7b\u578b"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#_5","title":"\u516d\u3001\u5176\u4ed6","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u540d\u79f0 Python \u7528\u6cd5 \u8bf4\u660e Count <code>col.Count</code> \u603b\u5143\u7d20\u4e2a\u6570\uff08\u6240\u6709\u7ef4\u4e58\u79ef\uff09"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/IHNodeCol%2B%E7%B1%BB%E6%88%90%E5%91%98/#python","title":"\u4e03\u3001Python \u901f\u7528\u6a21\u677f","text":"<p>Python</p> <p>\u590d\u5236</p> <pre><code>HAP_UNITROW = 3\ncol = ap.Tree.Data.Blocks.B6.Output.B_TEMP.Elements   # \u4ee5\u5854\u6e29\u4e3a\u4f8b\n\n# 1. \u904d\u5386\u5854\u677f\nfor loc in range(col.RowCount(0)):\n    stage_lbl = col.Label(0, loc)          # \"1\", \"2\", ...\n    temp_node = col.Item(loc)              # IHNode\n    print(stage_lbl, temp_node.Value, temp_node.UnitString)\n\n# 2. \u63d2\u5165\u7a7a\u5854\u677f\uff08\u884c\uff09\ncol.InsertRow(0, 3)   # \u5728\u7b2c 3 \u884c\u524d\u63d2\u5165\u65b0\u7a7a\u884c\n\n# 3. \u5220\u9664\u5854\u677f\uff08\u884c\uff09\ncol.RemoveRow(0, 15)  # \u5220\u9664\u7b2c 15 \u884c\n</code></pre>"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/IAPHappEvent%2B%E4%BA%8B%E4%BB%B6%E6%8E%A5%E5%8F%A3/","title":"IAPHappEvent+\u4e8b\u4ef6\u63a5\u53e3","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e OnDialogSuppressed(msg As String, result As String) Event \u5f53\u8b66\u544a\u4fe1\u606f\u88ab\u6291\u5236\u672a\u663e\u793a\uff0c\u6216\u672c\u5e94\u5f39\u7a97\u65f6\u88ab\u89e6\u53d1\u3002 msg\uff1a\u88ab\u6291\u5236\u7684\u8b66\u544a\u6587\u672c\u6216\u63cf\u8ff0\u4fe1\u606f\u3002 result\uff1a\u6d88\u606f\u6846\u7684\u9ed8\u8ba4\u6309\u94ae/\u9009\u9879\u503c\u3002 OnControlPanelMessage(clear As Boolean, msg As String) Event \u63a7\u5236\u9762\u677f\u4ea7\u751f\u6d88\u606f\u65f6\u89e6\u53d1\u3002 clear=True \u65f6\u8868\u793a\u6e05\u7a7a\u9762\u677f\uff1b\u5426\u5219 msg \u4e3a\u8981\u663e\u793a\u7684\u65b0\u884c\u6587\u672c\u3002 OnGUIClosing() Event \u7528\u6237\u4ea4\u4e92\u5173\u95ed\u4e3b\u7a97\u53e3\u65f6\u89e6\u53d1\u3002\u53ef\u7528\u4e8e\u901a\u77e5\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5\uff1b\u4e0d\u8868\u793a\u670d\u52a1\u5668\u5df2\u9000\u51fa\uff0c\u4ec5 GUI \u5173\u95ed\u3002 OnDataChanged(pObj As Object) Event \u6570\u636e\u88ab\u4fee\u6539\u65f6\u89e6\u53d1\uff0c\u53ef\u7528\u6765\u68c0\u67e5\u8f93\u5165\u5b8c\u6574\u6027\u3002 pObj\uff1a\u88ab\u4fee\u6539\u7684\u5bf9\u8c61\uff08\u901a\u5e38\u4e3a IHNode\uff09\u3002 <p>\u4e0e\u4e8b\u4ef6\u63a5\u53e3\u76f8\u5173\u7684\u5c5e\u6027</p> \u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e SuppressDialogs As Integer Property \u662f\u5426\u6291\u5236\u6d88\u606f/\u5bf9\u8bdd\u6846\u3002 \u81ea\u52a8\u5316\u542f\u52a8\u65f6\u9ed8\u8ba4\u4e3a True\uff08\u975e\u96f6\uff09\uff1b\u82e5\u968f\u540e\u4f9b\u4ea4\u4e92\u4f7f\u7528\uff0c\u5e94\u8bbe\u4e3a False\uff08\u96f6\uff09\u3002"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/VB%E5%B1%9E%E6%80%A7/","title":"VB\u5c5e\u6027","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e Activate() Sub \u6fc0\u6d3b\u5e94\u7528\u7a0b\u5e8f Application As HappLS Property \u662f \u8fd4\u56de\u5bf9\u8c61\u7684\u6240\u5c5e\u5e94\u7528\u7a0b\u5e8f FullName As String Property \u662f \u8fd4\u56de\u5e94\u7528\u7a0b\u5e8f\u7684\u5b8c\u6574\u8def\u5f84\u540d Name As String Property \u662f \u8fd4\u56de\u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0 Parent As Happ Property \u662f \u8fd4\u56de\u5bf9\u8c61\u7684\u521b\u5efa\u8005 Visible As Boolean Property \u8fd4\u56de/\u8bbe\u7f6e\u5e94\u7528\u7a0b\u5e8f\u7684\u53ef\u89c1\u72b6\u6001 UpdateIdleStatus() Sub \u66f4\u65b0\u4e3b\u7a97\u53e3\u53f3\u4e0b\u89d2\u7684\u6a21\u62df\u72b6\u6001\uff0c\u5e76\u91ca\u653e\u5df2\u5220\u9664\u5bf9\u8c61\u5360\u7528\u7684\u5185\u5b58\u3002\u5e94\u5728\u91cd\u5199 OnIdle() \u7684\u51fd\u6570\u4e2d\u8c03\u7528\uff0c\u5426\u5219\u72b6\u6001\u4e0d\u4f1a\u66f4\u65b0\u4e14\u5185\u5b58\u4e0d\u4f1a\u88ab\u91ca\u653e\u3002"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/%E4%B8%8E%2BCreateObject%2B%2B%2B%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95/","title":"\u4e0e+CreateObject+++\u914d\u5408\u4f7f\u7528\u7684\u521d\u59cb\u5316\u65b9\u6cd5","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e InitFromArchive2(filename, host_type, node, username, password, working_directory, failmode) Sub \u6253\u5f00 Aspen Plus \u5b58\u6863\u6587\u4ef6\u5e76\u8fde\u63a5\u81f3\u6a21\u62df\u5f15\u64ce\u3002filename \u4e3a\u5f85\u6253\u5f00\u7684\u6587\u4ef6\u540d\uff1b\u5176\u4f59\u53c2\u6570\u5747\u5df2\u5e9f\u5f03\uff0c\u53ef\u7701\u7565\u3002 InitFromTemplate2(filename, \u2026) Sub \u6253\u5f00\u6a21\u677f\u5e76\u521d\u59cb\u5316\uff1b\u53c2\u6570\u5217\u8868\u4e0e InitFromArchive2 \u76f8\u540c\u3002 InitFromFile2(filename, \u2026) Sub \u6253\u5f00 Aspen Plus \u6587\u6863\u5e76\u8fde\u63a5\u81f3\u6a21\u62df\u5f15\u64ce\uff1b\u53c2\u6570\u5217\u8868\u4e0e InitFromArchive2 \u76f8\u540c\u3002"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/%E4%B8%A5%E6%A0%BC%E9%80%9A%E8%BF%87%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AE%9E%E7%8E%B0%E5%89%AA%E5%88%87%2B%E7%B2%98%E8%B4%B4%E7%9A%84%E9%80%89%E5%8C%BA%E7%BC%93%E5%86%B2%E5%8C%BA%E6%93%8D%E4%BD%9C/","title":"\u4e25\u683c\u901a\u8fc7\u81ea\u52a8\u5316\u5b9e\u73b0\u526a\u5207+\u7c98\u8d34\u7684\u9009\u533a\u7f13\u51b2\u533a\u64cd\u4f5c","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e DeleteSelection(Key As String) Sub \u5220\u9664\u6307\u5b9a\u952e\u7684\u9009\u53d6\u7f13\u51b2\u533a\u3002 NewSelection(Key As String) As IHSelection Function \u65b0\u5efa\u5e76\u8fd4\u56de\u4e00\u4e2a\u9009\u53d6\u7f13\u51b2\u533a\u3002 SaveSelection(Key As String) Sub \u4fdd\u5b58\u6307\u5b9a\u952e\u7684\u9009\u53d6\u7f13\u51b2\u533a\u3002 Selection(Key As String) As IHSelection Property \u662f \u83b7\u53d6\u6307\u5b9a\u952e\u7684\u9009\u53d6\u7f13\u51b2\u533a\u3002"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/%E5%9F%BA%E6%9C%AC%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/","title":"\u57fa\u672c\u6587\u4ef6\u64cd\u4f5c","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e Save() Sub \u4fdd\u5b58\u5f53\u524d\u6587\u4ef6 SaveAs(filename As String, [overwrite]) Sub \u4ee5\u65b0\u540d\u79f0\u4fdd\u5b58\u5f53\u524d\u6587\u4ef6\uff1b\u53ef\u9009\u8986\u76d6 Restore2(filename As String) Property \u662f \u5c06\u5b58\u6863\u6587\u4ef6\u8fd8\u539f/\u5408\u5e76\u5230\u5f53\u524d\u95ee\u9898 WriteArchive2(filename As String, savechildren As Long) Sub \u5bfc\u51fa\u5b58\u6863\u6587\u4ef6 Export(reptype As HAPEXPType, filename As String) Sub \u6309\u6307\u5b9a\u7c7b\u578b\u5bfc\u51fa\u6587\u4ef6\uff1breptype \u53d6\u503c\u89c1\u4e0b\u8868 <p>HAPEXPType \u679a\u4e3e\uff08\u540d\u79f0 \u2192 \u6570\u503c \u2192 \u542b\u4e49\uff09</p> Named Constant Numerical Value Meaning HAPEXP_BACKUP 1 \u5907\u4efd\u6587\u4ef6\uff08.bkp\uff09 HAPEXP_REPORT 2 \u62a5\u544a\u6587\u4ef6\uff08.rep\uff09 HAPEXP_SUMMARY 3 \u6458\u8981\u6587\u4ef6\uff08.sum\uff09 HAPEXP_INPUT 4 \u8f93\u5165\u6587\u4ef6\uff08.inp\uff09 HAPEXP_INPUT_GRAPHICS 5 \u8f93\u5165 + \u56fe\u5f62\u6570\u636e\u6587\u4ef6 HAPEXP_INPUT_WITH_GRAPHICS 18 \u542b\u56fe\u5f62\u7684\u8f93\u5165\u6587\u4ef6 HAPEXP_RUNMSG 6 \u8fd0\u884c\u6d88\u606f\u6587\u4ef6\uff08.msg\uff09 HAPEXP_REPORT_INPUT 7 \u62a5\u544a + \u8f93\u5165\u6587\u4ef6 HAPEXP_REPORT_SUMMARY 8 \u62a5\u544a + \u6458\u8981\u6587\u4ef6 HAPEXP_FLOWDYN 9 \u6d41\u91cf\u9a71\u52a8\u52a8\u6001\u4eff\u771f\u6587\u4ef6 HAPEXP_PDYN 10 \u538b\u529b\u9a71\u52a8\u52a8\u6001\u4eff\u771f\u6587\u4ef6"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/%E5%9F%BA%E6%9C%AC%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C/","title":"\u57fa\u672c\u8fd0\u884c\u64cd\u4f5c","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e Reinit() Sub \u91cd\u65b0\u521d\u59cb\u5316\u6574\u4e2a\u6a21\u62df\u6848\u4f8b\u3002\u82e5\u53ea\u9700\u91cd\u521d\u59cb\u5316\u7279\u5b9a\u6a21\u5757\u6216\u6d41\u80a1\uff0c\u8bf7\u4f7f\u7528 IHAPEngine \u7c7b\u7684 Reinit \u6210\u5458\u3002 Run2([asynchronous]) Sub \u8fd0\u884c\u6a21\u62df\u6848\u4f8b\uff1b\u82e5\u53c2\u6570\u4e3a True \u5219\u4ee5\u5f02\u6b65\u65b9\u5f0f\u8fd0\u884c\u3002\u5f53\u7528\u6237\u754c\u9762\u53ef\u89c1\u65f6\uff0c\u5e94\u59cb\u7ec8\u4f7f\u7528\u5f02\u6b65\u65b9\u5f0f\u8fd0\u884c\u3002"},{"location":"Aspen%2BGuide/Aspen%2BPlus%2B%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98/HappLS%2B%E7%B1%BB%E6%88%90%E5%91%98/%E8%AE%BF%E9%97%AE%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B%E5%85%B6%E4%BB%96%E9%83%A8%E5%88%86%E7%9A%84%E5%B1%9E%E6%80%A7/","title":"\u8bbf\u95ee\u5bf9\u8c61\u6a21\u578b\u5176\u4ed6\u90e8\u5206\u7684\u5c5e\u6027","text":"\u540d\u79f0\u4e0e\u53c2\u6570 \u6210\u5458\u7c7b\u578b \u53ea\u8bfb \u8bf4\u660e Engine As IHAPEngine Property \u662f \u8fd4\u56de\u6a21\u62df\u5f15\u64ce\u7684\u63a5\u53e3 Tree As Happ.IHNode Property \u662f \u83b7\u53d6\u6587\u4ef6\u7684\u6839\u8282\u70b9"},{"location":"Aspen%2BGuide/%E4%BB%8E%E5%85%B6%E4%BB%96%E8%AF%AD%E8%A8%80%E8%B0%83%E7%94%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3/%E5%8F%A6%E8%AF%B7%E5%8F%82%E9%98%85%2B%E4%BB%8E%2BC%2B%2B%2B%E8%B0%83%E7%94%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3/","title":"\u53e6\u8bf7\u53c2\u9605+\u4ece+C+++\u8c03\u7528\u81ea\u52a8\u5316\u63a5\u53e3","text":"<p>\u60a8\u53ef\u4ee5\u5728 C++ \u7a0b\u5e8f\u4e2d\u4f7f\u7528 Aspen Plus \u7684\u81ea\u52a8\u5316\u529f\u80fd\u3002 \u50cf\u5bf9\u5f85\u4efb\u4f55 COM \u5bf9\u8c61\u4e00\u6837\uff0c\u901a\u8fc7 vtable \u65b9\u5f0f \u94fe\u63a5\u5230 Aspen Plus \u7c7b\u578b\u5e93\u5373\u53ef\u3002</p> <p>\u4ee3\u7801\u4e2d\u5e94\u5b9a\u671f\u8c03\u7528 void UpdateIdleStatus() \u51fd\u6570\uff1a</p> <ul> <li> <p>\u66f4\u65b0 GUI \u53f3\u4e0b\u89d2\u4eff\u771f\u72b6\u6001\u6d88\u606f</p> </li> <li> <p>\u91ca\u653e\u5df2\u5220\u9664\u5bf9\u8c61\u5360\u7528\u7684\u5185\u5b58</p> </li> </ul> <p>\u5efa\u8bae\u9891\u7387\uff1a</p> <ul> <li> <p>\u8ba1\u7b97\u7b2c 1 \u5206\u949f\u5185\u6bcf 10 \u79d2\u8c03\u7528 1 \u6b21</p> </li> <li> <p>\u4e4b\u540e\u6bcf 30 \u79d2\u8c03\u7528 1 \u6b21 \u66f4\u9891\u7e41\u8c03\u7528\u4e0d\u4f1a\u5e26\u6765\u526f\u4f5c\u7528\uff0c\u4ec5\u589e\u52a0\u6781\u5c0f\u5f00\u9500\u3002</p> </li> </ul> <p>\u5bf9\u8bdd\u6846\u884c\u4e3a</p> <ul> <li> <p>\u82e5\u4ece\u672a\u8c03\u7528 SuppressDialogs\uff0c\u5219 Visible \u5c5e\u6027 \u51b3\u5b9a\u662f\u5426\u5f39\u7a97\uff1b</p> </li> <li> <p>\u4e00\u65e6\u8c03\u7528 SuppressDialogs\uff0cVisible \u5bf9\u540e\u7eed\u8fd0\u884c\u5931\u6548\uff0c\u7531 SuppressDialogs \u53c2\u6570\u51b3\u5b9a\u5904\u7406\u65b9\u5f0f\u3002</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3%E4%B8%AD%E5%AF%BC%E8%88%AA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/Dot%2B%E8%AE%B0%E6%B3%95%E5%AF%BC%E8%88%AA%E6%A0%91%E7%BB%93%E6%9E%84/","title":"Dot+\u8bb0\u6cd5\u5bfc\u822a\u6811\u7ed3\u6784","text":"<p>\u53ef\u4ee5\u628a <code>Item</code>\uff08\u6216 <code>Elements</code>\uff09\u4e00\u8def\u94fe\u4e0b\u53bb\uff0c\u4f8b\u5982\uff1a</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Set ihNStageNode = ihAPsim.Elements(\"Data\") _\n                  .Elements(\"Blocks\") _\n                  .Elements(\"B6\") _\n                  .Elements(\"Input\") _\n                  .Elements(\"NSTAGE\")\n</code></pre> <p>\u66f4\u7b80\u6d01\u7684\u5199\u6cd5\u662f\u76f4\u63a5\u4f7f\u7528\u201c\u70b9\u5206\u201d\u8def\u5f84\uff1a</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Set ihNStageNode = ihAPsim.Tree.Data.Blocks.B6.Input.NSTAGE\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ul> <li> <p>\u53ea\u6709\u8282\u70b9\u540d\u7b26\u5408\u7f16\u7a0b\u8bed\u8a00\u6807\u8bc6\u7b26\u89c4\u5219\uff08\u65e0\u7a7a\u683c\u3001\u65e0\u7279\u6b8a\u5b57\u7b26\u3001\u975e\u4fdd\u7559\u5b57\uff09\u65f6\u624d\u53ef\u7528\u8fd9\u79cd\u7b80\u5199\u3002 \u4f8b\uff1a\u540d\u5b57\u91cc\u5e26\u7a7a\u683c <code>\"Unit Table\"</code> \u6216 VB \u4fdd\u7559\u5b57 <code>\"Value\"</code> \u65f6\uff0c\u5fc5\u987b\u9000\u56de <code>Elements(\"Unit Table\")</code> \u6216 <code>Elements(\"VALUE\")</code> \u5f62\u5f0f\u3002</p> </li> <li> <p>\u4ee5\u4e0b\u8282\u70b9\u7c7b\u578b\u4e0d\u652f\u6301\u70b9\u5206\u7b80\u5199\uff1a connection\u3001port\u3001setting table\u3001route\u3001label\u3001unit table\u3002 \u8bbf\u95ee\u8fd9\u4e9b\u8282\u70b9\u4ecd\u9700\u663e\u5f0f\u4f7f\u7528 <code>Elements(\"...\")</code> \u6216 <code>FindNode</code>\u3002</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3%E4%B8%AD%E5%AF%BC%E8%88%AA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/%E4%BE%8B%E5%AD%90/","title":"\u4f8b\u5b50","text":"<p>\u4e0b\u9762\u8fd9\u6bb5 VB \u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u901a\u8fc7\u96c6\u5408\u5bf9\u8c61\u9010\u7ea7\u83b7\u53d6\u6811\u8282\u70b9\uff0c\u5e76\u8bf4\u660e\u4e86 IHNodeCol \u7684\u4e24\u79cd\u8bbf\u95ee\u65b9\u5f0f\uff1a\u904d\u5386\u4e0e\u663e\u5f0f\u7d22\u5f15\u3002</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Sub GetCollectionExample(ByVal ihAPsim As Happ.IHapp)\n    ' \u793a\u4f8b\uff1a\u4f7f\u7528\u96c6\u5408\u5bf9\u8c61\u83b7\u53d6\u6839\u8282\u70b9\u7684\u4e0b\u4e00\u7ea7\n    Dim ihRoot   As Happ.IHNode     '\u6839\u8282\u70b9\n    Dim ihcolOffspring As Happ.IHNodeCol  '\u5b50\u8282\u70b9\u96c6\u5408\n    Dim ihOffspring As Happ.IHNode        '\u5355\u4e2a\u8282\u70b9\n    Dim strOut As String\n\n    On Error GoTo ErrorHandler\n\n    '1. \u53d6\u6839\u8282\u70b9\n    ihRoot = ihAPsim.Tree\n\n    '2. \u53d6\u6839\u8282\u70b9\u4e0b\u4e00\u7ea7\u96c6\u5408\uff08Data\u3001Unit Table\u3001Settings\uff09\n    ihcolOffspring = ihRoot.Elements\n\n    '3. \u904d\u5386\u65b9\u5f0f\uff1aFor Each \u2026 Next\n    strOut = \"\"\n    For Each ihOffspring In ihcolOffspring\n        strOut = strOut &amp; vbCrLf &amp; ihOffspring.Name\n    Next\n    MsgBox \"Offspring nodes are:\" &amp; strOut, , \"GetCollectionExample\"\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"GetCollectionExample \u62a5\u9519\uff1a\" &amp; Err.Description\nEnd Sub\n</code></pre> <p>\u96c6\u5408\u8bbf\u95ee\u7684\u4e24\u79cd\u5199\u6cd5</p> <ol> <li>\u904d\u5386\uff1a</li> </ol> <p>vb</p> <p>\u590d\u5236</p> <pre><code>For Each ihOffspring In ihcolOffspring\n    '\u2026\nNext\n</code></pre> <ol> <li>\u663e\u5f0f\u7d22\u5f15\uff08Item \u4e3a\u9ed8\u8ba4\u5c5e\u6027\uff0c\u53ef\u7701\u7565\uff09\uff1a</li> </ol> <p>vb</p> <p>\u590d\u5236</p> <pre><code>ihDataNode = ihcolOffspring.Item(\"Data\")   '\u6216\u7b80\u5199\uff1a\nihDataNode = ihcolOffspring(\"Data\")\n</code></pre> <ul> <li> <p>\u8282\u70b9\u540d\u79f0\u533a\u5206\u5927\u5c0f\u5199\u3002</p> </li> <li> <p>Dimension \u51b3\u5b9a Item \u9700\u8981\u7684\u53c2\u6570\u4e2a\u6570\uff1a \u2013 \u82e5 <code>Dimension = 1</code>\uff1a\u53ea\u9700 1 \u4e2a\u53c2\u6570\uff0c\u5982 <code>\"Data\"</code> \u2013 \u82e5 <code>Dimension = 2</code>\uff1a\u9700 2 \u4e2a\u53c2\u6570\uff0c\u5982 <code>ihcolOffspring(\"Data\", \"id2\")</code></p> </li> </ul> <p>\u7528Python\u6765\u89e3\u91ca</p> <p>1.\u8fde\u63a5Aspen</p> <pre><code>import win32com.client as win32\nimport os\n\nVERSION_NUMBER = \"34.0\"          # \u5bf9\u5e94 V14\nprog_id = f\"AspenPlus.Document.{VERSION_NUMBER}\"  # \u8fdb\u7a0b\u5916\u670d\u52a1\u5668\n\n# \u65b0\u5efa\u7a7a\u767d\u6a21\u62df\nap = win32.Dispatch(prog_id)\nap.InitNew2()\n\n# \u5982\u679c\u6253\u5f00\u5df2\u6709\u6587\u4ef6\n# ap = win32.GetObject(r\"\u5b8c\u6574\u8def\u5f84\\xxx.bkp\")\n</code></pre> <ol> <li>\u53d6\u6839\u8282\u70b9\u5e76\u904d\u5386\u7b2c\u4e00\u5c42</li> </ol> <pre><code>root = ap.Tree                       # HappLS.Tree -&gt; IHNode\ncol = root.Elements                  # IHNodeCol\n\nfor node in col:                     # For Each \u2026 Next \u7684 Python \u7248\n    print(node.Name)\n</code></pre> <ol> <li>\u663e\u5f0f\u53d6\u5b50\u8282\u70b9\uff08Dimension=1 \u65f6\uff09</li> </ol> <pre><code>data_node = col(\"Data\")              # \u9ed8\u8ba4\u5c5e\u6027 Item\uff0c\u53ef\u7701\u7565\n# \u6216 data_node = col.Item(\"Data\")\n</code></pre> <ol> <li>\u7ee7\u7eed\u5f80\u6df1\u5904\u94bb</li> </ol> <p>Python</p> <p>\u590d\u5236</p> <pre><code>blocks_col = data_node.Elements(\"Blocks\").Elements\nb6 = blocks_col(\"B6\")                # \u53d6\u51fa RadFrac \u6a21\u5757 B6\ninput_node = b6.Elements(\"Input\")(\"NSTAGE\")   # \u5854\u677f\u6570\u8282\u70b9\nprint(input_node.Value)              # \u8bfb/\u5199\u5747\u53ef\n</code></pre> <ol> <li>\u8fd0\u884c\u3001\u4fdd\u5b58\u3001\u9000\u51fa</li> </ol> <pre><code>ap.Engine.Run2()                     # \u8c03\u7528 IHAPEngine\nap.SaveAs(r\"C:\\Temp\\my.bkp\")\nap.Quit()\n</code></pre> <ol> <li>\u9519\u8bef\u5904\u7406</li> </ol> <pre><code>import pythoncom\npythoncom.CoInitialize()             # \u591a\u7ebf\u7a0b\u73af\u5883\u9700\u8981\ntry:\n    ap = win32.Dispatch(prog_id)\n    ...\nexcept Exception as e:\n    print(\"COM \u9519\u8bef:\", e)\nfinally:\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E5%9C%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3%E4%B8%AD%E5%AF%BC%E8%88%AA%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E7%9A%84%E9%99%90%E5%88%B6/","title":"\u81ea\u52a8\u5316\u6570\u636e\u8bbf\u95ee\u7684\u9650\u5236","text":"<p>\u4ee5\u4e0b\u53d8\u91cf/\u7ed3\u679c\u65e0\u6cd5\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8bfb\u53d6\uff1a</p> <ul> <li> <p>\u5854\u5668\uff08Column\uff09\u5206\u6790\u7ed3\u679c</p> </li> <li> <p>\u6536\u655b\u76d1\u89c6\u5668\uff08Convergence Monitor\uff09\u76f8\u5173\u53d8\u91cf</p> </li> <li> <p>BatchOp \u4e0e BatchSep \u6a21\u5757\u7684\u7ed3\u679c</p> </li> <li> <p>\u6279\u5904\u7406\u6d41\u7a0b\u7684 strip-chart \u56fe\u7ebf\u53ca\u5168\u90e8\u65f6\u95f4\u5e8f\u5217\u7ed3\u679c</p> </li> </ul> <p>\u6d41\u80a1\u7ed3\u679c\u53ef\u4ee5\u8bbf\u95ee\uff0c\u4f46\u5728\u201cStream Summary\u201d\u91cc\u989d\u5916\u6dfb\u52a0\u7684\u5c5e\u6027\u53ef\u80fd\u53d6\u4e0d\u5230\u3002 \u6b63\u786e\u7684\u6d41\u80a1\u7ed3\u679c\u8def\u5f84\u4f4d\u4e8e\uff1a</p> <p><code>\\Data\\Streams\\&lt;\u6d41\u80a1ID&gt;\\Stream Results\\Table\\</code></p> <p>\u793a\u4f8b\u2014\u2014\u8bfb\u53d6\u6d41\u80a1 3 \u7684\u5c5e\u6027\u96c6\u53d8\u91cf VVSTDMFL\uff08cuft/hr\uff09\uff1a</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Set node = ap.Tree.FindNode(\"\\Data\\Streams\\3\\Stream Results\\Table\\VVSTDMFL cuft/hr  #1\")\n</code></pre> <p>\u786e\u4fdd\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u5728 Setup | Report Options | Stream | Property Sets \u91cc\u65b0\u5efa\u6216\u5f15\u7528\u5305\u542b VVSTDMFL \u7684\u5c5e\u6027\u96c6\u3002</p> </li> <li> <p>\u91cd\u65b0\u8fd0\u884c\u6a21\u62df\u3002</p> </li> <li> <p>\u7528\u53d8\u91cf\u6d4f\u89c8\u5668\u786e\u8ba4\u8be5\u8282\u70b9\u5df2\u5b58\u5728\uff0c\u518d\u4e8e\u4ee3\u7801\u4e2d\u8bbf\u95ee\u3002</p> </li> </ol>"},{"location":"Aspen%2BGuide/%E5%BC%95%E7%94%A8%E9%9D%9E%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE/%E4%B8%89%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%8F%8D%E5%BA%94%E7%B3%BB%E6%95%B0/","title":"\u4e09\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u53cd\u5e94\u7cfb\u6570","text":"<p>pfdtut \u6a21\u62df\u4e2d RStoic \u53cd\u5e94\u5668\u6a21\u5757 B2 \u7684 Variable Explorer \u6811\u5f62\u89c6\u56fe\u5982\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u3010\u4e2d\u6587\u7ffb\u8bd1\u3011</p> <p>\u5728 RStoic \u53cd\u5e94\u5668\u6a21\u578b\u4e2d\uff0c\u53cd\u5e94\u7684\u5316\u5b66\u8ba1\u91cf\u7cfb\u6570\u4fdd\u5b58\u5728\u8f93\u5165\u53d8\u91cf COEF\uff08\u53cd\u5e94\u7269\u7cfb\u6570\uff09\u548c COEF1\uff08\u4ea7\u7269\u7cfb\u6570\uff09\u91cc\u3002</p> <p>\u8fd9\u4e24\u4e2a\u8282\u70b9\u5404\u6709\u4e00\u7ec4\u5b50\u8282\u70b9\uff0c\u6bcf\u4e2a\u5b50\u8282\u70b9\u4ee3\u8868\u4e00\u6761\u53cd\u5e94\u65b9\u7a0b\u5f0f\u3002 \u7531\u4e8e\u8be5\u6a21\u5757\u53ea\u6709\u4e00\u6761\u53cd\u5e94\uff0cCOEF \u4e0e COEF1 \u5747\u4ec5\u542b\u4e00\u4e2a\u5b50\u8282\u70b9\uff0c\u6807\u7b7e\u4e3a \"1\"\uff0c\u5373\u53cd\u5e94\u7f16\u53f7 1\u3002</p> <p>\u8be5\u53cd\u5e94\u8282\u70b9\u5177\u6709 \u4e8c\u7ef4\uff08<code>Dimension = 2</code>\uff09\uff0c\u56e0\u6b64\u9700\u8981\u4e24\u4e2a\u6807\u8bc6\u7b26\u624d\u80fd\u5b9a\u4f4d\u5177\u4f53\u7cfb\u6570\uff1a</p> <ol> <li> <p>\u7b2c\u4e00\u7ef4\u6807\u8bc6\u7b26\uff1a\u7ec4\u5206\uff08reactant component\uff09</p> </li> <li> <p>\u7b2c\u4e8c\u7ef4\u6807\u8bc6\u7b26\uff1a\u5b50\u7269\u6d41\uff08\u6b64\u5904\u4e3a MIXED\uff09</p> </li> </ol> <p>\u8fd9\u662f \u6210\u5bf9\u6eda\u52a8\uff08paired scrolling\uff09 \u7684\u5178\u578b\u4f8b\u5b50\uff1a \u53ea\u6709\u4e24\u7ef4\u884c\u53f7\u76f8\u540c\u7684\u8282\u70b9\u624d\u6709\u6548\uff0c\u5176\u4f59\u4e3a\u7a7a\u3002 \u662f\u5426\u91c7\u7528\u6210\u5bf9\u6eda\u52a8\u53ef\u901a\u8fc7\u5c5e\u6027 <code>.AttributeValue(HAP_FIRSTPAIR)</code> \u5224\u65ad\u2014\u2014\u82e5\u8fd4\u56de \u22651 \u7684\u7d22\u5f15\uff0c\u5373\u8868\u793a\u542f\u7528\u6210\u5bf9\u6eda\u52a8\u3002</p> <p>\u4e0b\u65b9\u793a\u4f8b\u4ee3\u7801\u6f14\u793a\u5982\u4f55\u5728 COEF \u8282\u70b9\u4e0b\u8bfb\u53d6\u7cfb\u6570\u53ca\u5176\u5bf9\u5e94\u6807\u8bc6\u7b26\uff1b \u56e0\u4f7f\u7528\u6210\u5bf9\u6eda\u52a8\uff0c\u4ec5\u8bbf\u95ee\u4e24\u7ef4 Location \u76f8\u540c \u7684\u8282\u70b9\u3002</p> <pre><code>Sub ReacCoeffExample(ByVal ihAPsim As Happ.IHapp)\n' This example illustrates retrieving values for a non-scalar variable\n' with three identifiers\nDim ihReacNode As Happ.IHNode\nDim ihCoeffNode As Happ.IHNode\nDim intOff As Long\nDim strHeading As String\nDim strTable As String\nDim nReacCoeff As Integer\nOn Error GoTo ErrorHandler\nstrTable=\"\"\nihCoeffNode = ihAPsim.Tree.Data.Blocks.B2.Input.COEF\n' loop through reaction nodes\nFor Each ihReacNode In ihCoeffNode.Elements\n  strHeading = ihCoeffNode.Elements.DimensionName(0) _\n    &amp; Chr(9) &amp; ihReacNode.Elements.DimensionName(0) _\n    &amp; Chr(9) &amp; ihReacNode.Elements.DimensionName(1)\n  nReacCoeff = ihReacNode.Elements.RowCount(0)\n  ' loop through coefficient nodes retrieving component and substream\n  ' identifiers and coefficient values\n  For intOff = 0 To nReacCoeff - 1\n    strTable = strTable &amp; Chr(13) &amp; ihReacNode.Name &amp; Chr(9) _\n      &amp; Chr(9) &amp; ihReacNode.Elements.Label(0, intOff) &amp; Chr(9) _\n      &amp; Chr(9) &amp; ihReacNode.Elements.Label(1, intOff) &amp; Chr(9) _\n      &amp; Chr(9) &amp; ihReacNode.Elements.Item(intOff, intOff).Value\n  Next intOff\n  MsgBox(strHeading &amp; strTable, , \"ReacCoeffExample\")\nNext ihReacNode\nExit Sub\nErrorHandler:\nMsgBox(\"ReacCoeffExample raised error \" &amp; Err.Description)\nEnd Sub\n</code></pre> <p>Python\u7ffb\u8bd1</p> <pre><code>import win32com.client as win32\nfrom tkinter import Tk, messagebox\n\ndef reac_coeff_example(ih_ap_sim):\n    \"\"\"\u4e0e VB ReacCoeffExample \u5b8c\u5168\u4e00\u81f4\uff1a\u4e09\u7ef4\u975e\u6807\u91cf\u53d8\u91cf\"\"\"\n    coeff_node = ih_ap_sim.Tree.Data.Blocks.B2.Input.COEF   # \u53cd\u5e94\u7269\u7cfb\u6570\u6839\u8282\u70b9\n\n    for ih_reac_node in coeff_node.Elements:               # \u901a\u5e38\u53ea\u6709 1 \u6761\u53cd\u5e94\n        # \u8868\u5934\uff1a\u7ef4\u5ea6\u540d\u79f0\n        heading = \"\\t\".join([\n            coeff_node.Elements.DimensionName(0),\n            ih_reac_node.Elements.DimensionName(0),\n            ih_reac_node.Elements.DimensionName(1)\n        ])\n\n        n_coeff = ih_reac_node.Elements.RowCount(0)        # \u7b2c1\u7ef4\u884c\u6570\n        table_rows = []\n        # \u6210\u5bf9\u6eda\u52a8\uff1a\u53ea\u53d6\u4e24\u7ef4\u540c\u5e8f\n        for off in range(n_coeff):\n            comp_lbl   = ih_reac_node.Elements.Label(0, off)  # \u7ec4\u5206\n            subst_lbl  = ih_reac_node.Elements.Label(1, off)  # \u5b50\u7269\u6d41\n            coeff_val  = ih_reac_node.Elements.Item(off, off).Value\n            table_rows.append(f\"{ih_reac_node.Name}\\t\\t{comp_lbl}\\t\\t{subst_lbl}\\t\\t{coeff_val}\")\n\n        # \u5f39\u7a97\u663e\u793a\n        root = Tk(); root.withdraw()\n        messagebox.showinfo(\"ReacCoeffExample\", f\"{heading}\\n\" + \"\\n\".join(table_rows))\n        root.destroy()\n\n\n# ---------------- \u8c03\u7528\u793a\u4f8b ----------------\nif __name__ == \"__main__\":\n    ap = win32.Dispatch(\"AspenPlus.Document.34.0\")\n    ap.InitNew2()                 # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n    reac_coeff_example(ap)\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E5%BC%95%E7%94%A8%E9%9D%9E%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE/%E5%8D%95%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%A1%94%E6%9D%BF%E6%B8%A9%E5%BA%A6%E5%88%86%E5%B8%83/","title":"\u5355\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u5854\u677f\u6e29\u5ea6\u5206\u5e03","text":"<p>RadFrac \u5854\u7684\u6e29\u5ea6\u5206\u5e03\u662f\u53ea\u9700\u4e00\u4e2a\u6807\u8bc6\u7b26\u7684\u53d8\u91cf\u793a\u4f8b\u3002 \u5728 pfdtut \u6a21\u62df\u7ed3\u679c\u4e2d\uff0c\u53ef\u5728\u5bfc\u822a\u7a97\u683c\uff1a</p> <p>\u6a21\u5757 \u2192 B6 \u2192 \u5206\u5e03 \u2192 TPFQ</p> <p>\u4e0b\u4ee5\u8868\u683c\u5f62\u5f0f\u67e5\u770b\u6e29\u5ea6\u5206\u5e03\u3002</p> <p>\u540c\u4e00\u6570\u636e\u5728 Variable Explorer \u4e2d\u7684\u8def\u5f84\u4e3a\uff1a</p> <p>Root \u2192 Data \u2192 Blocks \u2192 B6 \u2192 Output \u2192 B_TEMP</p> <p>\u5728\u8be5\u8282\u70b9\u4e0b\u5171\u6709 15 \u4e2a\u53f6\u8282\u70b9\uff0c\u6807\u7b7e\u4f9d\u6b21\u4e3a 1\u201215\uff0c\u5bf9\u5e94\u5404\u5854\u677f\u6e29\u5ea6\u3002</p> <p></p> <p>\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8bbf\u95ee\u5854\u6e29\u5ea6\u5206\u5e03\u7684\u793a\u4f8b</p>"},{"location":"Aspen%2BGuide/%E5%BC%95%E7%94%A8%E9%9D%9E%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE/%E5%8F%8C%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%A1%94%E6%9D%BF%E7%BB%84%E6%88%90%E5%88%86%E5%B8%83/","title":"\u53cc\u6807\u8bc6\u7b26\u53d8\u91cf\u8bbf\u95ee\uff1a\u5854\u677f\u7ec4\u6210\u5206\u5e03","text":"<p>RadFrac \u7684\u6db2\u76f8\u7ec4\u6210\u5206\u5e03\u662f\u9700\u8981\u4e24\u4e2a\u6807\u8bc6\u7b26\u7684\u53d8\u91cf\u793a\u4f8b\u3002 \u5bf9\u4e8e pfdtut \u6a21\u62df\u7ed3\u679c\uff0c\u53d8\u91cf X \u5728 Variable Explorer \u6811\u5f62\u89c6\u56fe\u4e2d\u7684\u4f4d\u7f6e\u5982\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5728\u53d8\u91cf X \u4e0b\u65b9\u7684\u7b2c\u4e00\u5c42\u8282\u70b9\u4ee3\u8868\u5854\u677f\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684 <code>Name</code> \u5c5e\u6027\u5373\u4e3a\u5854\u677f\u53f7\uff1b \u7b2c\u4e8c\u5c42\u8282\u70b9\u4e3a\u5404\u7ec4\u5206\u7684\u7ec4\u6210\uff0c\u5176 <code>Name</code> \u5c5e\u6027\u4e3a\u7ec4\u5206 ID\uff0c\u5bf9\u5e94 <code>Value</code> \u5c5e\u6027\u5373\u4e3a\u8be5\u5854\u677f\u5185\u8be5\u7ec4\u5206\u7684\u6db2\u76f8\u6469\u5c14\u5206\u6570\u3002</p> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u6f14\u793a\u5982\u4f55\u4ece\u8fd9\u4e00\u4e24\u5c42\u7ed3\u6784\u4e2d\u53d6\u51fa\u7ec4\u5206\u7ec4\u6210\uff1a \u4f7f\u7528\u4e24\u5c42\u5d4c\u5957\u5faa\u73af\u4f9d\u6b21\u904d\u5386\u5404\u5854\u677f\u4e0e\u5404\u7ec4\u5206\uff0c\u6700\u7ec8\u8bbf\u95ee\u5230\u5177\u4f53\u6570\u503c\u8282\u70b9\u3002</p> <pre><code>Public Sub CompProfExample(ByVal ihAPsim As Happ.IHapp)\n' \u672c\u4f8b\u83b7\u53d6\u5e26\u4e24\u4e2a\u6807\u8bc6\u7b26\u7684\u975e\u6807\u91cf\u53d8\u91cf\u503c\uff08\u6db2\u76f8\u7ec4\u6210\u5206\u5e03\uff09\nDim ihTrayNode As Happ.IHNode   ' \u5854\u677f\u8282\u70b9\uff08\u7b2c\u4e00\u7ef4\uff09\nDim ihXNode   As Happ.IHNode    ' \u53d8\u91cf X \u8282\u70b9\nDim ihCompNode As Happ.IHNode   ' \u7ec4\u5206\u8282\u70b9\uff08\u7b2c\u4e8c\u7ef4\uff09\nDim strOut As String\nDim nLines As Integer\nOn Error GoTo ErrorHandler\n\n    ihXNode = ihAPsim.Tree.Data.Blocks.B6.Output.Elements(\"X\")\n    nLines = 0\n    strOut = \"\"\n\n    ' \u7b2c\u4e00\u5c42\u5faa\u73af\uff1a\u904d\u5386\u5404\u5854\u677f\n    For Each ihTrayNode In ihXNode.Elements\n        ' \u7b2c\u4e8c\u5c42\u5faa\u73af\uff1a\u904d\u5386\u5404\u7ec4\u5206\n        For Each ihCompNode In ihTrayNode.Elements\n            strOut = strOut &amp; Chr(13) &amp; ihTrayNode.Name &amp; _\n                     Chr(9) &amp; ihCompNode.Name &amp; Chr(9) &amp; _\n                     ihCompNode.Value\n            nLines = nLines + 1\n            ' \u6bcf\u6ee1 40 \u884c\u5f39\u4e00\u6b21\u7a97\uff0c\u907f\u514d\u6d88\u606f\u6846\u8fc7\u957f\n            If nLines = 40 Then\n                MsgBox strOut, , \"CompProfExample\"\n                strOut = \"\"\n                nLines = 0\n            End If\n        Next ihCompNode\n    Next ihTrayNode\n\n    ' \u5269\u4f59\u4e0d\u8db3 40 \u884c\u4e5f\u663e\u793a\n    If nLines &gt; 0 Then\n        MsgBox strOut, , \"CompProfExample\"\n    End If\n\nExit Sub\nErrorHandler:\n    MsgBox \"CompProfExample raised error \" &amp; Err.Description\nEnd Sub\n</code></pre> <p>Python\u7ffb\u8bd1</p> <pre><code>import win32com.client as win32\nfrom tkinter import Tk, messagebox\n\ndef comp_prof_example(ih_ap_sim):\n    \"\"\"\u4e0e VB CompProfExample \u5b8c\u5168\u4e00\u81f4\uff1a\u53cc\u6807\u8bc6\u7b26\u975e\u6807\u91cf\u53d8\u91cf\"\"\"\n    ih_x_node = ih_ap_sim.Tree.Data.Blocks.B6.Output.Elements(\"X\")  # \u6db2\u76f8\u7ec4\u6210 X\n\n    str_out, n_lines = \"\", 0\n    for ih_tray_node in ih_x_node.Elements:          # \u7b2c1\u7ef4\uff1a\u5854\u677f\n        for ih_comp_node in ih_tray_node.Elements:   # \u7b2c2\u7ef4\uff1a\u7ec4\u5206\n            str_out += f\"\\n{ih_tray_node.Name}\\t{ih_comp_node.Name}\\t{ih_comp_node.Value}\"\n            n_lines += 1\n            if n_lines == 40:                        # \u6ee140\u884c\u5f39\u7a97\n                _show(str_out, \"CompProfExample\")\n                str_out, n_lines = \"\", 0\n\n    if n_lines &gt; 0:                                  # \u5269\u4f59\u4e0d\u8db340\u884c\n        _show(str_out, \"CompProfExample\")\n\n\ndef _show(text, title):\n    root = Tk()\n    root.withdraw()\n    messagebox.showinfo(title, text.strip())\n    root.destroy()\n\n\n# ---------------- \u8c03\u7528\u5165\u53e3 ----------------\nif __name__ == \"__main__\":\n    ap = win32.Dispatch(\"AspenPlus.Document.34.0\")\n    ap.InitNew2()                 # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n    comp_prof_example(ap)\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E5%BC%95%E7%94%A8%E9%9D%9E%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE/%E5%8D%95%E6%A0%87%E8%AF%86%E7%AC%A6%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%EF%BC%9A%E5%A1%94%E6%9D%BF%E6%B8%A9%E5%BA%A6%E5%88%86%E5%B8%83/%E9%80%9A%E8%BF%87%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8E%A5%E5%8F%A3%E8%AE%BF%E9%97%AE%E5%A1%94%E6%B8%A9%E5%BA%A6%E5%88%86%E5%B8%83%E7%9A%84%E7%A4%BA%E4%BE%8B/","title":"\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u8bbf\u95ee\u5854\u6e29\u5ea6\u5206\u5e03\u7684\u793a\u4f8b","text":"<pre><code>import win32com.client as win32\n\ndef temp_prof_example(ih_ap_sim):\n    \"\"\"\n    \u4e0e VB \u7684 TempProfExample \u5b8c\u5168\u4e00\u81f4\uff1a\n    \u8bfb\u53d6 B6 \u5854\u6e29\u5ea6\u5206\u5e03\uff08\u5355\u6807\u8bc6\u7b26\u975e\u6807\u91cf\u53d8\u91cf\uff09\n    \"\"\"\n    # 1. \u83b7\u53d6 B_TEMP \u8282\u70b9\n    ih_t_var = ih_ap_sim.Tree.Data.Blocks.B6.Output.B_TEMP\n\n    # 2. \u62fc\u63a5\u8868\u5934\uff1a\u7ef4\u5ea6\u540d + \u53d8\u91cf\u540d\n    str_out = [f\"{ih_t_var.Elements.DimensionName(0)}\\t{ih_t_var.Name}\"]\n\n    # 3. \u904d\u5386\u6bcf\u4e2a\u5854\u677f\uff08Elements \u5373\u5404 stage\uff09\n    for ih_stage in ih_t_var.Elements:\n        stage_name = ih_stage.Name\n        temp_val   = ih_stage.Value\n        unit_str   = ih_stage.UnitString\n        # \u4e0e VB \u7684 Format(xxx, \"###.00\") \u7b49\u6548\n        str_out.append(f\"{stage_name}\\t{temp_val:.2f}\\t{unit_str}\")\n\n    # 4. \u5f39\u51fa\u6d88\u606f\u6846\uff08\u540c VB MsgBox\uff09\n    from tkinter import Tk, messagebox\n    root = Tk(); root.withdraw()\n    messagebox.showinfo(\"TempProfExample\", \"\\n\".join(str_out))\n    root.destroy()\n\n# ---------------- \u8c03\u7528\u793a\u4f8b ----------------\nif __name__ == \"__main__\":\n    ap = win32.Dispatch(\"AspenPlus.Document.34.0\")\n    ap.InitNew2()                 # \u4e5f\u53ef GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n    temp_prof_example(ap)\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E6%A8%A1%E6%8B%9F%E9%97%AE%E9%A2%98%28%E8%BF%90%E8%A1%8C%2B%2B%2B%E6%94%B6%E6%95%9B%E7%AD%89%29/%E5%8F%A6%E8%AF%B7%E5%8F%82%E9%98%85-Run2%2B%E6%8E%A5%E5%8F%A3/","title":"\u53e6\u8bf7\u53c2\u9605 Run2+\u63a5\u53e3","text":"<p>Run2 \u63a5\u53e3\u65b9\u6cd5 IHapp.Run2 \u4e0e IHapp.Engine.Run2 \u5747\u63a5\u53d7\u4e00\u4e2a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u5c06\u6a21\u62df\u8bbe\u4e3a\u5f02\u6b65\u8fd0\u884c\u3002\u8fd9\u6837\uff0c\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u5728\u7b49\u5f85\u6a21\u62df\u5b8c\u6210\u7684\u540c\u65f6\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u3002 \u5f53\u5e94\u7528\u7a0b\u5e8f\u53ef\u89c1\u65f6\uff0c\u5e94\u59cb\u7ec8\u4f7f\u7528\u5f02\u6b65\u65b9\u5f0f\u8fd0\u884c Aspen Plus\u3002</p> <p>\u4e0b\u65b9\u793a\u4f8b\u5c55\u793a\u4e86\u5728\u7c7b\u6a21\u5757\u4e8b\u4ef6\u8fc7\u7a0b\u4e2d\u4ee5\u5f02\u6b65\u65b9\u5f0f\u542f\u52a8\u5f15\u64ce\u7684\u4ee3\u7801\u3002</p> <p>AspenPlus.cls</p> <pre><code>VERSION 1.0 CLASS\n\nBEGIN\n\nMultiUse = -1 'True \n\nPersistable = 0 'NotPersistable \n\nDataBindingBehavior = 0 'vbNone \n\nDataSourceBehavior = 0 'vbNone \n\nMTSTransactionMode = 0 'NotAnMTSObject \n\nEND\n\nAttribute VB_Name = \"AspenPlus\"\n\nAttribute VB_GlobalNameSpace = False\n\nAttribute VB_Creatable = True\n\nAttribute VB_PredeclaredId = False\n\nAttribute VB_Exposed = False\n\nOption Explicit\n\n\n\n'An example class module to illustrate the use of the Aspen\n\n'Plus automation interface.\n\n'\n\n'This example is intended for illustration purposes only.\n\n'It is not intended as production code.\n\n\n\n\n\n' This module requires a reference to the Aspen Plus\n\n' type library\n\n\n\n\n\n' The interface to the Aspen Plus Automation Server\n\nPrivate WithEvents simulationObject As Happ.HappLS\n\nAttribute simulationObject.VB_VarHelpID = -1\n\nPrivate isRunning As Boolean\n\n\n\nPublic Event RunFinished()\n\n\n\n\n\n\n\nPrivate Sub Class_Initialize()\n\nOn Error Resume Next \n\n' Initialize data members \n\nisRunning = False \n\nEnd Sub\n\n\n\nPrivate Sub Class_Terminate()\n\nOn Error Resume Next \n\n' Release automation server \n\nSet simulationObject = Nothing \n\nEnd Sub\n\n\n\nPublic Property Get simulation() As Happ.IHapp\n\nOn Error GoTo GetSimulationErr \n\nSet simulation = simulationObject \n\nExit Property \n\n\n\n' simple error handler\n\nGetSimulationErr:\n\nSet simulationObject = Nothing \n\n\n\nEnd Property\n\n\n\nPublic Property Let simulation(ByVal vNewValue As Happ.IHapp)\n\nOn Error GoTo SetSimulationErr \n\nSet simulationObject = vNewValue \n\n\n\nExit Property \n\n' simple error handler\n\nSetSimulationErr:\n\nSet simulationObject = Nothing \n\n\n\nEnd Property\n\n\n\nPublic Sub Run()\n\nOn Error GoTo RunError \n\nIf simulationObject Is Nothing Then \n\n' Throw user defined exception \n\nExit Sub \n\nEnd If \n\nIf isRunning = True Then \n\n' Throw user defined exception \n\nExit Sub \n\nEnd If \n\nIf InputComplete = False Then \n\n' Throw user defined exception \n\nExit Sub \n\nEnd If \n\n\n\n' Do asynchronous run \n\nisRunning = True \n\nsimulationObject.Run2 True \n\nExit Sub \n\n\n\nRunError:\n\nisRunning = False \n\nEnd Sub\n\n\n\n' Event recieved when the run is completed\n\nPrivate Sub simulationObject_OnCalculationCompleted()\n\nOn Error Resume Next \n\nIf isRunning = True Then \n\nisRunning = False \n\nRaiseEvent RunFinished \n\nEnd If \n\nEnd Sub\n\n\n\n\n\n\n\nPublic Property Get InputComplete() As Boolean\n\nOn Error GoTo InputCompleteErr \n\nDim problemData As Happ.IHNode \n\nDim completionMask As Long \n\n\n\nInputComplete = False \n\nIf simulationObject Is Nothing Then \n\n' Throw user defined exception \n\n\n\nExit Property \n\nEnd If \n\n\n\nSet problemData = simulationObject.Tree.Data \n\ncompletionMask = _\nproblemData.AttributeValue(Happ.HAP_COMPSTATUS) \n\nIf completionMask And Happ.HAP_INPUT_COMPLETE Then \n\nInputComplete = True \n\nEnd If \n\n\n\nExit Property \n\nInputCompleteErr:\n\nInputComplete = False \n\nEnd Property\n\n\n\n\n\n\n\nPublic Sub LoadBkp(ByVal problem As String)\n\nDim newSimulation As New HappLS \n\nOn Error GoTo LoadBkpErr \n\n' load bkp with local engine \n\nCall newSimulation.InitFromArchive2(problem, 0) \n\nsimulation = newSimulation \n\nSet newSimulation = Nothing \n\nExit Sub \n\n\n\nLoadBkpErr:\n\nErr.Clear \n\n' log error or throw user defined exception\n\nEnd Sub\n</code></pre> <p>Mainform.frm</p> <pre><code>VERSION 5.00\n\nBegin VB.Form Form1\n\nCaption = \"Form1\" \n\nClientHeight = 3195 \n\nClientLeft = 60 \n\nClientTop = 345 \n\nClientWidth = 4680 \n\nLinkTopic = \"Form1\" \n\nScaleHeight = 3195 \n\nScaleWidth = 4680 \n\nStartUpPosition = 3 'Windows Default \n\nBegin VB.CommandButton Load  \n\nCaption = \"Load\" \n\nHeight = 375 \n\nLeft = 720 \n\nTabIndex = 1 \n\nTop = 480 \n\nWidth = 1095 \n\nEnd \n\nBegin VB.CommandButton Run  \n\nCaption = \"Run\" \n\nHeight = 375 \n\nLeft = 720 \n\nTabIndex = 0 \n\nTop = 1200 \n\nWidth = 1095 \n\nEnd \n\nEnd\n\nAttribute VB_Name = \"Form1\"\n\nAttribute VB_GlobalNameSpace = False\n\nAttribute VB_Creatable = False\n\nAttribute VB_PredeclaredId = True\n\nAttribute VB_Exposed = False\n\nDim WithEvents problem As AspenPlus\n\n\n\n\n\nPrivate Sub Form_Load()\n\nOn Error Resume Next\n\n' Initialize variables and set state \n\nSet problem = New AspenPlus \n\nLoad.Enabled = True \n\nRun.Enabled = False \n\nEnd Sub\n\n\n\nPrivate Sub Form_Unload(Cancel As Integer)\n\nOn Error Resume Next\n\nSet problem = Nothing \n\nEnd Sub\n\n\n\n\n\nPrivate Sub Load_Click()\n\nOn Error Resume Next\n\nMousePointer = vbHourglass \n\nLoad.Enabled = False \n\n' load file into class \n\nproblem.LoadBkp (\"C:\\Aspen Plus V14\\GUI\\Examples\\pfdtut.bkp\") \n\nRun.Enabled = True \n\nMousePointer = vbDefault \n\nEnd Sub\n\n\n\nPrivate Sub problem_RunFinished()\n\nOn Error Resume Next \n\nMousePointer = vbDefault \n\n' Re-enable user controls \n\nRun.Enabled = True \n\nEnd Sub\n\n\n\nPrivate Sub Run_Click()\n\nOn Error Resume Next \n\n' Disable user controls \n\nRun.Enabled = False \n\nMousePointer = vbHourglass \n\nproblem.Run \n\nEnd Sub\n</code></pre> <p>Python\u7ffb\u8bd1</p> <p>AspenPlus.cls \u4e00\u4e2a\u793a\u4f8b\u7c7b\u6a21\u5757\uff0c\u6f14\u793a\u5982\u4f55\u8c03\u7528 Aspen Plus \u81ea\u52a8\u5316\u63a5\u53e3\u3002 \u4ec5\u7528\u4e8e\u6559\u5b66\uff0c\u975e\u751f\u4ea7\u4ee3\u7801\u3002</p> <ul> <li> <p>\u4f7f\u7528 WithEvents \u58f0\u660e simulationObject\uff0c\u53ef\u63a5\u6536\u8ba1\u7b97\u5b8c\u6210\u7b49\u4e8b\u4ef6</p> </li> <li> <p>\u63d0\u4f9b LoadBkp\u3001Run \u7b49\u516c\u5171\u65b9\u6cd5\uff0c\u5185\u90e8\u8c03\u7528\u5f02\u6b65 Run2</p> </li> <li> <p>\u82e5\u8f93\u5165\u672a\u5b8c\u6210\u6216\u6b63\u5728\u8fd0\u884c\uff0c\u5c06\u63d0\u524d\u9000\u51fa</p> </li> <li> <p>\u8ba1\u7b97\u5b8c\u6210\u540e\u89e6\u53d1 RunFinished \u4e8b\u4ef6</p> </li> </ul> <p>Mainform.frm \u7b80\u5355\u7a97\u4f53\uff1a\u4e24\u4e2a\u6309\u94ae\uff08Load / Run\uff09</p> <ul> <li> <p>Load \u6309\u94ae\u8c03\u7528 LoadBkp \u52a0\u8f7d bkp \u6587\u4ef6</p> </li> <li> <p>Run \u6309\u94ae\u8c03\u7528\u5f02\u6b65 Run2\uff0c\u8ba1\u7b97\u5b8c\u6210\u540e\u901a\u8fc7\u4e8b\u4ef6\u91cd\u65b0\u542f\u7528\u6309\u94ae</p> </li> </ul> <p>\uff08\u4ee5\u4e0b\u4fdd\u7559 VB \u539f\u7801\uff0c\u4ec5\u6ce8\u91ca\u4e0e\u8bf4\u660e\u5df2\u4e2d\u6587\u5316\uff09</p> <p>\u3010Python \u5b8c\u6574\u76f4\u8bd1\u7248\u3011</p> <p>aspen_plus.py</p> <pre><code>import win32com.client as win32\nimport pythoncom\n\nclass AspenPlus:\n    \"\"\"\u4e0e VB AspenPlus \u7c7b\u529f\u80fd\u4e00\u81f4\uff1a\u5c01\u88c5\u52a0\u8f7d\u3001\u8fd0\u884c\u3001\u4e8b\u4ef6\"\"\"\n    _reg_clsid_ = pythoncom.CreateGuid()\n    _reg_desc_ = \"Aspen Plus \u81ea\u52a8\u5316\u5c01\u88c5\uff08\u5f02\u6b65 Run2\uff09\"\n    _reg_progid_ = \"AspenPlus.Wrapper\"\n\n    def __init__(self):\n        pythoncom.CoInitialize()\n        self.simulation_object = None\n        self.is_running = False\n\n    def __del__(self):\n        self.simulation_object = None\n        pythoncom.CoUninitialize()\n\n    @property\n    def simulation(self):\n        return self.simulation_object\n\n    @simulation.setter\n    def simulation(self, v):\n        self.simulation_object = v\n\n    def load_bkp(self, problem_path):\n        new_sim = win32.Dispatch(\"AspenPlus.Document.34.0\")\n        new_sim.InitFromArchive2(problem_path, 0)\n        self.simulation = new_sim\n\n    @property\n    def input_complete(self):\n        if self.simulation is None: return False\n        comp_mask = self.simulation.Tree.Data.AttributeValue(12)  # HAP_COMPSTATUS\n        return bool(comp_mask &amp; 0x20)                             # HAP_INPUT_COMPLETE\n\n    def run(self):\n        if self.simulation is None or self.is_running or not self.input_complete:\n            return\n        self.is_running = True\n        self.simulation.Run2(True)          # True = \u5f02\u6b65\n\n    def OnCalculationCompleted(self):\n        if self.is_running:\n            self.is_running = False\n            self.run_finished()\n\n    def run_finished(self):\n        \"\"\"\u4f9b\u5916\u90e8\u7a97\u4f53\u91cd\u5199\"\"\"\n        pass\n</code></pre> <p>main_gui.py\uff08tkinter \u7b49\u6548\u7a97\u4f53\uff09</p> <pre><code>import tkinter as tk\nfrom tkinter import ttk, messagebox\nfrom aspen_plus import AspenPlus\n\nclass MainForm(tk.Tk):\n    def __init__(self):\n        super().__init__()\n        self.title(\"Aspen Plus \u5f02\u6b65\u8fd0\u884c\u793a\u4f8b\")\n        self.geometry(\"240x160\")\n        self.problem = AspenPlus()\n        self.problem.run_finished = self.on_run_finished   # \u7ed1\u5b9a\u4e8b\u4ef6\n\n        self.load_btn = ttk.Button(self, text=\"Load\", command=self.load_click)\n        self.run_btn  = ttk.Button(self, text=\"Run\",  command=self.run_click, state=tk.DISABLED)\n        self.load_btn.pack(pady=10)\n        self.run_btn.pack(pady=10)\n\n    def load_click(self):\n        self.config(cursor=\"watch\")\n        self.load_btn.config(state=tk.DISABLED)\n        try:\n            self.problem.load_bkp(r\"C:\\Aspen Plus V14\\GUI\\Examples\\pfdtut.bkp\")\n            self.run_btn.config(state=tk.NORMAL)\n        except Exception as e:\n            messagebox.showerror(\"Load Error\", str(e))\n        finally:\n            self.config(cursor=\"\")\n            self.load_btn.config(state=tk.NORMAL)\n\n    def run_click(self):\n        self.config(cursor=\"watch\")\n        self.run_btn.config(state=tk.DISABLED)\n        try:\n            self.problem.run()\n        except Exception as e:\n            messagebox.showerror(\"Run Error\", str(e))\n\n    def on_run_finished(self):\n        \"\"\"\u4e8b\u4ef6\uff1a\u8ba1\u7b97\u5b8c\u6210\"\"\"\n        self.config(cursor=\"\")\n        self.run_btn.config(state=tk.NORMAL)\n\nif __name__ == \"__main__\":\n    MainForm().mainloop()\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E6%A8%A1%E6%8B%9F%E9%97%AE%E9%A2%98%28%E8%BF%90%E8%A1%8C%2B%2B%2B%E6%94%B6%E6%95%9B%E7%AD%89%29/%E5%BF%AB%E9%80%9F%E5%88%A4%E6%96%AD%E5%90%84%E7%B1%BB%E8%AE%A1%E7%AE%97%E6%88%90%E8%B4%A5/","title":"\u5feb\u901f\u5224\u65ad\u5404\u7c7b\u8ba1\u7b97\u6210\u8d25","text":"<p>\u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u53ef\u5728\u8def\u5f84 Application.Tree.Data.Results Summary.Run-Status.Output \u4e0b\u8bfb\u53d6\u4ee5\u4e0b\u72b6\u6001\u6807\u5fd7\uff0c\u5feb\u901f\u5224\u65ad\u5404\u7c7b\u8ba1\u7b97\u6210\u8d25\uff1a</p> <p>\u8868\u683c</p> <p>\u590d\u5236</p> \u6807\u5fd7 \u542b\u4e49 CSSTAT \u6848\u4f8b\u7814\u7a76\uff08V7.3 \u524d\u65e7\u529f\u80fd\uff0c\u73b0\u5df2\u88ab Sensitivity \u4e2d\u7684 Cases \u53d6\u4ee3\uff09 CVSTAT \u6536\u655b\u5757 PCESSTAT \u7269\u6027\u4f30\u7b97 PPSTAT \u7269\u6027\u8868 PROPSTAT \u7269\u6027\u8ba1\u7b97 RSTAT Calculator \u4e0e Transfer \u5757 SENSSTAT Sensitivity \u5757 <p>\u901a\u7528\u89c4\u5219</p> <ul> <li> <p>0 = \u65e0\u9519\u8bef</p> </li> <li> <p>1 = \u9519\u8bef</p> </li> <li> <p>2 = \u8b66\u544a</p> </li> <li> <p>\u7f3a\u5931\u503c\uff08RMISS\u3001NaN \u6216\u5bf9\u4e8e\u65e0\u8b66\u544a\u573a\u666f\u8fd4\u56de 2\uff09= \u672c\u6b21\u8fd0\u884c\u672a\u4f7f\u7528\u8be5\u7c7b\u529f\u80fd</p> </li> </ul> <p>PCESSTAT \u989d\u5916\u8bf4\u660e</p> <ul> <li> <p>\u5355\u72ec\u8fd0\u884c\u7269\u6027\u4f30\u7b97\u65f6\uff1a0/1/2 \u5206\u522b\u8868\u793a\u6210\u529f/\u9519\u8bef/\u8b66\u544a</p> </li> <li> <p>\u4e0e\u6a21\u62df\u4e00\u8d77\u8fd0\u884c\u65f6\uff0c\u89c4\u5219\u6269\u5c55\uff1a \u2013 10 = \u4f30\u7b97\u8b66\u544a \u2013 11 = \u6a21\u62df\u6210\u529f\u4e14\u4f30\u7b97\u6210\u529f \u2013 \u5176\u4ed6\u672b\u4f4d\u22600 \u7684\u4e24\u4f4d\u6570 = \u4f30\u7b97\u6210\u529f \u2013 \u56db\u4f4d\u6570\u4e14\u9996\u4f4d=1 = \u4e25\u91cd\u9519\u8bef\uff08\u9996\u4f4d\u4e3a\u4e25\u91cd\u7a0b\u5ea6\uff0c\u5176\u4f59\u4f4d\u4e3a\u9519\u8bef\u7c7b\u578b\u7ec6\u8282\uff09</p> </li> <li> <p>\u82e5\u6a21\u62df\u672a\u5305\u542b\u4f30\u7b97\uff0c\u5219\u503c\u4e3a NaN</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/%E5%A4%84%E7%90%86%2BAspen%2BPlus%2B%E4%BA%8B%E4%BB%B6/","title":"\u5904\u7406+Aspen+Plus+\u4e8b\u4ef6","text":"<p>Aspen Plus \u5e94\u7528\u5bf9\u8c61 HappLS \u652f\u6301\u4e00\u4e2a\u51fa\u5411\u4e8b\u4ef6\u63a5\u53e3 IAPHappEvent\uff0c\u5305\u542b HappLS \u7c7b\u7684\u5404\u7c7b\u4e8b\u4ef6\u3002 \u6709\u5173\u6bcf\u4e2a\u4e8b\u4ef6\u7684\u8be6\u60c5\uff0c\u53c2\u89c1 IAPHappEvent \u4e8b\u4ef6\u63a5\u53e3\u3002</p> <p>\u5728 Visual Basic \u6216 VBA \u4e2d\uff0c\u53ea\u9700\u5728\u7a97\u4f53\u6216\u7c7b\u6a21\u5757\u91cc\u7528 WithEvents \u58f0\u660e HappLS \u53d8\u91cf\uff0c\u7136\u540e\u5c06\u8be5\u53d8\u91cf\u6307\u5411\u6a21\u62df\u95ee\u9898\u5373\u53ef\u63a5\u6536\u4e8b\u4ef6\uff1b \u52a1\u5fc5\u5728\u9002\u5f53\u65f6\u5019\u91ca\u653e\u5bf9\u8c61\u3002</p> <p>\u5728 C++ \u4e2d\uff0c\u9700\u5b9e\u73b0\u4e00\u4e2a\u652f\u6301 IAPHappEvent\uff08dispinterface\uff09\u7684\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u8fde\u63a5\u70b9\u63a5\u53e3\u628a\u51fa\u5411\u63a5\u53e3\u8fde\u63a5\u5230\u5e94\u7528\u5bf9\u8c61\u3002</p> <p>\u4e0b\u65b9\u4ee3\u7801\u7247\u6bb5\u5c55\u793a\u4e86\u4e00\u4e2a VB \u81ea\u52a8\u5316\u5ba2\u6237\u7aef\uff0c\u7528\u4e8e\u5728\u7a97\u4f53\u6587\u672c\u6846\u4e2d\u663e\u793a\u63a7\u5236\u9762\u677f\u6d88\u606f\uff1a</p> <pre><code>Dim WithEvents sim As Happ.IHapp\nDim fCP As frmControlPanel   ' \u5e26\u6587\u672c\u6846\u7684\u7a97\u4f53\n\nPrivate Sub LoadSimulation(fn As String)\n  On Error GoTo ErrorHandler\n\n  Set fCP = New frmControlPanel\n  LabelProblem.Caption = \"loading \" &amp; fn\n  MousePointer = vbHourglass\n\n  ' \u907f\u514d\u201c\u670d\u52a1\u5668\u5fd9\u201d\u63d0\u793a\n  App.OleRequestPendingTimeout = 100000\n\n  Set sim = CreateObject(\"Apwn.Document\")\n  Call sim.InitFromArchive2(fn, 0)\n  sim.Visible = False\n\n  App.OleRequestPendingTimeout = 10000\n  MousePointer = vbDefault\n  Exit Sub\n\nErrorHandler:\n  Debug.Print Err.Description\n  Err.Clear\n  LabelProblem.Caption = \"failed to load problem\"\n  Set sim = Nothing\n  MousePointer = vbDefault\n  App.OleRequestPendingTimeout = 10000\nEnd Sub\n\n' \u4e8b\u4ef6\uff1a\u63a7\u5236\u9762\u677f\u6d88\u606f\nPrivate Sub Sim_OnControlPanelMessage(ByVal Clear As Long, ByVal msg As String)\n  If Clear Then\n    fCP.txtMsg.Text = \"\"\n  Else\n    fCP.txtMsg = fCP.txtMsg.Text &amp; vbCrLf &amp; msg\n  End If\n  On Error GoTo ErrHandler\n  Exit Sub\n\nErrHandler:\n  Debug.Print \"Error \" &amp; Err.Description\n  Err.Clear\nEnd Sub\n</code></pre> <p>Python \u6ca1\u6709\u5185\u5efa\u201cWithEvents\u201d\u8bed\u6cd5\uff0c\u4f46\u53ef\u4ee5\u7528 <code>win32com.client.WithEvents</code> \u628a Aspen Plus \u4e8b\u4ef6\u7ed1\u5b9a\u5230\u81ea\u5b9a\u4e49\u7c7b\u3002 \u4e0b\u9762\u7ed9\u51fa\u5b8c\u6574\u53ef\u8fd0\u884c\u793a\u4f8b\uff1a\u52a0\u8f7d\u6a21\u62df \u2192 \u5b9e\u65f6\u628a\u63a7\u5236\u9762\u677f\u6d88\u606f\u6253\u5370\u5230\u7ec8\u7aef\uff08\u6216\u4f60\u81ea\u5df1\u7684 GUI\uff09\u3002</p> <pre><code>import win32com.client as win32\nimport pythoncom, sys, os\n\n# ---------- \u4e8b\u4ef6\u5904\u7406\u7c7b ----------\nclass AspenEvents:\n    \"\"\"\u5904\u7406 Aspen Plus \u51fa\u5411\u4e8b\u4ef6 IAPHappEvent\"\"\"\n    def OnControlPanelMessage(self, clear, msg):\n        \"\"\"\u6bcf\u6b21\u63a7\u5236\u9762\u677f\u8f93\u51fa\u65f6\u88ab\u8c03\u7528\"\"\"\n        if clear:\n            os.system('cls' if os.name == 'nt' else 'clear')\n        else:\n            print(msg)          # \u4e5f\u53ef\u5199\u5165 QTextEdit / tkinter Text \u7b49\n\n# ---------- \u4e3b\u7a0b\u5e8f ----------\ndef main():\n    pythoncom.CoInitialize()     # \u591a\u7ebf\u7a0b\u516c\u5bd3\n    ap = win32.DispatchWithEvents(\"AspenPlus.Document.34.0\", AspenEvents)\n    ap.Visible = False\n\n    # \u52a0\u8f7d\u73b0\u6709\u6a21\u62df\uff08\u8def\u5f84\u81ea\u5b9a\uff09\n    bkp_path = r\"D:\\Demo\\flash.bkp\"\n    ap.InitFromArchive2(bkp_path, 0)\n\n    # \u8fd0\u884c\u6a21\u62df\uff0c\u63a7\u5236\u9762\u677f\u6d88\u606f\u4f1a\u81ea\u52a8\u89e6\u53d1 OnControlPanelMessage\n    ap.Engine.Run2()\n\n    input(\"\u6309 Enter \u9000\u51fa...\\n\")   # \u4fdd\u6301\u8fd0\u884c\uff0c\u53ef\u770b\u5b9e\u65f6\u6d88\u606f\n    ap.Quit()\n    pythoncom.CoUninitialize()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u4f7f\u7528\u8981\u70b9</p> <ol> <li> <p><code>DispatchWithEvents</code> \u628a COM \u51fa\u5411\u63a5\u53e3\u7ed1\u5b9a\u5230 <code>AspenEvents</code> \u7c7b\uff1b</p> </li> <li> <p>\u7c7b\u65b9\u6cd5\u540d\u5fc5\u987b\u4e0e COM \u4e8b\u4ef6\u540d \u5b8c\u5168\u4e00\u81f4\uff08\u5927\u5c0f\u5199\u654f\u611f\uff09\uff1a<code>OnControlPanelMessage</code>\uff1b</p> </li> <li> <p>\u8fd0\u884c\u6a21\u62df\u540e\uff0c\u6240\u6709\u63a7\u5236\u9762\u677f\u8f93\u51fa\u4f1a\u5b9e\u65f6\u89e6\u53d1\u4f60\u7684 Python \u51fd\u6570\uff0c\u53ef\u7528\u4e8e\u65e5\u5fd7\u3001\u8fdb\u5ea6\u6761\u6216\u524d\u7aef\u5c55\u793a\u3002</p> </li> </ol>"},{"location":"Aspen%2BGuide/%E6%8E%A7%E5%88%B6%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2/%E6%8A%91%E5%88%B6%EF%BC%88%E4%B8%8D%E5%BC%B9%E5%87%BA%EF%BC%89%E5%AF%B9%E8%AF%9D%E6%A1%86/","title":"\u6291\u5236\uff08\u4e0d\u5f39\u51fa\uff09\u5bf9\u8bdd\u6846","text":"<p>\u5c06 Aspen Plus \u4f5c\u4e3a\u81ea\u52a8\u5316\u670d\u52a1\u5668\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u884c\u4e3a\u662f\u4e0d\u663e\u793a\u4efb\u4f55\u6d88\u606f\u6216\u5bf9\u8bdd\u6846\uff0c\u9664\u975e\uff1a</p> <ul> <li> <p>\u8c03\u7528\u4e86\u4e13\u95e8\u7528\u4e8e\u663e\u793a\u5bf9\u8bdd\u6846\u7684\u81ea\u52a8\u5316\u65b9\u6cd5\uff1b\u6216</p> </li> <li> <p>GUI \u5df2\u53ef\u89c1\uff0c\u4e14\u7528\u6237\u4e3b\u52a8\u9009\u62e9\u4e86\u4f1a\u5f39\u51fa\u5bf9\u8bdd\u6846\u7684\u64cd\u4f5c\uff08\u5982\u70b9\u51fb\u83dc\u5355\u9879\uff09\u3002</p> </li> </ul> <p>\u8fd9\u4e00\u9759\u9ed8\u884c\u4e3a\u53ef\u901a\u8fc7 IHapp.SuppressDialogs \u5c5e\u6027\u5173\u95ed\u3002 \u5f53\u5e94\u7528\u7a0b\u5e8f\u8bbe\u4e3a\u53ef\u89c1\u5e76\u4f9b\u4ea4\u4e92\u4f7f\u7528\u65f6\uff0c\u901a\u5e38\u5e94\u5c06 SuppressDialogs \u8bbe\u4e3a False\u3002</p> <p>\u82e5\u5bf9\u8bdd\u6846\u88ab\u6291\u5236\uff0c\u6bcf\u5f53\u9047\u5230\u8b66\u544a\u6d88\u606f\u6216\u88ab\u6291\u5236\u7684\u5bf9\u8bdd\u6846\u65f6\uff0c\u5c06\u89e6\u53d1\u51fa\u5411\u4e8b\u4ef6 OnDialogSuppressed()\u3002 \u8be6\u89c1\u201c\u5904\u7406 Aspen Plus \u4e8b\u4ef6\u201d\u7ae0\u8282\u3002</p> <p>\u67d0\u4e9b\u81ea\u52a8\u5316\u63a5\u53e3\u65b9\u6cd5\u4e00\u5b9a\u4f1a\u663e\u793a\u4ea4\u4e92\u5bf9\u8bdd\u6846\uff1b \u53e6\u4e00\u4e9b\u65b9\u6cd5\u4ec5\u5728\u53c2\u6570\u4e0d\u8db3\u65f6\u624d\u5f39\u51fa\u5bf9\u8bdd\u6846\u3002\u4f8b\u5982\uff1a</p> <pre><code>Call Happ.IHapp.Engine.Reinit()          ' \u4f1a\u663e\u793a Reinit \u5bf9\u8bdd\u6846\nCall Happ.IHapp.Engine.Reinit(IAP_REINIT_SIMULATION) ' \u4e0d\u4f1a\u663e\u793a\u5bf9\u8bdd\u6846\n</code></pre> <p>Python \u76f4\u8bd1\u7248\uff1a\u63a7\u5236\u5bf9\u8bdd\u6846\u5f39\u51fa\u4e0e\u4e8b\u4ef6\u76d1\u6d4b</p> <pre><code>import win32com.client as win32\nimport pythoncom\n\nclass AspenEvents:\n    \"\"\"\u6355\u83b7 Aspen \u4e8b\u4ef6\"\"\"\n    def OnDialogSuppressed(self):\n        print(\"[\u4e8b\u4ef6] \u4e00\u4e2a\u5bf9\u8bdd\u6846/\u8b66\u544a\u88ab\u6291\u5236\")\n\ndef main():\n    pythoncom.CoInitialize()\n    # 1. \u542f\u52a8 Aspen Plus \u5e76\u7ed1\u5b9a\u4e8b\u4ef6\n    ap = win32.DispatchWithEvents(\"AspenPlus.Document.34.0\", AspenEvents)\n\n    # 2. \u9ed8\u8ba4\u5df2\u6291\u5236\u5bf9\u8bdd\u6846\uff1b\u5982\u8981\u4ea4\u4e92\uff0c\u53ef\u5173\u95ed\u6291\u5236\n    ap.SuppressDialogs = False   # True = \u9759\u9ed8\uff1bFalse = \u5141\u8bb8\u5f39\u51fa\n\n    # 3. \u793a\u4f8b\uff1a\u4e24\u79cd Reinit \u8c03\u7528\n    # 3.1 \u65e0\u53c2\u6570 \u2192 \u4f1a\u5f39\u51fa Reinit \u5bf9\u8bdd\u6846\uff08\u82e5 SuppressDialogs=False\uff09\n    # ap.Engine.Reinit()\n\n    # 3.2 \u5e26\u5b8c\u6574\u53c2\u6570 \u2192 \u4e0d\u4f1a\u5f39\u51fa\u5bf9\u8bdd\u6846\n    IAP_REINIT_SIMULATION = 0   # \u6765\u81ea happ.tlb \u7684\u679a\u4e3e\u503c\n    ap.Engine.Reinit(IAP_REINIT_SIMULATION)\n\n    # 4. \u8fd0\u884c\u6a21\u62df\uff0c\u82e5\u51fa\u73b0\u88ab\u6291\u5236\u7684\u8b66\u544a\u4f1a\u89e6\u53d1 OnDialogSuppressed\n    ap.Engine.Run2()\n\n    input(\"\u6309 Enter \u7ed3\u675f...\\n\")\n    ap.Quit()\n    pythoncom.CoUninitialize()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>\u4f7f\u7528\u8981\u70b9</p> <ol> <li> <p><code>SuppressDialogs = True</code> \u9ed8\u8ba4\u9759\u9ed8\uff1b\u8bbe\u4e3a <code>False</code> \u6062\u590d\u4ea4\u4e92\u3002</p> </li> <li> <p><code>DispatchWithEvents</code> \u7ed1\u5b9a <code>OnDialogSuppressed</code>\uff0c\u53ef\u8bb0\u5f55\u6216\u524d\u7aef\u63d0\u793a\u3002</p> </li> <li> <p>\u5bf9\u4efb\u4f55\u53ef\u80fd\u5f39\u7a97\u7684\u65b9\u6cd5\uff0c\u4f20\u8db3\u53c2\u6570\u5373\u53ef\u907f\u514d\u5bf9\u8bdd\u6846\uff1b\u7559\u7a7a\u53c2\u6570\u5219\u6309\u7528\u6237\u53ef\u89c1\u6027\u51b3\u5b9a\u662f\u5426\u5f39\u51fa\u3002</p> </li> </ol>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E6%95%B0%E6%8D%AE%E5%80%BC/","title":"\u6570\u636e\u503c","text":"<p>\u62ff\u5230\u53f6\u5b50\u8282\u70b9\u540e\uff0c\u7528 <code>.Value</code> \u8bfb/\u5199\u6570\u636e\uff0c\u7528 <code>.ValueType</code> \u5224\u65ad\u7c7b\u578b\uff1a</p> <p>\u8868\u683c</p> <p>\u590d\u5236</p> ValueType \u542b\u4e49 VB \u5e94\u58f0\u660e\u4e3a 0 \u672a\u8d4b\u503c \u2014 1 32 \u4f4d\u6574\u6570 <code>Long</code> 2 64 \u4f4d\u5b9e\u6570 <code>Double</code> 3 \u5b57\u7b26\u4e32 <code>String</code> 4 \u5b50\u8282\u70b9\u5bf9\u8c61 <code>IHNode</code> <p>\u793a\u4f8b\uff1a</p> <p>vb</p> <p>\u590d\u5236</p> <pre><code>Dim v As Variant\nv = ihNode.Value\n\nSelect Case ihNode.ValueType\n    Case 1: Dim i As Long:    i = v\n    Case 2: Dim d As Double:  d = v\n    Case 3: Dim s As String:  s = v\n    Case 4: Dim n As IHNode: Set n = v\nEnd Select\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ul> <li>\u6574\u6570\u7528 <code>Long</code>\uff0832 \u4f4d\uff09\uff0c\u5b9e\u6570\u7528 <code>Double</code>\uff0864 \u4f4d\uff09\uff0c\u53ef\u907f\u514d\u6ea2\u51fa\u3002</li> </ul> <p>Python:</p> <p>v = node.Value          # \u8bfb\u503c</p> <p>vt = node.ValueType     # 0-4</p> <p>if vt == 1:             # 32 \u4f4d\u6574\u6570</p> <p>print(\"int:\", v)</p> <p>elif vt == 2:           # 64 \u4f4d\u6d6e\u70b9</p> <p>print(\"float:\", v)</p> <p>elif vt == 3:           # \u5b57\u7b26\u4e32</p> <p>print(\"str:\", v)</p> <p>elif vt == 4:           # \u5b50\u8282\u70b9\u5bf9\u8c61</p> <p>print(\"IHNode:\", v.Name)</p> <p>else:                   # 0 \u672a\u8d4b\u503c</p> <p>print(\"not defined\")</p>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/","title":"\u8282\u70b9\u5c5e\u6027","text":"<p>\u4f60\u53ef\u4ee5\u901a\u8fc7 AttributeValue \u548c AttributeType \u5c5e\u6027\u83b7\u53d6\u8282\u70b9\u7684\u9644\u52a0\u4fe1\u606f\uff08\u79f0\u4e3a attributes\uff09\u3002\u8fd9\u4e24\u4e2a\u5c5e\u6027\u90fd\u9700\u8981\u4f20\u5165\u4e00\u4e2a\u5c5e\u6027\u7f16\u53f7\u53c2\u6570\uff0c\u8be5\u7f16\u53f7\u662f HAPAttributeNumber \u679a\u4e3e\u7c7b\u4e2d\u7684\u679a\u4e3e\u503c\u3002</p> <p>\u4ee5\u4e0b\u4e3b\u9898\u5217\u51fa\u4e86\u4e00\u4e9b\u5e38\u7528\u5c5e\u6027\u53ca\u5176\u8bf4\u660e\uff1a</p> <p>\u4e0e\u503c\u76f8\u5173\u7684\u5c5e\u6027</p> <p>\u8bb0\u5f55\u7684\u5143\u6570\u636e\u5c5e\u6027</p> <p>\u53d8\u91cf\u8282\u70b9\u7684\u5c5e\u6027</p> <p>\u591a\u7ef4\u53d8\u91cf\u8282\u70b9\u7684\u5c5e\u6027</p> <p>\u6d41\u7a0b\u56fe\u8fde\u63a5\u7aef\u53e3\u5c5e\u6027</p> <p>\u5176\u4ed6\u5c5e\u6027</p> <p>\u5728\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\uff08\u5982 Visual Basic\uff09\u7684\u5bf9\u8c61\u6d4f\u89c8\u5668\u4e2d\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u53ef\u80fd\u503c\u53ca\u5176\u63cf\u8ff0\u3002\u901a\u5e38\u4f60\u53ea\u9700\u8981\u7528\u5230\u5176\u4e2d\u5f88\u5c0f\u7684\u4e00\u4e2a\u5b50\u96c6\u3002</p> <p>\u6bcf\u4e2a\u8282\u70b9\u4e00\u822c\u53ea\u652f\u6301\u5176\u4e2d\u4e00\u90e8\u5206\u5c5e\u6027\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u8be5\u5c5e\u6027\u7684 AttributeType \u6765\u5224\u65ad\u662f\u5426\u53d7\u652f\u6301\u3002\u8fd4\u56de\u7684\u5c5e\u6027\u7c7b\u578b\u4e0e\u524d\u9762 ValueType \u7684\u7f16\u7801\u76f8\u540c\uff081\u20134\uff09\uff1b\u5982\u679c AttributeType \u8fd4\u56de 0\uff0c\u5219\u8868\u793a\u8be5\u8282\u70b9\u672a\u5b9a\u4e49\u6b64\u5c5e\u6027\u3002</p> <p>\u4f8b\u5b501</p> <p>\u4f8b\u5b502</p>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E4%B8%8E%E5%80%BC%E7%9B%B8%E5%85%B3%E7%9A%84%E5%B1%9E%E6%80%A7/","title":"\u4e0e\u503c\u76f8\u5173\u7684\u5c5e\u6027","text":"Attribute Name HAP_AttributeNumber \u542b\u4e49 Value HAP_VALUE \u5f53\u524d\u6570\u503c\uff08 node's .Value \uff09 Physical Quantity HAP_UNITROW \u8be5\u503c\u5bf9\u5e94\u7684\u201c\u7269\u7406\u91cf\u201d\u5728 Unit Table \u4e2d\u7684\u884c\u53f7 Units of Measure HAP_UNITCOL \u8be5\u503c\u5bf9\u5e94\u7684\u201c\u5355\u4f4d\u201d\u5728 Unit Table \u4e2d\u7684\u5217\u53f7 Basis HAP_BASIS \u503c\u7684\u57fa\u51c6\uff0c\u5982 MOLE / MASS \u7b49 Option List HAP_OPTIONLIST \u4e00\u4e2a\u8282\u70b9\uff0c\u5176\u5b50\u8282\u70b9\u5217\u51fa\u672c\u53d8\u91cf\u5141\u8bb8\u7684\u6240\u6709\u53ef\u9009\u503c <p>\u7528Python\u8868\u793a\u7684\u8bdd\u5c31\u662f:</p> <p>HAP_VALUE      = 0   # \u5f53\u524d\u503c</p> <p>HAP_UNITROW    = 3   # \u7269\u7406\u91cf\u6240\u5728\u884c</p> <p>HAP_UNITCOL    = 4   # \u5355\u4f4d\u6240\u5728\u5217</p> <p>HAP_BASIS      = 7   # \u57fa\u51c6 (MOLE/MASS\u2026)</p> <p>HAP_OPTIONLIST = 9   # \u5141\u8bb8\u503c\u5217\u8868\u8282\u70b9</p> <p>python\u7684</p> <pre><code># 1. \u5f53\u524d\u503c\nv = node.AttributeValue(HAP_VALUE)      # \u7b49\u4ef7\u4e8e node.Value\n\n# 2. \u7269\u7406\u91cf + \u5355\u4f4d\nif node.AttributeType(HAP_UNITROW) != 0:\n    u_row = node.AttributeValue(HAP_UNITROW)  # int\n    u_col = node.AttributeValue(HAP_UNITCOL)  # int\n    print(\"\u7269\u7406\u91cf\u884c\u53f7:\", u_row, \"\u5355\u4f4d\u5217\u53f7:\", u_col)\n\n# 3. \u57fa\u51c6\nif node.AttributeType(HAP_BASIS) != 0:\n    print(\"\u57fa\u51c6:\", node.AttributeValue(HAP_BASIS))\n\n# 4. \u4e0b\u62c9\u9009\u9879\nif node.AttributeType(HAP_OPTIONLIST) != 0:\n    opt_node = node.AttributeValue(HAP_OPTIONLIST)  # \u8fd4\u56de IHNode\n    for opt in opt_node.Elements:\n        print(\"\u53ef\u9009\u503c:\", opt.Value)\n</code></pre> <pre><code>B=aspen.Tree.FindNode(\"\\Data\\Streams\\FEED\\Output\\MASSFLOW\")\nv = B.AttributeValue(3)\nprint(\"\u53d8\u91cf\u540d:\", B.Name)\nprint(\"\u503c:\", B.Value, \"\u7c7b\u578b\u7f16\u53f7:\", B.ValueType)\nprint(\"\u5355\u4f4d:\", B.AttributeValue(HAP_UNITROW),\n      B.AttributeValue(HAP_UNITCOL))\naspen.Close()\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E4%BE%8B%E5%AD%901/","title":"\u4f8b\u5b501","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u5b50\u7a0b\u5e8f\u5229\u7528 AttributeValue \u663e\u793a\u6240\u6709\u6a21\u5757\u7684\u5217\u8868\uff0c\u5185\u5bb9\u5305\u62ec\u6bcf\u4e2a\u6a21\u5757\u7684\u7c7b\u578b\u3001\u6d41\u7a0b\u9875\uff08Section\uff09\u4ee5\u53ca\u8fd0\u884c\u72b6\u6001\u3002</p> <pre><code>Sub ListBlocksExample(ByVal ihAPSim As Happ.IHapp)\n' \u672c\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u83b7\u53d6\u6a21\u5757\u5217\u8868\u53ca\u5176\u5c5e\u6027\nDim ihBlockList As Happ.IHNodeCol\nDim ihBlock As Happ.IHNode\nDim strOut As String\nOn Error GoTo ErrorHandler\n\nihBlockList = ihAPSim.Tree.Data.Blocks.Elements\nstrOut = \"Block\" &amp; Chr(9) &amp; \"Type\" &amp; Chr(9) &amp; \"Section \" &amp; Chr(9) &amp; \"Results status\"\nFor Each ihBlock In ihBlockList\n strOut = strOut &amp; Chr(13) &amp; ihBlock.Name &amp; Chr(9) &amp; _\n   ihBlock.AttributeValue(Happ.HAPAttributeNumber.HAP_RECORDTYPE) &amp; _\n   \" \" &amp; Chr(9) &amp; _\n   ihBlock.AttributeValue(Happ.HAPAttributeNumber.HAP_SECTION) &amp; Chr(9) &amp; _\n   Status(ihBlock.AttributeValue(Happ.HAPAttributeNumber.HAP_COMPSTATUS))\nNext ihBlock\nMsgBox(strOut, , \"ListBlocksExample\")\nExit Sub\nErrorHandler:\nMsgBox(\"ListBlocksExample raised error\" &amp; Err.Description)\nEnd Sub\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E4%BE%8B%E5%AD%902/","title":"\u4f8b\u5b502","text":"<p>\u4ee5\u4e0b\u65b9\u6cd5\u7528\u4e8e\u5728\u6536\u655b\u6587\u4ef6\u5939\u5185\u65b0\u5efa\u4e00\u4e2a\u6536\u655b\u6a21\u5757\uff0c\u5e76\u5728\u5176\u4e2d\u6307\u5b9a\u6495\u88c2\u6d41\uff08\u5047\u5b9a\u6d41\u80a1 REAC-OUT \u5df2\u5b58\u5728\uff09\uff1a</p> <ol> <li> <p>\u53d6\u5f97\u6536\u655b\u6839\u8282\u70b9</p> </li> <li> <p>\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3a C2\u3001\u7b97\u6cd5\u4e3a WEGSTEIN \u7684\u6536\u655b\u6a21\u5757</p> </li> <li> <p>\u5c06\u6495\u88c2\u6d41\u8bbe\u4e3a REAC-OUT</p> </li> </ol> <p>Python \u5b9e\u73b0\uff1a</p> <p>Python</p> <p>\u590d\u5236</p> <pre><code>import win32com.client as win32\n\n# \u8fde\u63a5 Aspen Plus\uff08\u7248\u672c\u53f7\u6309\u9700\u6539\uff09\nap = win32.Dispatch('AspenPlus.Document.34.0')\nap.InitNew2()                 # \u4e5f\u53ef\u6253\u5f00\u5df2\u6709\u6587\u4ef6\n\n# 1. \u5b9a\u4f4d\u6536\u655b\u8282\u70b9\nconv = ap.Tree.Data.Convergence.Convergence\n\n# 2. \u65b0\u5efa\u6536\u655b\u6a21\u5757 C2\uff0c\u7c7b\u578b WEGSTEIN\nconv.Elements.Add('C2!WEGSTEIN')   # \u683c\u5f0f\uff1a\u540d\u79f0!\u7b97\u6cd5\n\n# 3. \u6307\u5b9a\u6495\u88c2\u6d41\u4e3a REAC-OUT\nconv.C2.Input.TOL.Elements.Label(0, 0) = 'REAC-OUT'\n</code></pre> <p>\u8fd0\u884c\u540e\uff0c\u6536\u655b\u6a21\u5757 C2 \u5373\u521b\u5efa\u5b8c\u6210\uff0c\u5e76\u628a REAC-OUT \u8bbe\u4e3a\u6495\u88c2\u6d41\u3002</p>"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7/","title":"\u5176\u4ed6\u5c5e\u6027","text":"\u5c5e\u6027\u540d\u79f0 HAP_\u5c5e\u6027\u7f16\u53f7 \u8bf4\u660e \u62e5\u6709\u5b50\u8282\u70b9 HAP_HASCHILDREN \u82e5\u8be5\u8282\u70b9\u5b58\u5728\u5b50\u8282\u70b9\uff0c\u5219\u8fd4\u56de True\u3002"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E5%8F%98%E9%87%8F%E8%8A%82%E7%82%B9%E7%9A%84%E5%B1%9E%E6%80%A7/","title":"\u53d8\u91cf\u8282\u70b9\u7684\u5c5e\u6027","text":"<p>\u8868\u683c</p> <p>\u590d\u5236</p> \u5c5e\u6027\u540d\u79f0 HAP_\u5c5e\u6027\u7f16\u53f7 \u8bf4\u660e \u8f93\u51fa HAP_OUTVAR \u8be5\u53d8\u91cf\u8282\u70b9\u662f\u5426\u4e3a\u7ed3\u679c\u53d8\u91cf\uff08\u53ea\u8bfb\uff09 \u53ef\u8f93\u5165 HAP_ENTERABLE \u80fd\u5426\u4fee\u6539\u5176\u503c\u5c5e\u6027\uff1f \u4e0a\u9650 HAP_UPPERLIMIT \u503c\u5c5e\u6027\u7684\u4e0a\u9650\u3002 \u4e0b\u9650 HAP_LOWERLIMIT \u503c\u5c5e\u6027\u7684\u4e0b\u9650\u3002 \u9ed8\u8ba4\u503c HAP_VALUEDEFAULT \u503c\u5c5e\u6027\u7684\u9ed8\u8ba4\u503c\u3002 \u63d0\u793a HAP_PROMPT \u8282\u70b9\u7684\u63cf\u8ff0\u6027\u63d0\u793a\u3002"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E5%A4%9A%E7%BB%B4%E5%8F%98%E9%87%8F%E8%8A%82%E7%82%B9%E7%9A%84%E5%B1%9E%E6%80%A7/","title":"\u591a\u7ef4\u53d8\u91cf\u8282\u70b9\u7684\u5c5e\u6027","text":"\u5c5e\u6027\u540d\u79f0 HAP_\u5c5e\u6027\u7f16\u53f7 \u8bf4\u660e \u9996\u5bf9\u6eda\u52a8\u9879 HAP_FIRSTPAIR \u82e5\u53d8\u91cf\u4f7f\u7528\u6210\u5bf9\u6eda\u52a8\uff0c\u8be5\u5c5e\u6027\u8868\u793a\u6210\u5bf9\u9879\u4e2d\u7b2c\u4e00\u4e2a\u6210\u5458\u7684\u7d22\u5f15\uff08\u4ece1\u5f00\u59cb\u8ba1\u6570\uff09\u3002"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E6%8E%A5%E7%AB%AF%E5%8F%A3%E5%B1%9E%E6%80%A7/","title":"\u6d41\u7a0b\u56fe\u8fde\u63a5\u7aef\u53e3\u5c5e\u6027","text":"\u5c5e\u6027\u540d\u79f0 HAP_\u5c5e\u6027\u7f16\u53f7 \u8bf4\u660e \u8fdb\u51fa\u65b9\u5411 HAP_INOUT \u8be5\u7aef\u53e3\u662f\u5165\u53e3\u8fd8\u662f\u51fa\u53e3\uff1f \u5bf9\u6a21\u5757\uff1a 0 = \u5165\u53e3 1 = \u51fa\u53e3 \u5bf9\u7269\u6d41\uff1a 0 = \u51fa\u53e3 1 = \u5165\u53e3 \u6027\u522b HAP_PORTSEX \u6a21\u5757\u6216\u7269\u6d41\u7aef\u53e3\u7c7b\u578b\uff1a 0 = \u7269\u6d41 1 = \u6a21\u5757 \u591a\u8fde\u63a5 HAP_MULTIPORT \u8be5\u7aef\u53e3\u80fd\u5426\u540c\u65f6\u8fde\u63a5\u591a\u6761\u7269\u6d41\uff1f 0 = \u5426 1 = \u662f \u7aef\u53e3\u7c7b\u578b HAP_PORTTYPE \u7aef\u53e3\u8282\u70b9\u7684\u7c7b\u578b\u3002 1 = \u7269\u6599 2 = \u70ed\u91cf 3 = \u529f"},{"location":"Aspen%2BGuide/%E6%95%B0%E6%8D%AE%E5%80%BC%E4%B8%8E%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7/%E8%AE%B0%E5%BD%95%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7/","title":"\u8bb0\u5f55\u7684\u5143\u6570\u636e\u5c5e\u6027","text":"\u5c5e\u6027\u540d HAP_AttributeNumber \u8bf4\u660e Record Type HAP_BASETYPE \u82e5\u8282\u70b9\u4e3a\u8bb0\u5f55\u7ed3\u6784\uff08\u5982\u6a21\u5757\u6216\u6d41\u80a1\uff09\uff0c\u8be5\u5c5e\u6027\u8fd4\u56de\u8bb0\u5f55\u7c7b\u578b\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982 RADFRAC \u6a21\u5757\u8fd4\u56de \"RADFRAC\"\uff0c\u7269\u6599\u6d41\u80a1\u8fd4\u56de \"MATERIAL\"\u3002 Completion Status HAP_COMPSTATUS \u8fd4\u56de\u6574\u6570\u4ee3\u7801\uff0c\u8868\u793a\u5b8c\u6210\u72b6\u6001\u3002\u5176\u4f4d\u63a9\u7801\u542b\u4e49\u53ef\u5728\u679a\u4e3e HAPCompStatusCode \u4e2d\u67e5\u9605\u3002 RECORDTYPE \u53ef\u4ee5\u770b\u5230\u6d41\u80a1\u662f\u54ea\u4e2a\u7c7b\u578b <pre><code>concent3=aspen.Tree.FindNode(\"\\Data\\Streams\\FEED\")\nconcent3.AttributeValue(6)\n#\u6570\u636e\n'MATERIAL'\nconcent3=aspen.Tree.FindNode(\"\\Data\\Blocks\\FLASH\")\nconcent3.AttributeValue(59)\n#\"FLASH3\"\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E5%BA%93%E5%8F%8A%E6%A8%A1%E5%9E%8B%E9%80%89%E9%A1%B9%E6%9D%BF%E5%88%86%E7%B1%BB%E7%9A%84%E6%93%8D%E4%BD%9C/","title":"\u5e93\u53ca\u6a21\u578b\u9009\u9879\u677f\u5206\u7c7b\u7684\u64cd\u4f5c","text":"<p>IHAPLibRef \u63a5\u53e3\u8ba9\u81ea\u52a8\u5316\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bbf\u95ee\u4e0e\u6a21\u62df\u95ee\u9898\u5173\u8054\u7684\u5e93\u4ee5\u53ca\u6a21\u578b\u9009\u9879\u677f\u4e0a\u663e\u793a\u7684\u7c7b\u522b\uff0c\u5e76\u80fd\u591f\u5bf9\u8fd9\u4e9b\u5e93\u548c\u7c7b\u522b\u8fdb\u884c\u6dfb\u52a0\u3001\u5220\u9664\u548c\u91cd\u65b0\u6392\u5e8f\u3002\u901a\u8fc7\u95ee\u9898\u7684 LibRef \u65b9\u6cd5\u5373\u53ef\u83b7\u5f97\u8be5\u63a5\u53e3\u3002\u6709\u5173\u6b64\u63a5\u53e3\u4e2d\u51fd\u6570\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 IHAPLibRef \u7c7b\u7684\u6210\u5458\u8bf4\u660e\u3002</p> <p> IHAPLibRef</p> <p>\u901a\u8fc7 OLE \u521b\u5efa\u6d41\u7a0b\u56fe\u793a\u4f8b</p> <pre><code>Dim problem As Happ.IHapp\nDim libref As Happ.IHAPLibRef\n\nSet problem = CreateObject(\"Apwn.document\")\nSet libref = problem.LibRef\n</code></pre> <p>\u5c06\u65b0\u5e93\u63d2\u5165\u4e3a\u7b2c\u4e00\u4e2a\u5f15\u7528\u5e93\uff1a</p> <pre><code>libref.InsertLibrary \"f:\\kessel\\fcc.apm\", 0\n</code></pre> <p>\u663e\u793a\u95ee\u9898\u7a97\u53e3\uff0c\u4ee5\u4fbf\u67e5\u770b\u6a21\u578b\u9009\u9879\u677f\u548c\u5e93\u5f15\u7528\uff1a</p> <pre><code>\n</code></pre> <pre><code>problem.Visible = True\n</code></pre> <p>Python\u7248\u672c</p> <pre><code>import win32com.client as win32\n\n# 1. \u83b7\u53d6 IHAPLibRef \u63a5\u53e3\nproblem = win32.Dispatch(\"AspenPlus.Document.34.0\")   # \u6216\u5bf9\u5e94\u7248\u672c\u53f7\nproblem.InitNew2()                                    # \u53ef\u9009\uff1a\u65b0\u5efa\u7a7a\u767d\u6a21\u62df\nlibref = problem.LibRef                              # IHAPLibRef \u63a5\u53e3\n\n# 2. \u5217\u51fa\u5df2\u5f15\u7528\u5e93\nfor idx in range(libref.CountLibs):\n    print(libref.LibraryName(idx))\n    print(libref.LibraryPath(idx))\n\n# 3. \u63d2\u5165\u65b0\u5e93\u4f5c\u4e3a\u9996\u4e2a\u5f15\u7528\nlibref.InsertLibrary(r\"f:\\kessel\\fcc.apm\", 0)   # 0 = \u63d2\u5165\u5230\u9996\u4f4d\n\n# 4. \u663e\u793a\u7a97\u53e3\uff0c\u67e5\u770b\u6a21\u578b\u9009\u9879\u677f\u4e0e\u5e93\u5f15\u7528\nproblem.Visible = True\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%B5%81%E8%82%A1%E7%9A%84%E6%93%8D%E4%BD%9C/","title":"\u6a21\u5757\u4e0e\u6d41\u80a1\u7684\u64cd\u4f5c","text":"<p>\u4f60\u53ef\u4ee5\u4f7f\u7528 Block\u3001Stream \u548c Port \u96c6\u5408\u5bf9\u8c61\u7684 Add \u548c Remove \u65b9\u6cd5\uff0c\u6765\uff1a</p> <ul> <li> <p>\u6dfb\u52a0\u6216\u5220\u9664\u6a21\u5757/\u6d41\u80a1</p> </li> <li> <p>\u5c06\u6d41\u80a1\u4e0e\u6a21\u5757\u8fde\u63a5\u6216\u65ad\u5f00\u8fde\u63a5</p> </li> </ul> <p>\u5373\uff1a\u901a\u8fc7\u81ea\u52a8\u5316\u63a5\u53e3\u52a8\u6001\u5730 \u589e\u5220\u6d41\u7a0b\u56fe\u5143\u4ef6 \u5e76 \u6539\u53d8\u5176\u8fde\u63a5\u5173\u7cfb\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\uff1a</p> <p>\u6dfb\u52a0\u4e0e\u5220\u9664\u6a21\u5757</p> <p>\u6dfb\u52a0\u4e0e\u5220\u9664\u6d41\u80a1</p> <p>\u8fde\u63a5\u4e0e\u65ad\u5f00\u6d41\u80a1</p>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E6%8E%A5%E7%A4%BA%E4%BE%8B%E4%BB%A3/","title":"\u6d41\u7a0b\u56fe\u8fde\u63a5\u793a\u4f8b\u4ee3","text":"<pre><code>Sub ConnectivityExample(ByVal ihAPsim As Happ.IHapp)\n' This example displays a table showing flowsheet connectivity\nDim ihStreamList As Happ.IHNode\nDim ihBlockList As Happ.IHNode\nDim ihDestBlock As Happ.IHNode\nDim ihSourceBlock As Happ.IHNode\nDim ihStream As Happ.IHNode\nDim strHeading As String\nDim strTable As String\nDim strDestBlock As String\nDim strDestPort As String\nDim strSourceBlock As String\nDim strSourcePort As String\nDim strStreamName As String\nDim strStreamType As String\n\nOn Error GoTo ErrorHandler\nihStreamList = ihAPsim.Tree.Data.Streams\nihBlockList = ihAPsim.Tree.Data.Blocks\nstrTable=\"\"\nstrHeading = \"Stream\" &amp; Chr(9) &amp; \"From\" _\n  &amp; Chr(9) &amp; Chr(9) &amp; Chr(9) &amp; \"To\" &amp; Chr(13)\n\nFor Each ihStream In ihStreamList.Elements\n  strStreamName = ihStream.Name\n  strStreamType = ihStream.AttributeValue(Happ.HAPAttributeNumber.HAP_RECORDTYPE)\n  ' get the destination connections\n  ihDestBlock = ihStream.Elements(\"Ports\").Elements(\"DEST\")\n  If (ihDestBlock.Elements.RowCount(0) &gt; 0) Then\n    ' there is a destination port\n    strDestBlock = ihDestBlock.Elements(0).Value\n    strDestPort = ihBlockList.Elements(strDestBlock). _\n      Connections.Elements(strStreamName).Value\n  Else\n    ' it's a flowsheet product\n    strDestBlock = \"\"\n    strDestPort = \"\"\n  End If\n  ' get the source connections\n  ihSourceBlock = ihStream.Elements(\"Ports\").Elements(\"SOURCE\")\n  If (ihSourceBlock.Elements.RowCount(0) &gt; 0) Then\n    ' there is a source port\n    strSourceBlock = ihSourceBlock.Elements(0).Value\n    strSourcePort = ihBlockList.Elements(strSourceBlock). _\n      Connections.Elements(strStreamName).Value\n  Else\n    ' it's a flowsheet feed\n    strSourceBlock = \"\"\n    strSourcePort = \"\"\n  End If\n\n  strTable = strTable &amp; Chr(13) &amp; strStreamName _\n    &amp; Chr(9) &amp; strSourceBlock _\n    &amp; Chr(9) &amp; strSourcePort &amp; Chr(9) _\n    &amp; Chr(9) &amp; strDestBlock &amp; Chr(9) _\n    &amp; strDestPort\nNext ihStream\nMsgBox(strHeading &amp; strTable, , \"ConnectivityExample\")\nExit Sub\n\nErrorHandler:\nMsgBox(\"ConnectivityExample raised error\" &amp; Err.Description)\nEnd Sub\n\n\nPython\u7ffb\u8bd1\n</code></pre> <pre><code>import win32com.client as win32\n\nfrom tkinter import Tk, messagebox\n\nHAP_RECORDTYPE = 11   # \u8bb0\u5f55\u7c7b\u578b\n\ndef connectivity_example(ih_ap_sim):\n\n\"\"\"\u4e0e VB ConnectivityExample \u529f\u80fd\u5b8c\u5168\u4e00\u81f4\"\"\"\n\nstream_list = ih_ap_sim.Tree.Data.Streams.Elements\n\nblock_list  = ih_ap_sim.Tree.Data.Blocks.Elements\n\n```VBScript\nheading = \"Stream\\tFrom\\t\\t\\tTo\"\ntable_lines = [heading]\n\nfor ih_stream in stream_list:\n    stream_name = ih_stream.Name\n    stream_type = ih_stream.AttributeValue(HAP_RECORDTYPE) if ih_stream.AttributeType(HAP_RECORDTYPE) != 0 else \"\"\n\n    # --------- \u76ee\u7684\u8fde\u63a5 ---------\n    dest_port = ih_stream.Elements(\"Ports\").Elements(\"DEST\")\n    if dest_port.Elements.RowCount(0) &gt; 0:          # \u6709\u76ee\u7684\u7aef\u53e3\n        dest_block = dest_port.Elements(0).Value\n        dest_port_name = block_list.Elements(dest_block).Connections.Elements(stream_name).Value\n    else:                                           # \u4ea7\u54c1\u51fa\u6599\n        dest_block = dest_port_name = \"\"\n\n    # --------- \u6e90\u8fde\u63a5 ---------\n    src_port = ih_stream.Elements(\"Ports\").Elements(\"SOURCE\")\n    if src_port.Elements.RowCount(0) &gt; 0:           # \u6709\u6e90\u7aef\u53e3\n        src_block = src_port.Elements(0).Value\n        src_port_name = block_list.Elements(src_block).Connections.Elements(stream_name).Value\n    else:                                           # \u8fdb\u6599\n        src_block = src_port_name = \"\"\n\n    # --------- \u62fc\u8868 ---------\n    table_lines.append(f\"{stream_name}\\t{src_block}\\t{src_port_name}\\t\\t{dest_block}\\t{dest_port_name}\")\n\n# --------- \u5f39\u7a97 ---------\nroot = Tk(); root.withdraw()\nmessagebox.showinfo(\"ConnectivityExample\", \"\\n\".join(table_lines))\nroot.destroy()\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E6%8E%A5%E7%A4%BA%E4%BE%8B%E4%BB%A3/#-","title":"---------------- \u8c03\u7528\u793a\u4f8b ----------------","text":"<p>if name == \"main\": ap = win32.Dispatch(\"AspenPlus.Document.34.0\") ap.InitNew2()                 # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6 connectivity_example(ap) ap.Quit()</p> <p>```</p>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E8%AE%BF%E9%97%AE%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E6%8E%A5/","title":"\u8bbf\u95ee\u6d41\u7a0b\u56fe\u8fde\u63a5","text":"<p>\u6a21\u5757\u8282\u70b9\u4e0e\u6d41\u80a1\u8282\u70b9\u7684 Port \u548c Connection \u5b50\u8282\u70b9\u4fdd\u5b58\u4e86\u5b83\u4eec\u7684\u7aef\u53e3\u4fe1\u606f\u4ee5\u53ca\u7aef\u53e3\u8fde\u63a5\u5bf9\u8c61\u3002 \u4ee5\u4e0b\u4ee3\u7801\u793a\u4f8b\u5c06\u751f\u6210\u4e00\u5f20\u8868\u683c\uff0c\u5217\u51fa\u6d41\u7a0b\u56fe\u4e2d\u6240\u6709\u6d41\u80a1\u7684\u6e90\u6a21\u5757/\u7aef\u53e3\u4e0e\u76ee\u6807\u6a21\u5757/\u7aef\u53e3 \u8868\u683c\u3002</p>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%B5%81%E8%82%A1%E7%9A%84%E6%93%8D%E4%BD%9C/%E6%B7%BB%E5%8A%A0%E4%B8%8E%E5%88%A0%E9%99%A4%E6%A8%A1%E5%9D%97/","title":"\u6dfb\u52a0\u4e0e\u5220\u9664\u6a21\u5757","text":"<p>\u8981\u6dfb\u52a0\u6a21\u5757\uff0c\u8c03\u7528 Blocks \u96c6\u5408\u7684 Add \u65b9\u6cd5\uff0c\u53c2\u6570\u683c\u5f0f\u4e3a <code>\"\u6a21\u5757\u540d!\u6a21\u5757\u7c7b\u578b\"</code>\u3002</p> <pre><code>Dim problem As Happ.IHapp\nDim blocknode As Happ.IHNode\n\nSet problem = CreateObject(\"Apwn.document\")\nSet blocknode = problem.Tree.Elements(\"Data\").Elements(\"Blocks\")\n\nblocknode.Elements.Add \"B1!RADFRAC\"\n</code></pre> <p>\u8981\u5220\u9664\u6a21\u5757\uff0c\u8c03\u7528 Blocks \u96c6\u5408\u7684 Remove \u65b9\u6cd5\uff0c\u53c2\u6570\u4e3a\u6a21\u5757\u540d\u5373\u53ef\uff1a</p> <pre><code>blocknode.Elements.Remove \"B1\"\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%B5%81%E8%82%A1%E7%9A%84%E6%93%8D%E4%BD%9C/%E6%B7%BB%E5%8A%A0%E4%B8%8E%E5%88%A0%E9%99%A4%E6%B5%81%E8%82%A1/","title":"\u6dfb\u52a0\u4e0e\u5220\u9664\u6d41\u80a1","text":"<p>\u8981\u6dfb\u52a0\u6d41\u80a1\uff0c\u8c03\u7528 Streams \u96c6\u5408\u7684 Add \u65b9\u6cd5\uff0c\u53c2\u6570\u683c\u5f0f\u4e3a <code>\"\u6d41\u80a1\u540d!\u6d41\u80a1\u7c7b\u578b\"</code>\uff08\u6d41\u80a1\u7c7b\u578b\u53ef\u7701\u7565\uff0c\u9ed8\u8ba4\u4e3a MATERIAL\uff09\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>Dim problem As HappLS\nDim streamnode As Happ.IHNode\n\nSet problem = CreateObject(\"Apwn.document\")\nSet streamnode = problem.Tree.Elements(\"Data\").Elements(\"Streams\")\n\nstreamnode.Elements.Add \"S1!MATERIAL\"   ' \u7269\u6599\u6d41\nstreamnode.Elements.Add \"S2\"            ' \u9ed8\u8ba4 MATERIAL\nstreamnode.Elements.Add \"S3!HEAT\"       ' \u70ed\u6d41\n</code></pre> <p>\u8981\u5220\u9664\u6d41\u80a1\uff0c\u8c03\u7528 Streams \u96c6\u5408\u7684 Remove \u65b9\u6cd5\uff0c\u53c2\u6570\u4e3a\u6d41\u80a1\u540d\u5373\u53ef:</p> <pre><code>streamnode.Elements.Remove \"S1\"\n</code></pre>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E6%A8%A1%E5%9D%97%E4%B8%8E%E6%B5%81%E8%82%A1%E7%9A%84%E6%93%8D%E4%BD%9C/%E8%BF%9E%E6%8E%A5%E4%B8%8E%E6%96%AD%E5%BC%80%E6%B5%81%E8%82%A1/","title":"\u8fde\u63a5\u4e0e\u65ad\u5f00\u6d41\u80a1","text":"<p>Python \u76f4\u8bd1\u7248\uff1a\u6dfb\u52a0/\u5220\u9664\u6d41\u80a1</p> <pre><code>import win32com.client as win32\n\n# \u8fde\u63a5 Aspen Plus\nap = win32.Dispatch(\"AspenPlus.Document.34.0\")\nap.InitNew2()                    # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n\n# 1. \u5b9a\u4f4d Streams \u96c6\u5408\nstreams = ap.Tree.Data.Blocks.Parent.Elements(\"Streams\")   # \u6216 ap.Tree.Data.Streams\n\n# 2. \u6dfb\u52a0\u6d41\u80a1\nstreams.Elements.Add(\"S1!MATERIAL\")   # \u7269\u6599\u6d41\nstreams.Elements.Add(\"S2\")            # \u9ed8\u8ba4 MATERIAL\nstreams.Elements.Add(\"S3!HEAT\")       # \u70ed\u6d41\n\n# 3. \u5220\u9664\u6d41\u80a1\nstreams.Elements.Remove(\"S1\")\n\nap.Quit()\n</code></pre> <p>\u8981\u70b9\uff1a</p> <ul> <li> <p>\u53c2\u6570\u683c\u5f0f <code>\"\u6d41\u80a1\u540d!\u6d41\u80a1\u7c7b\u578b\"</code>\uff0c\u7c7b\u578b\u53ef\u7701\u7565\uff0c\u9ed8\u8ba4 MATERIAL\uff1b</p> </li> <li> <p>\u53ef\u7528 HEAT\u3001WORK \u7b49\u5173\u952e\u5b57\u521b\u5efa\u70ed\u6d41\u3001\u529f\u6d41\uff1b</p> </li> <li> <p><code>Remove(\"\u6d41\u80a1\u540d\")</code> \u7acb\u5373\u4ece\u6d41\u7a0b\u56fe\u5220\u9664\u5bf9\u5e94\u6d41\u80a1\u3002</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%80%A7%E4%B8%8E%E8%87%AA%E5%8A%A8%E5%8C%96/%E8%AE%BF%E9%97%AE%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%BF%9E%E6%8E%A5/%E8%A1%A8%E6%A0%BC/","title":"\u8868\u683c","text":"<pre><code>Sub ConnectivityExample(ByVal ihAPsim As Happ.IHapp)\n' This example displays a table showing flowsheet connectivity\nDim ihStreamList As Happ.IHNode\nDim ihBlockList As Happ.IHNode\nDim ihDestBlock As Happ.IHNode\nDim ihSourceBlock As Happ.IHNode\nDim ihStream As Happ.IHNode\nDim strHeading As String\nDim strTable As String\nDim strDestBlock As String\nDim strDestPort As String\nDim strSourceBlock As String\nDim strSourcePort As String\nDim strStreamName As String\nDim strStreamType As String\n\nOn Error GoTo ErrorHandler\nihStreamList = ihAPsim.Tree.Data.Streams\nihBlockList = ihAPsim.Tree.Data.Blocks\nstrTable=\"\"\nstrHeading = \"Stream\" &amp; Chr(9) &amp; \"From\" _\n  &amp; Chr(9) &amp; Chr(9) &amp; Chr(9) &amp; \"To\" &amp; Chr(13)\n\nFor Each ihStream In ihStreamList.Elements\n  strStreamName = ihStream.Name\n  strStreamType = ihStream.AttributeValue(Happ.HAPAttributeNumber.HAP_RECORDTYPE)\n  ' get the destination connections\n  ihDestBlock = ihStream.Elements(\"Ports\").Elements(\"DEST\")\n  If (ihDestBlock.Elements.RowCount(0) &gt; 0) Then\n    ' there is a destination port\n    strDestBlock = ihDestBlock.Elements(0).Value\n    strDestPort = ihBlockList.Elements(strDestBlock). _\n      Connections.Elements(strStreamName).Value\n  Else\n    ' it's a flowsheet product\n    strDestBlock = \"\"\n    strDestPort = \"\"\n  End If\n  ' get the source connections\n  ihSourceBlock = ihStream.Elements(\"Ports\").Elements(\"SOURCE\")\n  If (ihSourceBlock.Elements.RowCount(0) &gt; 0) Then\n    ' there is a source port\n    strSourceBlock = ihSourceBlock.Elements(0).Value\n    strSourcePort = ihBlockList.Elements(strSourceBlock). _\n      Connections.Elements(strStreamName).Value\n  Else\n    ' it's a flowsheet feed\n    strSourceBlock = \"\"\n    strSourcePort = \"\"\n  End If\n\n  strTable = strTable &amp; Chr(13) &amp; strStreamName _\n    &amp; Chr(9) &amp; strSourceBlock _\n    &amp; Chr(9) &amp; strSourcePort &amp; Chr(9) _\n    &amp; Chr(9) &amp; strDestBlock &amp; Chr(9) _\n    &amp; strDestPort\nNext ihStream\nMsgBox(strHeading &amp; strTable, , \"ConnectivityExample\")\nExit Sub\n\nErrorHandler:\nMsgBox(\"ConnectivityExample raised error\" &amp; Err.Description)\nEnd Sub\n</code></pre> <p>Python\u7ffb\u8bd1</p> <pre><code>import win32com.client as win32\nfrom tkinter import Tk, messagebox\n\nHAP_RECORDTYPE = 11   # \u8bb0\u5f55\u7c7b\u578b\n\ndef connectivity_example(ih_ap_sim):\n    \"\"\"\u4e0e VB ConnectivityExample \u529f\u80fd\u5b8c\u5168\u4e00\u81f4\"\"\"\n    stream_list = ih_ap_sim.Tree.Data.Streams.Elements\n    block_list  = ih_ap_sim.Tree.Data.Blocks.Elements\n\n    heading = \"Stream\\tFrom\\t\\t\\tTo\"\n    table_lines = [heading]\n\n    for ih_stream in stream_list:\n        stream_name = ih_stream.Name\n        stream_type = ih_stream.AttributeValue(HAP_RECORDTYPE) if ih_stream.AttributeType(HAP_RECORDTYPE) != 0 else \"\"\n\n        # --------- \u76ee\u7684\u8fde\u63a5 ---------\n        dest_port = ih_stream.Elements(\"Ports\").Elements(\"DEST\")\n        if dest_port.Elements.RowCount(0) &gt; 0:          # \u6709\u76ee\u7684\u7aef\u53e3\n            dest_block = dest_port.Elements(0).Value\n            dest_port_name = block_list.Elements(dest_block).Connections.Elements(stream_name).Value\n        else:                                           # \u4ea7\u54c1\u51fa\u6599\n            dest_block = dest_port_name = \"\"\n\n        # --------- \u6e90\u8fde\u63a5 ---------\n        src_port = ih_stream.Elements(\"Ports\").Elements(\"SOURCE\")\n        if src_port.Elements.RowCount(0) &gt; 0:           # \u6709\u6e90\u7aef\u53e3\n            src_block = src_port.Elements(0).Value\n            src_port_name = block_list.Elements(src_block).Connections.Elements(stream_name).Value\n        else:                                           # \u8fdb\u6599\n            src_block = src_port_name = \"\"\n\n        # --------- \u62fc\u8868 ---------\n        table_lines.append(f\"{stream_name}\\t{src_block}\\t{src_port_name}\\t\\t{dest_block}\\t{dest_port_name}\")\n\n    # --------- \u5f39\u7a97 ---------\n    root = Tk(); root.withdraw()\n    messagebox.showinfo(\"ConnectivityExample\", \"\\n\".join(table_lines))\n    root.destroy()\n\n\n# ---------------- \u8c03\u7528\u793a\u4f8b ----------------\nif __name__ == \"__main__\":\n    ap = win32.Dispatch(\"AspenPlus.Document.34.0\")\n    ap.InitNew2()                 # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n    connectivity_example(ap)\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/%E5%9C%A8%2BAspen%2BPlus%2B%E8%BF%90%E8%A1%8C%E4%B8%AD%E6%9B%B4%E6%94%B9%E5%8D%95%E4%BD%8D/","title":"\u5728+Aspen+Plus+\u8fd0\u884c\u4e2d\u66f4\u6539\u5355\u4f4d","text":"<p>\u6548\u679c\u533a\u522b\u53d6\u51b3\u4e8e\u8282\u70b9\u662f\u201c\u8f93\u5165\u201d\u8fd8\u662f\u201c\u8f93\u51fa\u201d\uff1a</p> <ul> <li> <p>\u8f93\u51fa\u503c \u6539 <code>HAP_UNITCOL</code> \u4f1a\u628a \u53d6\u51fa\u7684\u7ed3\u679c \u81ea\u52a8\u6362\u7b97\u6210\u65b0\u5355\u4f4d\uff0c\u76f8\u5f53\u4e8e\u5728 GUI \u7684 Results \u8868\u5355\u4e0a\u6362\u5355\u4f4d\u2014\u2014\u6570\u503c\u4f1a\u53d8\uff0c\u4f46\u5e95\u5c42\u50a8\u5b58\u4e0d\u53d8\u3002</p> </li> <li> <p>\u8f93\u5165\u503c \u6539 <code>HAP_UNITCOL</code> \u53ea\u4f1a\u6539 \u8f93\u5165\u6846\u7684\u8ba1\u91cf\u5355\u4f4d\uff0c\u4e0d\u4f1a\u5e2e\u4f60\u628a\u5df2\u6709\u6570\u503c\u6362\u7b97\u8fc7\u53bb\uff0c\u76f8\u5f53\u4e8e\u5728 GUI \u7684 Input \u8868\u5355\u4e0a\u6362\u5355\u4f4d\u2014\u2014\u539f\u6570\u5b57\u4fdd\u7559\uff0c\u542b\u4e49\u968f\u4e4b\u6539\u53d8\u3002</p> </li> </ul> <p>\u4ee5\u4e0b\u5b50\u7a0b\u5e8f\u6f14\u793a\u5982\u4f55 \u76f4\u63a5\u4fee\u6539 Aspen Plus \u8fd0\u884c\u4e2d\u7684\u5355\u4f4d\uff1a</p> <pre><code>Sub UnitsChangeExample(ByVal ihAPsim As Happ.IHapp)\nDim ihPres As Happ.IHNode\nOn Error GoTo ErrorHandler\n    ' \u53d6\u5f97 B3 \u6a21\u5757\u8f93\u51fa\u538b\u529b\u8282\u70b9\n    Set ihPres = ihAPsim.Tree.Data.Blocks.B3.Output.B_PRES\n\n    ' \u663e\u793a\u9ed8\u8ba4\u5355\u4f4d\u4e0b\u7684\u538b\u529b\n    MsgBox \"Pressure in default units: \" &amp; ihPres.Value &amp; _\n           Chr(9) &amp; ihPres.UnitString\n\n    ' \u628a\u5355\u4f4d\u6539\u4e3a bar\uff08\u7b2c 5 \u5217\uff09\n    ihPres.AttributeValue(Happ.HAPAttributeNumber.HAP_UNITCOL, True) = 5\n\n    ' \u518d\u6b21\u8bfb\u53d6\uff0c\u5df2\u81ea\u52a8\u6362\u7b97\u6210 bar\n    MsgBox \"Pressure in selected units: \" &amp; ihPres.Value &amp; _\n           Chr(9) &amp; ihPres.UnitString\nExit Sub\nErrorHandler:\n    MsgBox \"UnitsChangeExample raised error \" &amp; Err.Description\nEnd Sub\n</code></pre> <p>\u8981\u70b9\uff1a</p> <ul> <li> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570 <code>True</code> \u8868\u793a \u5141\u8bb8\u5c31\u5730\u4fee\u6539\uff08\u53ef\u5199\uff09\u3002</p> </li> <li> <p>\u4fee\u6539\u540e <code>Value</code> \u4f1a\u81ea\u52a8\u6362\u7b97\u6210\u65b0\u5355\u4f4d\uff0c\u7b49\u540c\u4e8e\u5728 Results \u8868\u5355\u6362\u5355\u4f4d\u3002</p> </li> </ul>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/%E5%B0%86%E8%AF%A5%E5%80%BC%E8%BD%AC%E6%8D%A2%E5%88%B0%E5%8F%A6%E4%B8%80%E5%A5%97%E5%8D%95%E4%BD%8D/","title":"\u5c06\u8be5\u503c\u8f6c\u6362\u5230\u53e6\u4e00\u5957\u5355\u4f4d","text":"<p>\u4f60\u53ef\u4ee5\u7528 <code>ValueForUnit</code> \u5c5e\u6027\u6309\u6307\u5b9a\u5355\u4f4d\u83b7\u53d6\u6570\u503c\u3002 <code>ValueForUnit</code> \u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a\u60f3\u8981\u7684\u5355\u4f4d\u8868\u884c\u53f7\uff08\u7269\u7406\u91cf\uff09\u548c\u5355\u4f4d\u8868\u5217\u53f7\uff08\u5355\u4f4d\u7b26\u53f7\uff09\u3002</p> <p>\u5355\u4f4d\u6362\u7b97\u793a\u4f8b \u540c\u65f6\u8bfb\u53d6\u6a21\u5757 B3 \u7684\u538b\u529b\uff1a</p> <ul> <li> <p>\u5f53\u524d\u663e\u793a\u5355\u4f4d\uff08psia\uff09</p> </li> <li> <p>\u76ee\u6807\u5355\u4f4d atm\uff08\u5728\u5355\u4f4d\u8868\u7b2c 3 \u5217\uff09</p> </li> </ul> <pre><code>Sub UnitsConversionExample(ByVal ihAPSim As Happ.IHapp)\n' \u672c\u4f8b\u540c\u65f6\u83b7\u53d6\u663e\u793a\u5355\u4f4d\uff08psia\uff09\u4e0e\u76ee\u6807\u5355\u4f4d\uff08atm\uff09\u4e0b\u7684\u538b\u529b\u503c\nDim ihPres As Happ.IHNode\nDim nRow As Long, nCol As Long\nDim strDisplayUnits As String, strConvertedUnits As String\nOn Error GoTo ErrorHandler\n    Set ihPres = ihAPSim.Tree.Data.Blocks.B3.Output.B_PRES\n\n    ' \u53d6\u5f97\u5f53\u524d\u663e\u793a\u5355\u4f4d\u7684\u884c\u5217\u53f7\uff08psia\uff09\n    nRow = ihPres.AttributeValue(Happ.HAPAttributeNumber.HAP_UNITROW)\n    nCol = ihPres.AttributeValue(Happ.HAPAttributeNumber.HAP_UNITCOL)\n    strDisplayUnits = UnitsString(ihAPSim, nRow, nCol)\n\n    ' \u6362\u6210\u76ee\u6807\u5355\u4f4d\u5217 atm\uff08\u7b2c 3 \u5217\uff09\n    nCol = 3\n    strConvertedUnits = UnitsString(ihAPSim, nRow, nCol)\n\n    MsgBox \"Pressure in Display units: \" &amp; ihPres.Value &amp; _\n      \" \" &amp; strDisplayUnits &amp; vbCrLf &amp; _\n      \"Pressure in Converted units: \" &amp; _\n      ihPres.ValueForUnit(nRow, nCol) &amp; \" \" &amp; strConvertedUnits, _\n      , \"UnitsConversionExample\"\nExit Sub\nErrorHandler:\n    MsgBox \"UnitsConversionExample raised error \" &amp; Err.Description\nEnd Sub\n\n' \u8f85\u52a9\uff1a\u6839\u636e\u884c\u5217\u53f7\u8fd4\u56de\u5355\u4f4d\u7b26\u53f7\nPublic Function UnitsString(ByVal ihAPSim As Happ.IHapp, _\n  ByVal nRow As Long, ByVal nCol As Long)\nOn Error GoTo UnitsStringFailed\n    UnitsString = ihAPSim.Tree.Elements(\"Unit Table\"). _\n        Elements(nRow - 1).Elements.Label(0, nCol - 1)\n    Exit Function\nUnitsStringFailed:\n    UnitsString = \"\"\nEnd Function\n</code></pre> <p>\u8bfb\u53d6 B3 \u6a21\u5757\u538b\u529b\uff0c\u540c\u65f6\u663e\u793a\u5f53\u524d\u5355\u4f4d\uff08psia\uff09\u4e0e\u76ee\u6807\u5355\u4f4d atm</p> <pre><code>import win32com.client as win32\n\n# ---------- \u5e38\u91cf ----------\nHAP_UNITROW = 3          # \u7269\u7406\u91cf\u884c\u53f7\nHAP_UNITCOL = 4          # \u5355\u4f4d\u5217\u53f7\n\n# ---------- \u8f85\u52a9\uff1a\u6839\u636e\u884c\u5217\u53f7\u53d6\u5355\u4f4d\u7b26\u53f7 ----------\ndef units_string(ap, row, col):\n    \"\"\"\n    row, col \u90fd\u662f 1-based\uff0c\u8bbf\u95ee\u96c6\u5408\u65f6\u8981\u51cf 1\n    \"\"\"\n    try:\n        return ap.Tree.Elements(\"Unit Table\").Elements(row - 1).Elements.Label(0, col - 1)\n    except Exception:\n        return \"\"\n\n# ---------- \u4e3b\u903b\u8f91 ----------\ndef units_conversion_example(ap):\n    pres = ap.Tree.Data.Blocks.B3.Output.B_PRES   # \u538b\u529b\u8282\u70b9\n\n    # 1. \u5f53\u524d\u663e\u793a\u5355\u4f4d\n    row       = pres.AttributeValue(HAP_UNITROW)\n    col       = pres.AttributeValue(HAP_UNITCOL)\n    cur_unit  = units_string(ap, row, col)\n    cur_val   = pres.Value\n\n    # 2. \u76ee\u6807\u5355\u4f4d atm\uff08\u5df2\u77e5\u5728\u5355\u4f4d\u8868\u7b2c 3 \u5217\uff09\n    tgt_col   = 3\n    tgt_unit  = units_string(ap, row, tgt_col)\n    tgt_val   = pres.ValueForUnit(row, tgt_col)\n\n    # 3. \u7ed3\u679c\n    msg = (f\"Pressure in display units : {cur_val} {cur_unit}\\n\"\n           f\"Pressure in converted units: {tgt_val} {tgt_unit}\")\n    print(msg)          # \u4e5f\u53ef\u6539\u7528 tkinter.messagebox.showinfo\n    return msg\n\n# ---------- \u8c03\u7528\u793a\u4f8b ----------\nif __name__ == \"__main__\":\n    ap = win32.Dispatch(\"AspenPlus.Document.34.0\")\n    ap.InitNew2()                    # \u6216 GetObject \u6253\u5f00\u5df2\u6709\u6587\u4ef6\n    units_conversion_example(ap)\n    ap.Quit()\n</code></pre>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/%E6%A3%80%E7%B4%A2%E6%9F%90%E4%B8%AA%E5%80%BC%E7%9A%84%E7%89%A9%E7%90%86%E9%87%8F%E5%8F%8A%E5%85%B6%E5%8D%95%E4%BD%8D/","title":"\u68c0\u7d22\u67d0\u4e2a\u503c\u7684\u7269\u7406\u91cf\u53ca\u5176\u5355\u4f4d","text":"<p>\u4f60\u53ef\u4ee5\u83b7\u53d6\uff1a</p> <p>\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u7684\u201c\u503c\u201d\u7684\u5355\u4f4d\uff1b</p> <p>\u4ee5\u201c\u5355\u4f4d\u8868\u201d\u884c/\u5217\u5f15\u7528\u5f62\u5f0f\u8fd4\u56de\u7684\u7269\u7406\u91cf\u53ca\u5176\u5355\u4f4d\u3002</p>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/%E6%A3%80%E7%B4%A2%E6%9F%90%E4%B8%AA%E5%80%BC%E7%9A%84%E7%89%A9%E7%90%86%E9%87%8F%E5%8F%8A%E5%85%B6%E5%8D%95%E4%BD%8D/%E4%BB%A5%E2%80%9C%E5%8D%95%E4%BD%8D%E8%A1%A8%E2%80%9D%E8%A1%8C%2B%E5%88%97%E5%BC%95%E7%94%A8%E5%BD%A2%E5%BC%8F%E8%BF%94%E5%9B%9E%E7%9A%84%E7%89%A9%E7%90%86%E9%87%8F%E5%8F%8A%E5%85%B6%E5%8D%95%E4%BD%8D%E3%80%82/","title":"\u4ee5\u201c\u5355\u4f4d\u8868\u201d\u884c+\u5217\u5f15\u7528\u5f62\u5f0f\u8fd4\u56de\u7684\u7269\u7406\u91cf\u53ca\u5176\u5355\u4f4d\u3002","text":"<p>\u5728 Aspen Plus \u4e2d\uff0c\u7269\u7406\u91cf\u53ca\u5176\u5bf9\u5e94\u7684\u8ba1\u91cf\u5355\u4f4d\u901a\u8fc7\u201c\u5355\u4f4d\u8868\uff08Unit Table\uff09\u201d\u7684\u5f15\u7528\u6765\u63cf\u8ff0\u3002\u6709\u65f6\u76f4\u63a5\u64cd\u4f5c\u5355\u4f4d\u8868\u4f1a\u6bd4\u5904\u7406\u67d0\u4e2a\u5177\u4f53\u503c\u7684 UnitString \u66f4\u65b9\u4fbf\u3002</p> <p>\u5355\u4f4d\u8868\u7684\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u79cd\u7269\u7406\u91cf\uff08\u6e29\u5ea6\u3001\u538b\u529b\u7b49\uff09\uff0c\u6bcf\u4e00\u5217\u4ee3\u8868\u8be5\u7269\u7406\u91cf\u53ef\u91c7\u7528\u7684\u8ba1\u91cf\u5355\u4f4d\uff08\u00b0C\u3001bar \u7b49\uff09\u3002 \u5728\u81ea\u52a8\u5316\u63a5\u53e3\u4e2d\uff0c\u5355\u4f4d\u8868\u4f5c\u4e3a\u6839\u8282\u70b9\u4e0b\u7684\u4e00\u4e2a\u540d\u4e3a \"Unit Table\" \u7684\u8282\u70b9\u66b4\u9732\u3002 \"Unit Table\" \u8282\u70b9\u4e0b\u7684\u96c6\u5408\u5143\u7d20\u5373\u8868\u7684\u884c\uff0c\u5176\u6807\u7b7e\u5c31\u662f\u7269\u7406\u91cf\u540d\u79f0\uff1b \u6bcf\u884c\u7269\u7406\u91cf\u8282\u70b9\u4e0b\u53c8\u6709\u4e00\u4e2a\u96c6\u5408\uff0c\u5176\u6807\u7b7e\u4e3a\u5355\u4f4d\u7b26\u53f7\u5b57\u7b26\u4e32\u3002</p> <p>\u5bf9\u4e8e\u6811\u4e2d\u4efb\u610f\u5305\u542b\u7269\u7406\u91cf\u7684\u8282\u70b9\uff1a</p> <ul> <li> <p>\u7528 <code>.AttributeValue(HAP_UNITROW)</code> \u53d6\u5f97\u7269\u7406\u91cf\uff08\u5373\u5355\u4f4d\u8868\u884c\u53f7\uff09</p> </li> <li> <p>\u7528 <code>.AttributeValue(HAP_UNITCOL)</code> \u53d6\u5f97\u8ba1\u91cf\u5355\u4f4d\u7b26\u53f7\uff08\u5373\u5355\u4f4d\u8868\u5217\u53f7\uff09</p> </li> </ul> <p>\u6ce8\u610f\uff1a\u8fd9\u4e24\u4e2a\u5c5e\u6027\u8fd4\u56de\u7684\u662f\u5b9e\u9645\u884c\u5217\u53f7\uff1b\u5728\u901a\u8fc7\u96c6\u5408\u7d22\u5f15\u8bbf\u95ee\u5355\u4f4d\u8868\u65f6\uff0c\u9700\u5c06\u884c\u53f7 \u51cf 1 \u518d\u4f7f\u7528\u3002</p>"},{"location":"Aspen%2BGuide/%E7%89%A9%E7%90%86%E9%87%8F%E4%B8%8E%E8%AE%A1%E9%87%8F%E5%8D%95%E4%BD%8D/%E6%A3%80%E7%B4%A2%E6%9F%90%E4%B8%AA%E5%80%BC%E7%9A%84%E7%89%A9%E7%90%86%E9%87%8F%E5%8F%8A%E5%85%B6%E5%8D%95%E4%BD%8D/%E4%BB%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BD%A2%E5%BC%8F%E8%BF%94%E5%9B%9E%E7%9A%84%E2%80%9C%E5%80%BC%E2%80%9D%E7%9A%84%E5%8D%95%E4%BD%8D%EF%BC%9B/","title":"\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u7684\u201c\u503c\u201d\u7684\u5355\u4f4d\uff1b","text":"<p>\u503c\u7684\u8ba1\u91cf\u5355\u4f4d\u7b26\u53f7\u53ef\u901a\u8fc7 UnitString \u5c5e\u6027\u83b7\u5f97\u3002</p> <p>\u4f7f\u7528\u5355\u4f4d\u793a\u4f8b</p> <p>\u4ee5\u4e0b\u5b50\u7a0b\u5e8f\u5229\u7528 UnitString \u5c5e\u6027\u663e\u793a\u95ea\u84b8\u6a21\u5757\u51fa\u53e3\u538b\u529b\u53ca\u5176\u5355\u4f4d\u3002</p> <pre><code>Sub UnitStringExample(ByVal ihAPSim As Happ.IHapp)\n' \u672c\u793a\u4f8b\u83b7\u53d6\u53d8\u91cf\u7684\u8ba1\u91cf\u5355\u4f4d\u7b26\u53f7\nDim ihPresNode As Happ.IHNode\nOn Error GoTo ErrorHandler\nSet ihPresNode = ihAPSim.Tree.Data.Blocks.B3.Output.B_PRES\nMsgBox \"Flash pressure is: \" &amp; ihPresNode.Value &amp; Chr(9) &amp; _\n  ihPresNode.UnitString, , \"UnitStringExample\"\nExit Sub\nErrorHandler:\nMsgBox \"UnitStringExample raised error \" &amp; Err.Description\nEnd Sub\n</code></pre> <p>\u4f7f\u7528Python\u6765\u89e3\u91ca:</p> <pre><code>import win32com.client as win32\n\n# \u8fde\u63a5 Aspen Plus\uff08\u7248\u672c\u53f7\u6309\u9700\u8c03\u6574\uff09\nap = win32.Dispatch('AspenPlus.Document.34.0')\nap.InitNew2()                      # \u6216\u6253\u5f00\u5df2\u6709\u6587\u4ef6\n\n# \u5b9a\u4f4d\u8282\u70b9\uff1aB3 \u2192 Output \u2192 B_PRES\npres_node = ap.Tree.Data.Blocks.B3.Output.B_PRES\n\n# \u53d6\u503c\u548c\u5355\u4f4d\nvalue = pres_node.Value\nunit  = pres_node.UnitString\n\n# \u663e\u793a\u7ed3\u679c\nprint(f'Flash pressure is: {value}\\t{unit}')\n# \u82e5\u559c\u6b22\u5f39\u7a97\uff1a\n# from tkinter import messagebox\n# messagebox.showinfo('UnitStringExample', f'Flash pressure is: {value}\\t{unit}')\n\nap.Quit()\n</code></pre>"}]}